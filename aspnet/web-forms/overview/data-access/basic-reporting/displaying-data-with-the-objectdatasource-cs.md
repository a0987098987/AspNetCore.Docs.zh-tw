---
uid: web-forms/overview/data-access/basic-reporting/displaying-data-with-the-objectdatasource-cs
title: "利用 ObjectDataSource (C#) 顯示資料 |Microsoft 文件"
author: rick-anderson
description: "本教學課程會使用這個控制項，您可以將擷取自 BLL havi 沒有先前的教學課程中建立資料繫結 ObjectDataSource 控制項查看..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: af882aef-56f5-4e9a-8f95-3977fde20e74
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/displaying-data-with-the-objectdatasource-cs
msc.type: authoredcontent
ms.openlocfilehash: 8025a4d236d126b939b44fac9114ae3d0e98f6ad
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/10/2017
---
<a name="displaying-data-with-the-objectdatasource-c"></a><span data-ttu-id="e2ccd-103">利用 ObjectDataSource (C#) 顯示資料</span><span class="sxs-lookup"><span data-stu-id="e2ccd-103">Displaying Data With the ObjectDataSource (C#)</span></span>
====================
<span data-ttu-id="e2ccd-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e2ccd-105">[下載範例應用程式](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_4_CS.exe)或[下載 PDF](displaying-data-with-the-objectdatasource-cs/_static/datatutorial04cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-105">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_4_CS.exe) or [Download PDF](displaying-data-with-the-objectdatasource-cs/_static/datatutorial04cs1.pdf)</span></span>

> <span data-ttu-id="e2ccd-106">本教學課程會使用這個控制項，您可以將擷取自 BLL 而不需要撰寫一行程式碼在上一個教學課程中建立資料繫結 ObjectDataSource 控制項查看 ！</span><span class="sxs-lookup"><span data-stu-id="e2ccd-106">This tutorial looks at the ObjectDataSource control Using this control you can bind data retrieved from the BLL created in the previous tutorial without having to write a line of code!</span></span>


## <a name="introduction"></a><span data-ttu-id="e2ccd-107">簡介</span><span class="sxs-lookup"><span data-stu-id="e2ccd-107">Introduction</span></span>

<span data-ttu-id="e2ccd-108">我們的應用程式架構和網站頁面版面配置完成，我們就可以開始探索如何完成各種不同的資料和報告相關的一般工作。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-108">With our application architecture and website page layout complete, we're ready to start exploring how to accomplish a variety of common data- and reporting-related tasks.</span></span> <span data-ttu-id="e2ccd-109">在先前的教學課程中，我們已經看到如何以程式設計方式從 DAL 和 BLL 的資料繫結至資料之 ASP.NET 網頁中的 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-109">In the previous tutorials we've seen how to programmatically bind data from the DAL and BLL to a data Web control in an ASP.NET page.</span></span> <span data-ttu-id="e2ccd-110">此語法的資料 Web 控制項指派`DataSource`屬性顯示，然後再呼叫控制項的資料`DataBind()`方法是使用 ASP.NET 1.x 應用程式的模式，而且可以繼續在 2.0 應用程式中使用。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-110">This syntax assigning the data Web control's `DataSource` property to the data to display and then calling the control's `DataBind()` method was the pattern used in ASP.NET 1.x applications, and can continue to be used in your 2.0 applications.</span></span> <span data-ttu-id="e2ccd-111">不過，ASP.NET 2.0 的新資料來源控制項提供宣告的方式，來處理資料。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-111">However, ASP.NET 2.0's new data source controls offer a declarative way to work with data.</span></span> <span data-ttu-id="e2ccd-112">在中使用這些控制項可以繫結 BLL 從擷取的資料建立[上一個教學課程](../introduction/creating-a-business-logic-layer-cs.md)而不需要撰寫一行程式碼 ！</span><span class="sxs-lookup"><span data-stu-id="e2ccd-112">Using these controls you can bind data retrieved from the BLL created in the [previous tutorial](../introduction/creating-a-business-logic-layer-cs.md) without having to write a line of code!</span></span>

<span data-ttu-id="e2ccd-113">ASP.NET 2.0 隨附於五個內建資料來源控制項[SqlDataSource](https://msdn.microsoft.com/en-us/library/dz12d98w(vs.80).aspx)， [AccessDataSource](https://msdn.microsoft.com/en-us/library/8e5545e1.aspx)， [ObjectDataSource](https://msdn.microsoft.com/en-us/library/9a4kyhcx.aspx)， [XmlDataSource](https://msdn.microsoft.com/en-us/library/e8d8587a(en-US,VS.80).aspx)，和[Treeview](https://msdn.microsoft.com/en-us/library/5ex9t96x(en-US,VS.80).aspx)雖然您可以建立您自己[自訂資料來源控制項](https://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnvs05/html/DataSourceCon1.asp)有需要。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-113">ASP.NET 2.0 ships with five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/en-us/library/dz12d98w(vs.80).aspx), [AccessDataSource](https://msdn.microsoft.com/en-us/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/en-us/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/en-us/library/e8d8587a(en-US,VS.80).aspx), and [SiteMapDataSource](https://msdn.microsoft.com/en-us/library/5ex9t96x(en-US,VS.80).aspx) although you can build your own [custom data source controls](https://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnvs05/html/DataSourceCon1.asp), if needed.</span></span> <span data-ttu-id="e2ccd-114">因為我們已經教學課程應用程式開發架構，我們將使用 ObjectDataSource 針對我們 BLL 的類別。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-114">Since we have developed an architecture for our tutorial application, we'll be using the ObjectDataSource against our BLL classes.</span></span>


![ASP.NET 2.0 包含五個內建資料來源控制項](displaying-data-with-the-objectdatasource-cs/_static/image1.png)

<span data-ttu-id="e2ccd-116">**圖 1**: ASP.NET 2.0 包含五個內建資料來源控制項</span><span class="sxs-lookup"><span data-stu-id="e2ccd-116">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>


<span data-ttu-id="e2ccd-117">ObjectDataSource 會做為其他物件所使用的 proxy。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-117">The ObjectDataSource serves as a proxy for working with some other object.</span></span> <span data-ttu-id="e2ccd-118">若要設定 ObjectDataSource 我們指定這基礎物件和其方法如何對應至 ObjectDataSource `Select`， `Insert`， `Update`，和`Delete`方法。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-118">To configure the ObjectDataSource we specify this underlying object and how its methods map to the ObjectDataSource's `Select`, `Insert`, `Update`, and `Delete` methods.</span></span> <span data-ttu-id="e2ccd-119">一旦指定了這個基礎物件，其方法對應到 ObjectDataSource 我們可以再將繫結 ObjectDataSource Web 控制項的資料。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-119">Once this underlying object has been specified and its methods mapped to the ObjectDataSource's, we can then bind the ObjectDataSource to a data Web control.</span></span> <span data-ttu-id="e2ccd-120">ASP.NET 隨附許多資料 Web 控制項，包括 GridView、 DetailsView、 RadioButtonList 和 DropDownList，和其他項目。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-120">ASP.NET ships with many data Web controls, including the GridView, DetailsView, RadioButtonList, and DropDownList, among others.</span></span> <span data-ttu-id="e2ccd-121">在頁面生命週期中，Web 控制項的資料可能需要存取的資料繫結，它將會完成藉由叫用其 ObjectDataSource`Select`方法; 如果資料 Web 控制項支援插入、 更新或刪除，呼叫可能會對其ObjectDataSource 的`Insert`， `Update`，或`Delete`方法。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-121">During the page lifecycle, the data Web control may need to access the data it's bound to, which it will accomplish by invoking its ObjectDataSource's `Select` method; if the data Web control supports inserting, updating, or deleting, calls may be made to its ObjectDataSource's `Insert`, `Update`, or `Delete` methods.</span></span> <span data-ttu-id="e2ccd-122">這些呼叫適當的基礎物件的方法 objectdatasource 然後路由傳送，如下列圖表所示。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-122">These calls are then routed by the ObjectDataSource to the appropriate underlying object's methods as the following diagram illustrates.</span></span>


<span data-ttu-id="e2ccd-123">[![ObjectDataSource 做為 Proxy](displaying-data-with-the-objectdatasource-cs/_static/image3.png)](displaying-data-with-the-objectdatasource-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-123">[![The ObjectDataSource Serves as a Proxy](displaying-data-with-the-objectdatasource-cs/_static/image3.png)](displaying-data-with-the-objectdatasource-cs/_static/image2.png)</span></span>

<span data-ttu-id="e2ccd-124">**圖 2**: ObjectDataSource 做為 Proxy ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-124">**Figure 2**: The ObjectDataSource Serves as a Proxy ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image4.png))</span></span>


<span data-ttu-id="e2ccd-125">ObjectDataSource 可以用來叫用插入方法，更新或刪除資料，讓我們只著重於傳回的資料;未來的教學課程將會探索使用 ObjectDataSource 和資料修改資料的 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-125">While the ObjectDataSource can be used to invoke methods for inserting, updating, or deleting data, let's just focus on returning data; future tutorials will explore using the ObjectDataSource and data Web controls that modify data.</span></span>

## <a name="step-1-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="e2ccd-126">步驟 1： 加入和設定 ObjectDataSource 控制項</span><span class="sxs-lookup"><span data-stu-id="e2ccd-126">Step 1: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="e2ccd-127">先開啟`SimpleDisplay.aspx`頁面`BasicReporting`資料夾，切換至 [設計] 檢視中，然後再拖曳 ObjectDataSource 控制項從 [工具箱] 拖曳至頁面的設計介面。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-127">Start by opening the `SimpleDisplay.aspx` page in the `BasicReporting` folder, switch to Design view, and then drag an ObjectDataSource control from the Toolbox onto the page's design surface.</span></span> <span data-ttu-id="e2ccd-128">ObjectDataSource 會顯示為設計介面上的灰色方塊，因為它不會產生任何標記。它只會叫用方法，從指定的物件存取的資料。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-128">The ObjectDataSource appears as a gray box on the design surface because it does not produce any markup; it simply accesses data by invoking a method from a specified object.</span></span> <span data-ttu-id="e2ccd-129">ObjectDataSource 所傳回的資料可以顯示資料的 Web 控制項，例如 GridView、 DetailsView、 FormView，等等。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-129">The data returned by an ObjectDataSource can be displayed by a data Web control, such as the GridView, DetailsView, FormView, and so on.</span></span>

> [!NOTE]
> <span data-ttu-id="e2ccd-130">或者，您可能會先加入網頁中的 Web 控制項的資料，然後從其智慧標籤上，選擇&lt;新的資料來源&gt;從下拉式清單選項。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-130">Alternatively, you may first add the data Web control to the page and then, from its smart tag, choose the &lt;New data source&gt; option from the drop-down list.</span></span>


<span data-ttu-id="e2ccd-131">若要指定 ObjectDataSource 基礎物件和該物件的方法如何對應至 ObjectDataSource，按一下 ObjectDataSource 的智慧標籤的設定資料來源連結。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-131">To specify the ObjectDataSource's underlying object and how that object's methods map to the ObjectDataSource's, click on the Configure Data Source link from the ObjectDataSource's smart tag.</span></span>


<span data-ttu-id="e2ccd-132">[![按一下 設定從智慧標籤的資料來源連結](displaying-data-with-the-objectdatasource-cs/_static/image6.png)](displaying-data-with-the-objectdatasource-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-132">[![Click the Configure Data Source Link from the Smart Tag](displaying-data-with-the-objectdatasource-cs/_static/image6.png)](displaying-data-with-the-objectdatasource-cs/_static/image5.png)</span></span>

<span data-ttu-id="e2ccd-133">**圖 3**： 按一下從智慧標籤設定資料來源連結 ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-133">**Figure 3**: Click the Configure Data Source Link from the Smart Tag ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image7.png))</span></span>


<span data-ttu-id="e2ccd-134">這會開啟設定資料來源精靈。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-134">This brings up the Configure Data Source wizard.</span></span> <span data-ttu-id="e2ccd-135">首先，我們必須指定 ObjectDataSource 所使用的物件。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-135">First, we must specify the object the ObjectDataSource is to work with.</span></span> <span data-ttu-id="e2ccd-136">如果 「 僅顯示資料元件 」 核取方塊，下拉式清單，在這個畫面上的會列出只有在具有使用已裝飾的物件`DataObject`屬性。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-136">If the "Show only data components" checkbox is checked, the drop-down list on this screen lists only those objects that have been decorated with the `DataObject` attribute.</span></span> <span data-ttu-id="e2ccd-137">目前我們清單會包含 Tableadapter 中具類型資料集和 BLL 類別上一個教學課程中建立。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-137">Currently our list includes the TableAdapters in the Typed DataSet and the BLL classes we created in the previous tutorial.</span></span> <span data-ttu-id="e2ccd-138">如果您忘記新增`DataObject`屬性為商務邏輯層類別就看它們這份清單中。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-138">If you forgot to add the `DataObject` attribute to the Business Logic Layer classes you won't see them in this list.</span></span> <span data-ttu-id="e2ccd-139">在此情況下，取消 「 僅顯示資料元件 」 的核取方塊選取要檢視所有物件，其中應包含 BLL 類別 （以及其他類別型別資料集的 Datatable、 資料行，依此類推）。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-139">In that case, uncheck the "Show only data components" checkbox to view all objects, which should include the BLL classes (along with the other classes in the Typed DataSet the DataTables, DataRows, and so on).</span></span>

<span data-ttu-id="e2ccd-140">從這個第一個畫面中，選擇`ProductsBLL`類別從下拉式清單，然後按一下 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-140">From this first screen choose the `ProductsBLL` class from the drop-down list and click Next.</span></span>


<span data-ttu-id="e2ccd-141">[![指定要使用的物件與 ObjectDataSource 控制項](displaying-data-with-the-objectdatasource-cs/_static/image9.png)](displaying-data-with-the-objectdatasource-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-141">[![Specify the Object to Use with the ObjectDataSource Control](displaying-data-with-the-objectdatasource-cs/_static/image9.png)](displaying-data-with-the-objectdatasource-cs/_static/image8.png)</span></span>

<span data-ttu-id="e2ccd-142">**圖 4**: ObjectDataSource 控制項以指定要使用物件 ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-142">**Figure 4**: Specify the Object to Use with the ObjectDataSource Control ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image10.png))</span></span>


<span data-ttu-id="e2ccd-143">在精靈中的下一個畫面會提示您選取 ObjectDataSource 應叫用哪一種方法。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-143">The next screen in the wizard prompts you to select what method the ObjectDataSource should invoke.</span></span> <span data-ttu-id="e2ccd-144">下拉式清單會列出這些方法，從上一個畫面選取的物件中傳回的資料。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-144">The drop-down lists those methods that return data in the object selected from the previous screen.</span></span> <span data-ttu-id="e2ccd-145">我們在這裡看到`GetProductByProductID`， `GetProducts`， `GetProductsByCategoryID`，和`GetProductsBySupplierID`。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-145">Here we see `GetProductByProductID`, `GetProducts`, `GetProductsByCategoryID`, and `GetProductsBySupplierID`.</span></span> <span data-ttu-id="e2ccd-146">選取`GetProducts`方法，從下拉式清單，然後按一下 [完成] (如果您加入`DataObjectMethodAttribute`至`ProductBLL`的預設會選取上一個教學課程中，此選項中所示的方法)。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-146">Select the `GetProducts` method from the drop-down list and click Finish (if you added the `DataObjectMethodAttribute` to the `ProductBLL`'s methods as shown in the previous tutorial, this option will be selected by default).</span></span>


<span data-ttu-id="e2ccd-147">[![選擇方法來傳回資料，從 [選取] 索引標籤](displaying-data-with-the-objectdatasource-cs/_static/image12.png)](displaying-data-with-the-objectdatasource-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-147">[![Choose the Method for Returning Data from the SELECT Tab](displaying-data-with-the-objectdatasource-cs/_static/image12.png)](displaying-data-with-the-objectdatasource-cs/_static/image11.png)</span></span>

<span data-ttu-id="e2ccd-148">**圖 5**： 選擇的方法傳回的資料，從 [選取] 索引標籤 ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-148">**Figure 5**: Choose the Method for Returning Data from the SELECT Tab ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image13.png))</span></span>


## <a name="configure-the-objectdatasource-manually"></a><span data-ttu-id="e2ccd-149">手動設定 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="e2ccd-149">Configure the ObjectDataSource Manually</span></span>

<span data-ttu-id="e2ccd-150">ObjectDataSource 設定資料來源精靈提供快速的方式來指定它使用的物件，以及建立關聯物件的哪些方法會叫用。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-150">The ObjectDataSource's Configure Data Source wizard offers a quick way to specify the object it uses and to associate what methods of the object are invoked.</span></span> <span data-ttu-id="e2ccd-151">不過，您就可以設定其屬性，透過 [屬性] 視窗，或是直接在宣告式標記中透過 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-151">You can, however, configure the ObjectDataSource through its properties, either through the Properties window or directly in the declarative markup.</span></span> <span data-ttu-id="e2ccd-152">只要設定`TypeName`屬性来使用的基礎物件的型別和`SelectMethod`來擷取資料時叫用的方法。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-152">Simply set the `TypeName` property to the type of the underlying object to be used, and the `SelectMethod` to the method to invoke when retrieving data.</span></span>


[!code-aspx[Main](displaying-data-with-the-objectdatasource-cs/samples/sample1.aspx)]

<span data-ttu-id="e2ccd-153">即使您偏好設定資料來源精靈，可能是您需要手動設定 [ObjectDataSource]，因為精靈只列出開發人員建立的類別。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-153">Even if you prefer the Configure Data Source wizard there may be times when you need to manually configure the ObjectDataSource, as the wizard only lists developer-created classes.</span></span> <span data-ttu-id="e2ccd-154">如果您想要這類將 ObjectDataSource 繫結至.NET Framework 中的類別[成員資格類別](https://msdn.microsoft.com/en-us/library/system.web.security.membership.aspx)、 存取使用者帳戶資訊，或[目錄類別](https://msdn.microsoft.com/en-us/library/system.io.directory.aspx)才能使用檔案系統資訊您必須手動設定 ObjectDataSource 的屬性。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-154">If you want to bind the ObjectDataSource to a class in the .NET Framework such as the [Membership class](https://msdn.microsoft.com/en-us/library/system.web.security.membership.aspx), to access user account information, or the [Directory class](https://msdn.microsoft.com/en-us/library/system.io.directory.aspx) to work with file system information you'll need to manually set the ObjectDataSource's properties.</span></span>

## <a name="step-2-adding-a-data-web-control-and-binding-it-to-the-objectdatasource"></a><span data-ttu-id="e2ccd-155">步驟 2： 加入資料 Web 控制項並繫結至 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="e2ccd-155">Step 2: Adding a Data Web Control and Binding it to the ObjectDataSource</span></span>

<span data-ttu-id="e2ccd-156">一旦 ObjectDataSource 已加入至頁面，並設定，我們將資料的 Web 控制項加入至頁面，即可顯示 ObjectDataSource 所傳回的資料準備`Select`方法。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-156">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to display the data returned by the ObjectDataSource's `Select` method.</span></span> <span data-ttu-id="e2ccd-157">可以繫結至 ObjectDataSource; 的任何資料的 Web 控制項讓我們看看 GridView、 DetailsView 和 FormView 中顯示 ObjectDataSource 的資料。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-157">Any data Web control can be bound to an ObjectDataSource; let's look at displaying the ObjectDataSource's data in a GridView, DetailsView, and FormView.</span></span>

## <a name="binding-a-gridview-to-the-objectdatasource"></a><span data-ttu-id="e2ccd-158">繫結至 ObjectDataSource 的 GridView</span><span class="sxs-lookup"><span data-stu-id="e2ccd-158">Binding a GridView to the ObjectDataSource</span></span>

<span data-ttu-id="e2ccd-159">將 GridView 控制項從工具箱拖曳至`SimpleDisplay.aspx`的設計介面。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-159">Add a GridView control from the Toolbox to `SimpleDisplay.aspx`'s design surface.</span></span> <span data-ttu-id="e2ccd-160">從 GridView 的智慧標籤上，選擇 ObjectDataSource 控制項，我們加入在步驟 1 中。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-160">From the GridView's smart tag, choose the ObjectDataSource control we added in Step 1.</span></span> <span data-ttu-id="e2ccd-161">這會在每一個屬性傳回的資料從 ObjectDataSource GridView 中自動建立 BoundField`Select`方法 （也就是產品資料表所定義的內容）。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-161">This will automatically create a BoundField in the GridView for each property returned by the data from the ObjectDataSource's `Select` method (namely, the properties defined by the Products DataTable).</span></span>


<span data-ttu-id="e2ccd-162">[![在 GridView 加入網頁和繫結至 ObjectDataSource](displaying-data-with-the-objectdatasource-cs/_static/image15.png)](displaying-data-with-the-objectdatasource-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-162">[![A GridView Has Been Added to the Page and Bound to the ObjectDataSource](displaying-data-with-the-objectdatasource-cs/_static/image15.png)](displaying-data-with-the-objectdatasource-cs/_static/image14.png)</span></span>

<span data-ttu-id="e2ccd-163">**圖 6**: GridView 已加入至頁面，並繫結至 ObjectDataSource ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-163">**Figure 6**: A GridView Has Been Added to the Page and Bound to the ObjectDataSource ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image16.png))</span></span>


<span data-ttu-id="e2ccd-164">您可以再自訂、 重新排列，或移除 GridView BoundFields 按一下智慧標籤的 編輯資料行選項。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-164">You can then customize, rearrange, or remove the GridView's BoundFields by clicking the Edit Columns option from the smart tag.</span></span>


<span data-ttu-id="e2ccd-165">[![管理 GridView BoundFields 透過編輯資料行對話方塊](displaying-data-with-the-objectdatasource-cs/_static/image18.png)](displaying-data-with-the-objectdatasource-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-165">[![Manage the GridView's BoundFields Through the Edit Columns Dialog Box](displaying-data-with-the-objectdatasource-cs/_static/image18.png)](displaying-data-with-the-objectdatasource-cs/_static/image17.png)</span></span>

<span data-ttu-id="e2ccd-166">**圖 7**： 管理 GridView BoundFields 透過編輯資料行對話方塊 ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-166">**Figure 7**: Manage the GridView's BoundFields Through the Edit Columns Dialog Box ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image19.png))</span></span>


<span data-ttu-id="e2ccd-167">請花一點時間修改 GridView BoundFields，移除`ProductID`， `SupplierID`， `CategoryID`， `QuantityPerUnit`， `UnitsInStock`， `UnitsOnOrder`，和`ReorderLevel`BoundFields。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-167">Take a moment to modify the GridView's BoundFields, removing the `ProductID`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` BoundFields.</span></span> <span data-ttu-id="e2ccd-168">直接選取 BoundField 左下角中的清單，並按一下 [刪除] 按鈕 (紅色 X) 將它們移除。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-168">Simply select the BoundField from the list in the bottom left and click the delete button (the red X) to remove them.</span></span> <span data-ttu-id="e2ccd-169">接下來，重新排列 BoundFields 以便`CategoryName`和`SupplierName`BoundFields 前面`UnitPrice`BoundField 選取這些 BoundFields 並按一下向上箭號。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-169">Next, Rearrange the BoundFields so that the `CategoryName` and `SupplierName` BoundFields precede the `UnitPrice` BoundField by selecting these BoundFields and clicking the up arrow.</span></span> <span data-ttu-id="e2ccd-170">設定`HeaderText`屬性至剩餘的 BoundFields `Products`， `Category`， `Supplier`，和`Price`分別。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-170">Set the `HeaderText` properties of the remaining BoundFields to `Products`, `Category`, `Supplier`, and `Price`, respectively.</span></span> <span data-ttu-id="e2ccd-171">接下來，讓`Price`BoundField 格式化為貨幣，藉由設定 BoundField`HtmlEncode`屬性設定為 False 且其`DataFormatString`屬性`{0:c}`。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-171">Next, have the `Price` BoundField formatted as a currency by setting the BoundField's `HtmlEncode` property to False and its `DataFormatString` property to `{0:c}`.</span></span> <span data-ttu-id="e2ccd-172">最後，水平對齊`Price`右邊和`Discontinued`核取方塊，在透過中央`ItemStyle` / `HorizontalAlign`屬性。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-172">Finally, horizontally align the `Price` to the right and the `Discontinued` checkbox in the center via the `ItemStyle`/`HorizontalAlign` property.</span></span>


[!code-aspx[Main](displaying-data-with-the-objectdatasource-cs/samples/sample2.aspx)]


<span data-ttu-id="e2ccd-173">[![已自訂的 GridView BoundFields](displaying-data-with-the-objectdatasource-cs/_static/image21.png)](displaying-data-with-the-objectdatasource-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-173">[![The GridView's BoundFields Have Been Customized](displaying-data-with-the-objectdatasource-cs/_static/image21.png)](displaying-data-with-the-objectdatasource-cs/_static/image20.png)</span></span>

<span data-ttu-id="e2ccd-174">**圖 8**: GridView 已自訂 BoundFields ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-174">**Figure 8**: The GridView's BoundFields Have Been Customized ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image22.png))</span></span>


## <a name="using-themes-for-a-consistent-look"></a><span data-ttu-id="e2ccd-175">使用佈景主題的一致的外觀</span><span class="sxs-lookup"><span data-stu-id="e2ccd-175">Using Themes for a Consistent Look</span></span>

<span data-ttu-id="e2ccd-176">這些教學課程盡可能移除的任何樣式控制層級設定，而非使用階層式樣式表定義在外部檔案盡可能。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-176">These tutorials strive to remove any control-level style settings, instead using cascading style sheets defined in an external file whenever possible.</span></span> <span data-ttu-id="e2ccd-177">`Styles.css`檔案包含`DataWebControlStyle`， `HeaderStyle`， `RowStyle`，和`AlternatingRowStyle`應該用來指定資料的外觀的 CSS 類別 Web 這些教學課程中使用的控制項。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-177">The `Styles.css` file contains `DataWebControlStyle`, `HeaderStyle`, `RowStyle`, and `AlternatingRowStyle` CSS classes that should be used to dictate the appearance of the data Web controls used in these tutorials.</span></span> <span data-ttu-id="e2ccd-178">若要達成此目的，我們無法設定 GridView`CssClass`屬性`DataWebControlStyle`，及其`HeaderStyle`， `RowStyle`，和`AlternatingRowStyle`屬性`CssClass`屬性據此。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-178">To accomplish this, we could set the GridView's `CssClass` property to `DataWebControlStyle`, and its `HeaderStyle`, `RowStyle`, and `AlternatingRowStyle` properties' `CssClass` properties accordingly.</span></span>

<span data-ttu-id="e2ccd-179">如果我們將這些`CssClass`Web 控制項，我們需要明確設定這些屬性值，每個資料時，請記得在屬性 Web 控制項加入至教學課程。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-179">If we set these `CssClass` properties at the Web control we'd need to remember to explicitly set these property values for each and every data Web control added to our tutorials.</span></span> <span data-ttu-id="e2ccd-180">更容易管理的方法是定義預設 CSS 相關屬性的 GridView，DetailsView，並在 FormView 可讓您控制使用佈景主題。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-180">A more manageable approach is to define the default CSS-related properties for the GridView, DetailsView, and FormView controls using a Theme.</span></span> <span data-ttu-id="e2ccd-181">主題是控制層級屬性設定、 影像和強制執行通用的外觀及操作的站台可以套用到頁面的 CSS 類別的集合。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-181">A Theme is a collection of control-level property settings, images, and CSS classes that can be applied to pages across a site to enforce a common look and feel.</span></span>

<span data-ttu-id="e2ccd-182">我們的佈景主題不會包含任何影像或 CSS 檔案 (我們將會保留在樣式表`Styles.css`為-web 應用程式的根資料夾中，定義)，但是會包含兩個面板。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-182">Our Theme won't include any images or CSS files (we'll leave the stylesheet `Styles.css` as-is, defined in the root folder of the web application), but will include two Skins.</span></span> <span data-ttu-id="e2ccd-183">面板是用以定義 Web 控制項的預設屬性的檔案。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-183">A Skin is a file that defines the default properties for a Web control.</span></span> <span data-ttu-id="e2ccd-184">具體來說，我們必須面板檔案的 GridView 和 DetailsView 控制項，預設值，指出`CssClass`-相關的屬性。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-184">Specifically, we'll have a Skin file for the GridView and DetailsView controls, indicating the default `CssClass`-related properties.</span></span>

<span data-ttu-id="e2ccd-185">將新面板檔案新增至名為專案啟動`GridView.skin`方案總管 中的專案名稱上按一下滑鼠右鍵，然後選擇 加入新項目。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-185">Start by adding a new Skin File to your project named `GridView.skin` by right-clicking on the project name in the Solution Explorer and choosing Add New Item.</span></span>


<span data-ttu-id="e2ccd-186">[![加入名為 GridView.skin 面板檔案](displaying-data-with-the-objectdatasource-cs/_static/image24.png)](displaying-data-with-the-objectdatasource-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-186">[![Add a Skin File Named GridView.skin](displaying-data-with-the-objectdatasource-cs/_static/image24.png)](displaying-data-with-the-objectdatasource-cs/_static/image23.png)</span></span>

<span data-ttu-id="e2ccd-187">**圖 9**： 新增面板檔案命名為`GridView.skin`([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-187">**Figure 9**: Add a Skin File Named `GridView.skin` ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image25.png))</span></span>


<span data-ttu-id="e2ccd-188">面板檔案必須放在佈景主題，其位於`App_Themes`資料夾。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-188">Skin files need to be placed in a Theme, which are located in the `App_Themes` folder.</span></span> <span data-ttu-id="e2ccd-189">因為我們還沒有這類資料夾，Visual Studio 會請提供建立一個讓我們加入我們的第一個面板時。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-189">Since we don't yet have such a folder, Visual Studio will kindly offer to create one for us when adding our first Skin.</span></span> <span data-ttu-id="e2ccd-190">按一下 [是] 建立`App_Theme`資料夾，並將新`GridView.skin`那里檔案。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-190">Click Yes to create the `App_Theme` folder and place the new `GridView.skin` file there.</span></span>


<span data-ttu-id="e2ccd-191">[![讓 Visual Studio 建立 App_Theme 資料夾](displaying-data-with-the-objectdatasource-cs/_static/image27.png)](displaying-data-with-the-objectdatasource-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-191">[![Let Visual Studio Create the App_Theme Folder](displaying-data-with-the-objectdatasource-cs/_static/image27.png)](displaying-data-with-the-objectdatasource-cs/_static/image26.png)</span></span>

<span data-ttu-id="e2ccd-192">**圖 10**： 可讓 Visual Studio 建立`App_Theme`資料夾 ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-192">**Figure 10**: Let Visual Studio Create the `App_Theme` Folder ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image28.png))</span></span>


<span data-ttu-id="e2ccd-193">這會建立新的佈景主題中`App_Themes`命名 GridView 面板檔案與資料夾`GridView.skin`。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-193">This will create a new Theme in the `App_Themes` folder named GridView with the Skin file `GridView.skin`.</span></span>


![GridView 佈景主題到 App_Theme 資料夾具有 已加入](displaying-data-with-the-objectdatasource-cs/_static/image29.png)

<span data-ttu-id="e2ccd-195">**圖 11**: GridView 佈景主題可讓您有尚未加入`App_Theme`資料夾</span><span class="sxs-lookup"><span data-stu-id="e2ccd-195">**Figure 11**: The GridView Theme has Been Added to the `App_Theme` Folder</span></span>


<span data-ttu-id="e2ccd-196">重新命名為 DataWebControls 的 GridView 佈景主題 (以滑鼠右鍵按一下 GridView 資料夾中`App_Theme`資料夾，然後選擇 重新命名)。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-196">Rename the GridView Theme to DataWebControls (right-click on the GridView folder in the `App_Theme` folder and choose Rename).</span></span> <span data-ttu-id="e2ccd-197">接下來，輸入下列標記成`GridView.skin`檔案：</span><span class="sxs-lookup"><span data-stu-id="e2ccd-197">Next, enter the following markup into the `GridView.skin` file:</span></span>


[!code-aspx[Main](displaying-data-with-the-objectdatasource-cs/samples/sample3.aspx)]

<span data-ttu-id="e2ccd-198">這會定義的預設屬性`CssClass`-相關的任何 GridView DataWebControls 佈景主題會使用任何網頁中的屬性。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-198">This defines the default properties for the `CssClass`-related properties for any GridView in any page that uses the DataWebControls Theme.</span></span> <span data-ttu-id="e2ccd-199">讓我們加入另一個面板為 DetailsView，我們將稍後使用的 Web 控制項的資料。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-199">Let's add another Skin for the DetailsView, a data Web control that we'll be using shortly.</span></span> <span data-ttu-id="e2ccd-200">將新的面板加入至名為 DataWebControls 主題`DetailsView.skin`並加入下列標記：</span><span class="sxs-lookup"><span data-stu-id="e2ccd-200">Add a new Skin to the DataWebControls Theme named `DetailsView.skin` and add the following markup:</span></span>


[!code-aspx[Main](displaying-data-with-the-objectdatasource-cs/samples/sample4.aspx)]

<span data-ttu-id="e2ccd-201">我們已定義的佈景主題，最後一個步驟是將佈景主題套用至我們的 ASP.NET 頁面。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-201">With our Theme defined, the last step is to apply the Theme to our ASP.NET page.</span></span> <span data-ttu-id="e2ccd-202">根據頁面的頁面或網站中的所有頁面，可以套用佈景主題。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-202">A Theme can be applied on a page-by-page basis or for all pages in a website.</span></span> <span data-ttu-id="e2ccd-203">讓我們來使用此主題中網站的所有頁面。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-203">Let's use this theme for all pages in the website.</span></span> <span data-ttu-id="e2ccd-204">若要完成這項作業，加入下列標記以`Web.config`的`<system.web>`> 一節：</span><span class="sxs-lookup"><span data-stu-id="e2ccd-204">To accomplish this, add the following markup to `Web.config`'s `<system.web>` section:</span></span>


[!code-xml[Main](displaying-data-with-the-objectdatasource-cs/samples/sample5.xml)]

<span data-ttu-id="e2ccd-205">這就是這麼簡單 ！</span><span class="sxs-lookup"><span data-stu-id="e2ccd-205">That's all there is to it!</span></span> <span data-ttu-id="e2ccd-206">`styleSheetTheme`設定表示佈景主題中所指定的屬性應該*不*覆寫控制層級上指定的屬性。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-206">The `styleSheetTheme` setting indicates that the properties specified in the Theme should *not* override the properties specified at the control level.</span></span> <span data-ttu-id="e2ccd-207">若要指定主題設定應該優先控制設定，請使用`theme`屬性取代`styleSheetTheme`; 不幸的是，透過指定的主題設定`theme`屬性不會出現在 Visual Studio 設計檢視中。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-207">To specify that Theme settings should trump control settings, use the `theme` attribute in place of `styleSheetTheme`; unfortunately, Theme settings specified via the `theme` attribute do not appear in the Visual Studio Design view.</span></span> <span data-ttu-id="e2ccd-208">請參閱[ASP.NET 佈景主題和面板概觀](https://msdn.microsoft.com/en-us/library/ykzx33wh.aspx)和[伺服器端樣式使用佈景主題](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx)佈景主題和面板; 上的相關資訊請參閱[How To： 適用於 ASP.NET 主題](https://msdn.microsoft.com/en-us/library/0yy5hxdk(VS.80).aspx)如需詳細資訊設定頁面，即可使用佈景主題。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-208">Refer to [ASP.NET Themes and Skins Overview](https://msdn.microsoft.com/en-us/library/ykzx33wh.aspx) and [Server-Side Styles Using Themes](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx) for more information on Themes and Skins; see [How To: Apply ASP.NET Themes](https://msdn.microsoft.com/en-us/library/0yy5hxdk(VS.80).aspx) for more on configuring a page to use a theme.</span></span>


<span data-ttu-id="e2ccd-209">[![在 GridView 會顯示產品的名稱、 類別、 供應商、 價格和已停止的資訊](displaying-data-with-the-objectdatasource-cs/_static/image31.png)](displaying-data-with-the-objectdatasource-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-209">[![The GridView Displays the Product's Name, Category, Supplier, Price, and Discontinued Information](displaying-data-with-the-objectdatasource-cs/_static/image31.png)](displaying-data-with-the-objectdatasource-cs/_static/image30.png)</span></span>

<span data-ttu-id="e2ccd-210">**圖 12**: GridView 會顯示產品的名稱、 類別、 供應商、 價格和已停止的資訊 ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-210">**Figure 12**: The GridView Displays the Product's Name, Category, Supplier, Price, and Discontinued Information ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image32.png))</span></span>


## <a name="displaying-one-record-at-a-time-in-the-detailsview"></a><span data-ttu-id="e2ccd-211">在 DetailsView 中一次顯示一筆記錄</span><span class="sxs-lookup"><span data-stu-id="e2ccd-211">Displaying One Record at a Time in the DetailsView</span></span>

<span data-ttu-id="e2ccd-212">在 GridView 會顯示資料來源控制項所繫結所傳回的每一筆記錄的一個資料列。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-212">The GridView displays one row for each record returned by the data source control to which it's bound.</span></span> <span data-ttu-id="e2ccd-213">但有些的時候，不過，當我們可能會想要一次顯示唯一的記錄或只有一項記錄。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-213">There are times, however, when we may want to display a sole record or just one record at a time.</span></span> <span data-ttu-id="e2ccd-214">[DetailsView 控制項](https://msdn.microsoft.com/en-us/library/s3w1w7t4.aspx)提供這項功能，轉譯為 HTML`<table>`具有兩個資料行和一個資料列，每個資料行或屬性繫結至控制項。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-214">The [DetailsView control](https://msdn.microsoft.com/en-us/library/s3w1w7t4.aspx) offers this functionality, rendering as an HTML `<table>` with two columns and one row for each column or property bound to the control.</span></span> <span data-ttu-id="e2ccd-215">您可以將 DetailsView 視為單一記錄旋轉 90 度的 GridView。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-215">You can think of the DetailsView as a GridView with a single record rotated 90 degrees.</span></span>

<span data-ttu-id="e2ccd-216">開始加入的 DetailsView 控制項*上方*中的 GridView `SimpleDisplay.aspx`。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-216">Start by adding a DetailsView control *above* the GridView in `SimpleDisplay.aspx`.</span></span> <span data-ttu-id="e2ccd-217">接下來，將它繫結到相同 ObjectDataSource 控制項為 GridView。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-217">Next, bind it to the same ObjectDataSource control as the GridView.</span></span> <span data-ttu-id="e2ccd-218">Like 與 GridView BoundField 就會加入至 ObjectDataSource 所傳回的物件中每一個屬性 DetailsView`Select`方法。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-218">Like with the GridView, a BoundField will be added to the DetailsView for each property in the object returned by the ObjectDataSource's `Select` method.</span></span> <span data-ttu-id="e2ccd-219">唯一的差別在於 DetailsView 的 BoundFields 配置時水平而不是垂直。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-219">The only difference is that the DetailsView's BoundFields are laid out horizontally rather than vertically.</span></span>


<span data-ttu-id="e2ccd-220">[![在 DetailsView 加入頁面和繫結到 ObjectDataSource](displaying-data-with-the-objectdatasource-cs/_static/image34.png)](displaying-data-with-the-objectdatasource-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-220">[![Add a DetailsView to the Page and Bind it to the ObjectDataSource](displaying-data-with-the-objectdatasource-cs/_static/image34.png)](displaying-data-with-the-objectdatasource-cs/_static/image33.png)</span></span>

<span data-ttu-id="e2ccd-221">**圖 13**: DetailsView 加入頁面和繫結到 ObjectDataSource ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-221">**Figure 13**: Add a DetailsView to the Page and Bind it to the ObjectDataSource ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image35.png))</span></span>


<span data-ttu-id="e2ccd-222">GridView，像是在 DetailsView 的 BoundFields 可強制提供更多自訂的顯示 ObjectDataSource 所傳回的資料。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-222">Like the GridView, the DetailsView's BoundFields can be tweaked to provide a more customized display of the data returned by the ObjectDataSource.</span></span> <span data-ttu-id="e2ccd-223">圖 14 顯示 DetailsView 之後其 BoundFields 和`CssClass`屬性已設定，使其外觀類似於 GridView 範例。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-223">Figure 14 shows the DetailsView after its BoundFields and `CssClass` properties have been configured to make its appearance similar to the GridView example.</span></span>


<span data-ttu-id="e2ccd-224">[![在 DetailsView 顯示單一資料錄](displaying-data-with-the-objectdatasource-cs/_static/image37.png)](displaying-data-with-the-objectdatasource-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-224">[![The DetailsView Shows a Single Record](displaying-data-with-the-objectdatasource-cs/_static/image37.png)](displaying-data-with-the-objectdatasource-cs/_static/image36.png)</span></span>

<span data-ttu-id="e2ccd-225">**圖 14**: DetailsView 顯示單一記錄 ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-225">**Figure 14**: The DetailsView Shows a Single Record ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image38.png))</span></span>


<span data-ttu-id="e2ccd-226">在 DetailsView 只會顯示其資料來源傳回的第一個記錄的注意事項。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-226">Note that the DetailsView only displays the first record returned by its data source.</span></span> <span data-ttu-id="e2ccd-227">若要讓使用者逐步執行的所有記錄，一次，我們必須啟用 DetailsView 的分頁。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-227">To allow the user to step through all of the records, one at a time, we must enable paging for the DetailsView.</span></span> <span data-ttu-id="e2ccd-228">若要這樣做，請返回 Visual Studio 並檢查 DetailsView 的智慧標籤的 啟用分頁核取方塊。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-228">To do so, return to Visual Studio and check the Enable Paging checkbox in the DetailsView's smart tag.</span></span>


<span data-ttu-id="e2ccd-229">[![啟用 DetailsView 控制項中的分頁](displaying-data-with-the-objectdatasource-cs/_static/image40.png)](displaying-data-with-the-objectdatasource-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-229">[![Enable Paging in the DetailsView Control](displaying-data-with-the-objectdatasource-cs/_static/image40.png)](displaying-data-with-the-objectdatasource-cs/_static/image39.png)</span></span>

<span data-ttu-id="e2ccd-230">**圖 15**: DetailsView 控制項中啟用分頁 ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-230">**Figure 15**: Enable Paging in the DetailsView Control ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image41.png))</span></span>


<span data-ttu-id="e2ccd-231">[![啟用分頁，DetailsView 可讓使用者檢視的任何產品](displaying-data-with-the-objectdatasource-cs/_static/image43.png)](displaying-data-with-the-objectdatasource-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-231">[![With Paging Enabled, the DetailsView Allows the User to View Any of the Products](displaying-data-with-the-objectdatasource-cs/_static/image43.png)](displaying-data-with-the-objectdatasource-cs/_static/image42.png)</span></span>

<span data-ttu-id="e2ccd-232">**圖 16**: DetailsView 分頁已啟用，允許使用者檢視的任何產品 ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-232">**Figure 16**: With Paging Enabled, the DetailsView Allows the User to View Any of the Products ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image44.png))</span></span>


<span data-ttu-id="e2ccd-233">我們會詳細討論分頁未來教學課程。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-233">We'll talk more about paging in future tutorials.</span></span>

## <a name="a-more-flexible-layout-for-showing-one-record-at-a-time"></a><span data-ttu-id="e2ccd-234">一次顯示一筆記錄為更有彈性的版面配置</span><span class="sxs-lookup"><span data-stu-id="e2ccd-234">A More Flexible Layout for Showing One Record at a Time</span></span>

<span data-ttu-id="e2ccd-235">在 DetailsView 是相當固定在 ObjectDataSource 所傳回的每一筆記錄的顯示方式。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-235">The DetailsView is pretty rigid in how it displays each record returned from the ObjectDataSource.</span></span> <span data-ttu-id="e2ccd-236">我們可能會想更有彈性的資料檢視。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-236">We may want a more flexible view of the data.</span></span> <span data-ttu-id="e2ccd-237">比方說，而不是個別的資料列上顯示的產品名稱、 類別、 供應商、 價格和已停止的資訊，我們可能想要顯示產品名稱，並在價格`<h4>`標題時，出現的類別目錄] 和 [供應商資訊以下的名稱和價格較小的字型大小。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-237">For example, rather than showing the product's name, category, supplier, price, and discontinued information each on a separate row, we may want to show the product name and price in an `<h4>` heading, with the category and supplier information appearing below the name and price in a smaller font size.</span></span> <span data-ttu-id="e2ccd-238">和我們可能不想要顯示值旁邊的屬性名稱 （產品、 分類等等）。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-238">And we may not care to show the property names (Product, Category, and so on) next to the values.</span></span>

<span data-ttu-id="e2ccd-239">[FormView 控制項](https://msdn.microsoft.com/en-US/library/fyf1dk77.aspx)提供這個層級自訂。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-239">The [FormView control](https://msdn.microsoft.com/en-US/library/fyf1dk77.aspx) provides this level of customization.</span></span> <span data-ttu-id="e2ccd-240">而不是使用欄位 （例如 GridView 和 DetailsView 做到的），在 FormView 會使用範本，可允許混合的 Web 控制項，靜態的 HTML 和[資料繫結語法](http://www.15seconds.com/issue/040630.htm)。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-240">Rather than using fields (like the GridView and DetailsView do), the FormView uses templates, which allow for a mix of Web controls, static HTML, and [databinding syntax](http://www.15seconds.com/issue/040630.htm).</span></span> <span data-ttu-id="e2ccd-241">如果您已熟悉 ASP.NET 從中繼器控制項 1.x，您可以想像在 formview 中繼器顯示單一記錄。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-241">If you are familiar with the Repeater control from ASP.NET 1.x, you can think of the FormView as the Repeater for showing a single record.</span></span>

<span data-ttu-id="e2ccd-242">將 FormView 控制項加入`SimpleDisplay.aspx`頁面的設計介面。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-242">Add a FormView control to the `SimpleDisplay.aspx` page's design surface.</span></span> <span data-ttu-id="e2ccd-243">一開始在 FormView 會顯示為灰色區塊，通知我們，我們需要最小值，提供控制項的`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-243">Initially the FormView displays as a gray block, informing us that we need to provide, at minimum, the control's `ItemTemplate`.</span></span>


<span data-ttu-id="e2ccd-244">[![在 FormView 必須包含 ItemTemplate](displaying-data-with-the-objectdatasource-cs/_static/image46.png)](displaying-data-with-the-objectdatasource-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-244">[![The FormView Must Include an ItemTemplate](displaying-data-with-the-objectdatasource-cs/_static/image46.png)](displaying-data-with-the-objectdatasource-cs/_static/image45.png)</span></span>

<span data-ttu-id="e2ccd-245">**圖 17**: FormView 必須包含`ItemTemplate`([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-245">**Figure 17**: The FormView Must Include an `ItemTemplate` ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image47.png))</span></span>


<span data-ttu-id="e2ccd-246">您可以直接繫結在 FormView 透過在 FormView 的智慧標籤，將會建立預設的資料來源控制項`ItemTemplate`自動 (連同`EditItemTemplate`和`InsertItemTemplate`，如果 ObjectDatatSource 控制項`InsertMethod`和`UpdateMethod`屬性會設定)。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-246">You can bind the FormView directly to a data source control through the FormView's smart tag, which will create a default `ItemTemplate` automatically (along with an `EditItemTemplate` and `InsertItemTemplate`, if the ObjectDatatSource control's `InsertMethod` and `UpdateMethod` properties are set).</span></span> <span data-ttu-id="e2ccd-247">不過，此範例中我們將資料繫結至 FormView 並指定其`ItemTemplate`手動。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-247">However, for this example let's bind the data to the FormView and specify its `ItemTemplate` manually.</span></span> <span data-ttu-id="e2ccd-248">開始，以設定在 FormView 的`DataSourceID`屬性`ID`ObjectDataSource 控制項的`ObjectDataSource1`。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-248">Start by setting the FormView's `DataSourceID` property to the `ID` of the ObjectDataSource control, `ObjectDataSource1`.</span></span> <span data-ttu-id="e2ccd-249">接下來，建立`ItemTemplate`，使其顯示產品的名稱和價格`<h4>`項目和類別目錄和託運商名稱下方，以較小的字型大小。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-249">Next, create the `ItemTemplate` so that it displays the product's name and price in an `<h4>` element and the category and shipper names beneath that in a smaller font size.</span></span>


[!code-aspx[Main](displaying-data-with-the-objectdatasource-cs/samples/sample6.aspx)]


<span data-ttu-id="e2ccd-250">[![第一次的產品 (Chai) 會顯示在自訂格式](displaying-data-with-the-objectdatasource-cs/_static/image49.png)](displaying-data-with-the-objectdatasource-cs/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-250">[![The First Product (Chai) is Displayed in a Custom Format](displaying-data-with-the-objectdatasource-cs/_static/image49.png)](displaying-data-with-the-objectdatasource-cs/_static/image48.png)</span></span>

<span data-ttu-id="e2ccd-251">**圖 18**: 第一次產品 (Chai) 會顯示在自訂格式 ([按一下以檢視完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image50.png))</span><span class="sxs-lookup"><span data-stu-id="e2ccd-251">**Figure 18**: The First Product (Chai) is Displayed in a Custom Format ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image50.png))</span></span>


<span data-ttu-id="e2ccd-252">`<%# Eval(propertyName) %>`是資料繫結的語法。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-252">The `<%# Eval(propertyName) %>` is the databinding syntax.</span></span> <span data-ttu-id="e2ccd-253">`Eval`方法會傳回目前物件所繫結至 FormView 控制項的指定屬性值。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-253">The `Eval` method returns the value of the specified property for the current object being bound to the FormView control.</span></span> <span data-ttu-id="e2ccd-254">請參閱 Alex 荷馬文章 <<c0> [ 簡化並擴充資料繫結語法在 ASP.NET 2.0](http://www.15seconds.com/issue/040630.htm)如需資料繫結的好處。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-254">Check out Alex Homer's article [Simplified and Extended Data Binding Syntax in ASP.NET 2.0](http://www.15seconds.com/issue/040630.htm) for more information on the ins and outs of databinding.</span></span>

<span data-ttu-id="e2ccd-255">DetailsView，像是 FormView 只會顯示從 ObjectDataSource 傳回第一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-255">Like the DetailsView, the FormView only shows the first record returned from the ObjectDataSource.</span></span> <span data-ttu-id="e2ccd-256">您可以啟用要允許訪客逐步執行的一項產品，一次在 FormView 中的分頁。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-256">You can enable paging in the FormView to allow visitors to step through the products one at a time.</span></span>

## <a name="summary"></a><span data-ttu-id="e2ccd-257">總結</span><span class="sxs-lookup"><span data-stu-id="e2ccd-257">Summary</span></span>

<span data-ttu-id="e2ccd-258">存取和顯示資料的商務邏輯層就可完成而不需要撰寫一行程式碼，這點受惠 ASP.NET 2.0 ObjectDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-258">Accessing and displaying data from a Business Logic Layer can be accomplished without writing a line of code thanks to ASP.NET 2.0's ObjectDataSource control.</span></span> <span data-ttu-id="e2ccd-259">ObjectDataSource 叫用指定之類別的方法，並傳回結果。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-259">The ObjectDataSource invokes a specified method of a class and returns the results.</span></span> <span data-ttu-id="e2ccd-260">這些結果可以顯示在資料繫結至 ObjectDataSource Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-260">These results can be displayed in a data Web control that's bound to the ObjectDataSource.</span></span> <span data-ttu-id="e2ccd-261">在此教學課程中我們會探討 GridView、 DetailsView 和在 FormView 的控制項繫結至 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-261">In this tutorial we looked at binding the GridView, DetailsView, and FormView controls to the ObjectDataSource.</span></span>

<span data-ttu-id="e2ccd-262">到目前為止我們只了解如何使用 ObjectDataSource 叫用無參數方法，但如果我們要叫用的方法，必須要有輸入參數，例如`ProductBLL`類別的`GetProductsByCategoryID(categoryID)`嗎？</span><span class="sxs-lookup"><span data-stu-id="e2ccd-262">So far we've only seen how to use the ObjectDataSource to invoke a parameter-less method, but what if we want to invoke a method that expects input parameters, such as the `ProductBLL` class's `GetProductsByCategoryID(categoryID)`?</span></span> <span data-ttu-id="e2ccd-263">若要呼叫的方法必須要有一個或多個參數，我們必須設定 ObjectDataSource 來指定這些參數的值。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-263">In order to call a method that expects one or more parameters we must configure the ObjectDataSource to specify the values for these parameters.</span></span> <span data-ttu-id="e2ccd-264">我們會看到如何完成在我們[下一個教學課程](declarative-parameters-cs.md)。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-264">We'll see how to accomplish this in our [next tutorial](declarative-parameters-cs.md).</span></span>

<span data-ttu-id="e2ccd-265">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="e2ccd-265">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="e2ccd-266">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="e2ccd-266">Further Reading</span></span>

<span data-ttu-id="e2ccd-267">如需有關在本教學課程所討論的主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="e2ccd-267">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e2ccd-268">建立您自己的資料來源控制項</span><span class="sxs-lookup"><span data-stu-id="e2ccd-268">Create Your Own Data Source Controls</span></span>](https://msdn.microsoft.com/en-us/library/ms364049.aspx)
- [<span data-ttu-id="e2ccd-269">ASP.NET 2.0 的 GridView 範例</span><span class="sxs-lookup"><span data-stu-id="e2ccd-269">GridView Examples for ASP.NET 2.0</span></span>](https://msdn.microsoft.com/en-us/library/aa479339.aspx)
- [<span data-ttu-id="e2ccd-270">簡化並擴充資料繫結在 ASP.NET 2.0 的語法</span><span class="sxs-lookup"><span data-stu-id="e2ccd-270">Simplified and Extended Data Binding Syntax in ASP.NET 2.0</span></span>](http://www.15seconds.com/issue/040630.htm)
- [<span data-ttu-id="e2ccd-271">在 ASP.NET 2.0 的佈景主題</span><span class="sxs-lookup"><span data-stu-id="e2ccd-271">Themes in ASP.NET 2.0</span></span>](http://www.odetocode.com/Articles/423.aspx)
- [<span data-ttu-id="e2ccd-272">使用佈景主題的伺服器端樣式</span><span class="sxs-lookup"><span data-stu-id="e2ccd-272">Server-Side Styles Using Themes</span></span>](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx)
- [<span data-ttu-id="e2ccd-273">如何： 以程式設計方式套用 ASP.NET 主題</span><span class="sxs-lookup"><span data-stu-id="e2ccd-273">How To: Apply ASP.NET Themes Programmatically</span></span>](https://msdn.microsoft.com/en-us/library/tx35bd89.aspx)

## <a name="about-the-author"></a><span data-ttu-id="e2ccd-274">關於作者</span><span class="sxs-lookup"><span data-stu-id="e2ccd-274">About the Author</span></span>

<span data-ttu-id="e2ccd-275">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP/ASP.NET 書籍和的創辦[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已從 1998 年使用 Microsoft Web 技術。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-275">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e2ccd-276">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-276">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e2ccd-277">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 2.0 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-277">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e2ccd-278">他可以在達到[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或透過他的部落格，這可以在找到[http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-278">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="e2ccd-279">特別感謝</span><span class="sxs-lookup"><span data-stu-id="e2ccd-279">Special Thanks To</span></span>

<span data-ttu-id="e2ccd-280">許多有用的檢閱者已檢閱本教學課程系列。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-280">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e2ccd-281">在此教學課程的前導檢閱者已 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="e2ccd-281">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="e2ccd-282">檢閱我即將推出的 MSDN 文件有興趣嗎？</span><span class="sxs-lookup"><span data-stu-id="e2ccd-282">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e2ccd-283">如果是這樣，卸除我一行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e2ccd-283">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="e2ccd-284">下一步</span><span class="sxs-lookup"><span data-stu-id="e2ccd-284">Next</span></span>](declarative-parameters-cs.md)
