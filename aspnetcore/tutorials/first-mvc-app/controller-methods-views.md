---
title: ASP.NET Core 中的控制器方法和檢視
author: rick-anderson
description: 了解如何在 ASP.NET Core 中使用控制器方法、檢視和 DataAnnotations。
ms.author: riande
ms.date: 12/13/2018
no-loc:
- Blazor
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: tutorials/first-mvc-app/controller-methods-views
ms.openlocfilehash: 444c870fcf9e866f0c382e32af174442d11d3af5
ms.sourcegitcommit: 70e5f982c218db82aa54aa8b8d96b377cfc7283f
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2020
ms.locfileid: "82777575"
---
# <a name="controller-methods-and-views-in-aspnet-core"></a><span data-ttu-id="b8216-103">ASP.NET Core 中的控制器方法和檢視</span><span class="sxs-lookup"><span data-stu-id="b8216-103">Controller methods and views in ASP.NET Core</span></span>

<span data-ttu-id="b8216-104">作者：[Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="b8216-104">By [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="b8216-105">此電影應用程式有個不錯的開始，但呈現效果不盡理想，例如 **ReleaseDate** 應該是兩個字。</span><span class="sxs-lookup"><span data-stu-id="b8216-105">We have a good start to the movie app, but the presentation isn't ideal, for example, **ReleaseDate** should be two words.</span></span>

![索引檢視：Release Date (發行日期) 是一個字 (不含空格)，且每個電影的發行日期均顯示 12 AM 的時間](working-with-sql/_static/m55.png)

<span data-ttu-id="b8216-107">開啟 *Models/Movie.cs* 檔案，然後新增反白顯示的程式碼行，如下所示：</span><span class="sxs-lookup"><span data-stu-id="b8216-107">Open the *Models/Movie.cs* file and add the highlighted lines shown below:</span></span>

[!code-csharp[](start-mvc/sample/MvcMovie22/Models/MovieDateFixed.cs?name=snippet_1&highlight=2,3,12-13,17)]

<span data-ttu-id="b8216-108">接下來的教學課程會涵蓋 [DataAnnotations](/aspnet/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-6)。</span><span class="sxs-lookup"><span data-stu-id="b8216-108">We cover [DataAnnotations](/aspnet/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-6) in the next tutorial.</span></span> <span data-ttu-id="b8216-109">[Display](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.metadata.displaymetadata) 屬性指定要顯示的欄位名稱 (在本例中為 "Release Date"，而不是 "ReleaseDate")。</span><span class="sxs-lookup"><span data-stu-id="b8216-109">The [Display](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.metadata.displaymetadata) attribute specifies what to display for the name of a field (in this case "Release Date" instead of "ReleaseDate").</span></span> <span data-ttu-id="b8216-110">[DataType](/dotnet/api/microsoft.aspnetcore.mvc.dataannotations.internal.datatypeattributeadapter) 屬性指定資料的類型 (Date)，因此不會顯示儲存在欄位中的時間資訊。</span><span class="sxs-lookup"><span data-stu-id="b8216-110">The [DataType](/dotnet/api/microsoft.aspnetcore.mvc.dataannotations.internal.datatypeattributeadapter) attribute specifies the type of the data (Date), so the time information stored in the field isn't displayed.</span></span>

<span data-ttu-id="b8216-111">`[Column(TypeName = "decimal(18, 2)")]` 資料註解為必要項，因此 Entity Framework Core 可將 `Price` 正確對應到資料庫中的貨幣。</span><span class="sxs-lookup"><span data-stu-id="b8216-111">The `[Column(TypeName = "decimal(18, 2)")]` data annotation is required so Entity Framework Core can correctly map `Price` to currency in the database.</span></span> <span data-ttu-id="b8216-112">如需詳細資訊，請參閱[資料類型](/ef/core/modeling/relational/data-types)。</span><span class="sxs-lookup"><span data-stu-id="b8216-112">For more information, see [Data Types](/ef/core/modeling/relational/data-types).</span></span>

<span data-ttu-id="b8216-113">瀏覽至 `Movies` 控制器，並將滑鼠指標停留在 **Edit** 連結，以查看目標 URL。</span><span class="sxs-lookup"><span data-stu-id="b8216-113">Browse to the `Movies` controller and hold the mouse pointer over an **Edit** link to see the target URL.</span></span>

![滑鼠停留在 Edit 連結並顯示 https://localhost:5001/Movies/Edit/5 的 Url 的瀏覽器視窗](~/tutorials/first-mvc-app/controller-methods-views/_static/edit7.png)

<span data-ttu-id="b8216-115">在 *Views/Movies/Index.cshtml* 檔案中，**Edit**、\*\*Details \*\* 和 **Delete** 連結是由 Core MVC 錨點標記協助程式所產生。</span><span class="sxs-lookup"><span data-stu-id="b8216-115">The **Edit**, **Details**, and **Delete** links are generated by the Core MVC Anchor Tag Helper in the *Views/Movies/Index.cshtml* file.</span></span>

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Views/Movies/IndexOriginal.cshtml?highlight=1-3&range=46-50)]

<span data-ttu-id="b8216-116">[標記](xref:mvc/views/tag-helpers/intro)協助程式可讓伺服器端程式碼參與建立和轉譯檔案中Razor的 HTML 元素。</span><span class="sxs-lookup"><span data-stu-id="b8216-116">[Tag Helpers](xref:mvc/views/tag-helpers/intro) enable server-side code to participate in creating and rendering HTML elements in Razor files.</span></span> <span data-ttu-id="b8216-117">在上述程式碼中， `AnchorTagHelper`會從控制器動作`href`方法和路由識別碼動態產生 HTML 屬性值。您可以從您慣用的瀏覽器使用**View Source** ，或使用開發人員工具來檢查產生的標記。</span><span class="sxs-lookup"><span data-stu-id="b8216-117">In the code above, the `AnchorTagHelper` dynamically generates the HTML `href` attribute value from the controller action method and route id. You use **View Source** from your favorite browser or use the developer tools to examine the generated markup.</span></span> <span data-ttu-id="b8216-118">產生的 HTML 部分如下所示：</span><span class="sxs-lookup"><span data-stu-id="b8216-118">A portion of the generated HTML is shown below:</span></span>

```html
 <td>
    <a href="/Movies/Edit/4"> Edit </a> |
    <a href="/Movies/Details/4"> Details </a> |
    <a href="/Movies/Delete/4"> Delete </a>
</td>
```

<span data-ttu-id="b8216-119">回想在 *Startup.cs* 檔案中設定的[路由](xref:mvc/controllers/routing)格式：</span><span class="sxs-lookup"><span data-stu-id="b8216-119">Recall the format for [routing](xref:mvc/controllers/routing) set in the *Startup.cs* file:</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie3/Startup.cs?name=snippet_1&highlight=5)]

<span data-ttu-id="b8216-120">ASP.NET Core 會將 `https://localhost:5001/Movies/Edit/4` 轉譯成對 `Movies` 控制器的 `Edit` 動作方法的要求，其參數 `Id` 為 4</span><span class="sxs-lookup"><span data-stu-id="b8216-120">ASP.NET Core translates `https://localhost:5001/Movies/Edit/4` into a request to the `Edit` action method of the `Movies` controller with the parameter `Id` of 4.</span></span> <span data-ttu-id="b8216-121">(控制器方法也稱為動作方法)。</span><span class="sxs-lookup"><span data-stu-id="b8216-121">(Controller methods are also known as action methods.)</span></span>

<span data-ttu-id="b8216-122">[標記協助程式](xref:mvc/views/tag-helpers/intro)是 ASP.NET Core 的其中一種最受歡迎的新功能。</span><span class="sxs-lookup"><span data-stu-id="b8216-122">[Tag Helpers](xref:mvc/views/tag-helpers/intro) are one of the most popular new features in ASP.NET Core.</span></span> <span data-ttu-id="b8216-123">如需詳細資訊，請參閱[其他資源](#additional-resources)。</span><span class="sxs-lookup"><span data-stu-id="b8216-123">For more information, see [Additional resources](#additional-resources).</span></span>

<a name="get-post"></a>

<span data-ttu-id="b8216-124">開啟 `Movies` 控制器，並檢查兩個 `Edit` 動作方法。</span><span class="sxs-lookup"><span data-stu-id="b8216-124">Open the `Movies` controller and examine the two `Edit` action methods.</span></span> <span data-ttu-id="b8216-125">下列程式碼顯示`HTTP GET Edit`方法，它會提取電影，並填入編輯的 *. cshtml* Razor檔案所產生的編輯表單。</span><span class="sxs-lookup"><span data-stu-id="b8216-125">The following code shows the `HTTP GET Edit` method, which fetches the movie and populates the edit form generated by the *Edit.cshtml* Razor file.</span></span>

::: moniker range=">= aspnetcore-2.1"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie21/Controllers/MC1.cs?name=snippet_edit1)]

<span data-ttu-id="b8216-126">下列程式碼示範 `HTTP POST Edit` 方法，這個方法會處理已發佈的電影值：</span><span class="sxs-lookup"><span data-stu-id="b8216-126">The following code shows the `HTTP POST Edit` method, which processes the posted movie values:</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/MC1.cs?name=snippet_edit2)]

::: moniker-end

::: moniker range="<= aspnetcore-2.0"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/MC1.cs?name=snippet_edit1)]

<span data-ttu-id="b8216-127">下列程式碼示範 `HTTP POST Edit` 方法，這個方法會處理已發佈的電影值：</span><span class="sxs-lookup"><span data-stu-id="b8216-127">The following code shows the `HTTP POST Edit` method, which processes the posted movie values:</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/MC1.cs?name=snippet_edit2)]

::: moniker-end

<span data-ttu-id="b8216-128">`[Bind]` 屬性是一種防止[過度發佈](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)的方式。</span><span class="sxs-lookup"><span data-stu-id="b8216-128">The `[Bind]` attribute is one way to protect against [over-posting](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost).</span></span> <span data-ttu-id="b8216-129">您應該只在想要變更的 `[Bind]` 屬性 (attribute) 中包含屬性 ( property)。</span><span class="sxs-lookup"><span data-stu-id="b8216-129">You should only include properties in the `[Bind]` attribute that you want to change.</span></span> <span data-ttu-id="b8216-130">如需詳細資訊，請參閱[保護控制器避免過度發佈](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application)。</span><span class="sxs-lookup"><span data-stu-id="b8216-130">For more information, see [Protect your controller from over-posting](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application).</span></span> <span data-ttu-id="b8216-131">[ViewModels](https://rachelappel.com/use-viewmodels-to-manage-data-amp-organize-code-in-asp-net-mvc-applications/) 提供防止過度發佈的替代方法。</span><span class="sxs-lookup"><span data-stu-id="b8216-131">[ViewModels](https://rachelappel.com/use-viewmodels-to-manage-data-amp-organize-code-in-asp-net-mvc-applications/) provide an alternative approach to prevent over-posting.</span></span>

<span data-ttu-id="b8216-132">請注意，第二個 `Edit` 動作方法的前面是 `[HttpPost]` 屬性。</span><span class="sxs-lookup"><span data-stu-id="b8216-132">Notice the second `Edit` action method is preceded by the `[HttpPost]` attribute.</span></span>

::: moniker range=">= aspnetcore-2.1"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie21/Controllers/MC1.cs?name=snippet_edit2&highlight=1)]

::: moniker-end

::: moniker range="<= aspnetcore-2.0"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/MC1.cs?name=snippet_edit2&highlight=4)]

::: moniker-end

<span data-ttu-id="b8216-133">`HttpPost` 屬性指定「只」\*\* 能為 `POST` 要求叫用這個 `Edit` 方法。</span><span class="sxs-lookup"><span data-stu-id="b8216-133">The `HttpPost` attribute specifies that this `Edit` method can be invoked *only* for `POST` requests.</span></span> <span data-ttu-id="b8216-134">您可以將 `[HttpGet]` 屬性套用至第一個編輯方法，但不需要執行此動作，因為 `[HttpGet]` 是預設值。</span><span class="sxs-lookup"><span data-stu-id="b8216-134">You could apply the `[HttpGet]` attribute to the first edit method, but that's not necessary because `[HttpGet]` is the default.</span></span>

<span data-ttu-id="b8216-135">`ValidateAntiForgeryToken` 屬性是用來[防範要求偽造](xref:security/anti-request-forgery)，並與編輯檢視檔案 (*Views/Movies/Edit.cshtml*) 所產生的防偽語彙基元成對。</span><span class="sxs-lookup"><span data-stu-id="b8216-135">The `ValidateAntiForgeryToken` attribute is used to [prevent forgery of a request](xref:security/anti-request-forgery) and is paired up with an anti-forgery token generated in the edit view file (*Views/Movies/Edit.cshtml*).</span></span> <span data-ttu-id="b8216-136">編輯檢視檔案使用[表單標記協助程式](xref:mvc/views/working-with-forms)產生防偽語彙基元。</span><span class="sxs-lookup"><span data-stu-id="b8216-136">The edit view file generates the anti-forgery token with the [Form Tag Helper](xref:mvc/views/working-with-forms).</span></span>

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Views/Movies/Edit.cshtml?range=9)]

<span data-ttu-id="b8216-137">[表單標記協助程式](xref:mvc/views/working-with-forms)會產生隱藏的防偽語彙基元，其必須符合電影控制器的 `Edit` 方法中 `[ValidateAntiForgeryToken]` 產生的防偽語彙基元。</span><span class="sxs-lookup"><span data-stu-id="b8216-137">The [Form Tag Helper](xref:mvc/views/working-with-forms) generates a hidden anti-forgery token that must match the `[ValidateAntiForgeryToken]` generated anti-forgery token in the `Edit` method of the Movies controller.</span></span> <span data-ttu-id="b8216-138">如需詳細資訊，請參閱[反要求偽造](xref:security/anti-request-forgery)。</span><span class="sxs-lookup"><span data-stu-id="b8216-138">For more information, see [Anti-Request Forgery](xref:security/anti-request-forgery).</span></span>

<span data-ttu-id="b8216-139">`HttpGet Edit` 方法會採用電影 `ID` 參數，使用 Entity Framework `FindAsync` 方法查詢電影，並將選取的電影傳回 Edit 檢視。</span><span class="sxs-lookup"><span data-stu-id="b8216-139">The `HttpGet Edit` method takes the movie `ID` parameter, looks up the movie using the Entity Framework `FindAsync` method, and returns the selected movie to the Edit view.</span></span> <span data-ttu-id="b8216-140">如果找不到電影，會傳回 `NotFound` (HTTP 404)。</span><span class="sxs-lookup"><span data-stu-id="b8216-140">If a movie cannot be found, `NotFound` (HTTP 404) is returned.</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie21/Controllers/MC1.cs?name=snippet_edit1)]

<span data-ttu-id="b8216-141">當 Scaffolding 系統建立 Edit 檢視時，它會檢查 `Movie` 類別，並建立程式碼為類別的每個屬性轉譯 `<label>` 和 `<input>` 元素。</span><span class="sxs-lookup"><span data-stu-id="b8216-141">When the scaffolding system created the Edit view, it examined the `Movie` class and created code to render `<label>` and `<input>` elements for each property of the class.</span></span> <span data-ttu-id="b8216-142">下列範例會顯示 Visual Studio Scaffolding 系統所產生的 Edit 檢視：</span><span class="sxs-lookup"><span data-stu-id="b8216-142">The following example shows the Edit view that was generated by the Visual Studio scaffolding system:</span></span>

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie22/Views/Movies/EditOriginal.cshtml)]

<span data-ttu-id="b8216-143">請注意檢視範本在檔案最上方指定 `@model MvcMovie.Models.Movie` 陳述式的方式。</span><span class="sxs-lookup"><span data-stu-id="b8216-143">Notice how the view template has a `@model MvcMovie.Models.Movie` statement at the top of the file.</span></span> <span data-ttu-id="b8216-144">`@model MvcMovie.Models.Movie` 指定檢視預期檢視範本的模型必須是 `Movie` 型別。</span><span class="sxs-lookup"><span data-stu-id="b8216-144">`@model MvcMovie.Models.Movie` specifies that the view expects the model for the view template to be of type `Movie`.</span></span>

<span data-ttu-id="b8216-145">包含 Scaffold 的程式碼會使用數個標記協助程式方法來簡化 HTML 標記。</span><span class="sxs-lookup"><span data-stu-id="b8216-145">The scaffolded code uses several Tag Helper methods to streamline the HTML markup.</span></span> <span data-ttu-id="b8216-146">[標籤標記協助程式](xref:mvc/views/working-with-forms)顯示欄位的名稱 ("Title"、"ReleaseDate"、"Genre" 或 "Price")。</span><span class="sxs-lookup"><span data-stu-id="b8216-146">The - [Label Tag Helper](xref:mvc/views/working-with-forms) displays the name of the field ("Title", "ReleaseDate", "Genre", or "Price").</span></span> <span data-ttu-id="b8216-147">[輸入標記協助程式](xref:mvc/views/working-with-forms)轉譯 HTML `<input>` 元素。</span><span class="sxs-lookup"><span data-stu-id="b8216-147">The [Input Tag Helper](xref:mvc/views/working-with-forms) renders an HTML `<input>` element.</span></span> <span data-ttu-id="b8216-148">[驗證標記協助程式](xref:mvc/views/working-with-forms)則顯示與該屬性相關聯的任何驗證訊息。</span><span class="sxs-lookup"><span data-stu-id="b8216-148">The [Validation Tag Helper](xref:mvc/views/working-with-forms) displays any validation messages associated with that property.</span></span>

<span data-ttu-id="b8216-149">執行應用程式，並巡覽至 `/Movies` URL。</span><span class="sxs-lookup"><span data-stu-id="b8216-149">Run the application and navigate to the `/Movies` URL.</span></span> <span data-ttu-id="b8216-150">按一下 [**編輯**] 連結。</span><span class="sxs-lookup"><span data-stu-id="b8216-150">Click an **Edit** link.</span></span> <span data-ttu-id="b8216-151">在瀏覽器中，檢視頁面的原始檔。</span><span class="sxs-lookup"><span data-stu-id="b8216-151">In the browser, view the source for the page.</span></span> <span data-ttu-id="b8216-152">`<form>` 元素產生的 HTML 如下所示。</span><span class="sxs-lookup"><span data-stu-id="b8216-152">The generated HTML for the `<form>` element is shown below.</span></span>

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Views/Shared/edit_view_source.html?highlight=1,6,10,17,24,28)]

<span data-ttu-id="b8216-153">`<input>` 元素位於 `HTML <form>` 元素中，而後者的 `action` 屬性設定為發佈到 `/Movies/Edit/id` URL。</span><span class="sxs-lookup"><span data-stu-id="b8216-153">The `<input>` elements are in an `HTML <form>` element whose `action` attribute is set to post to the `/Movies/Edit/id` URL.</span></span> <span data-ttu-id="b8216-154">按一下 `Save` 按鈕時，表單資料將發佈至伺服器。</span><span class="sxs-lookup"><span data-stu-id="b8216-154">The form data will be posted to the server when the `Save` button is clicked.</span></span> <span data-ttu-id="b8216-155">在結尾 `</form>` 元素之前的最後一行會顯示[表單標記協助程式](xref:mvc/views/working-with-forms)所產生的隱藏 [XSRF](xref:security/anti-request-forgery) 語彙基元。</span><span class="sxs-lookup"><span data-stu-id="b8216-155">The last line before the closing `</form>` element shows the hidden [XSRF](xref:security/anti-request-forgery) token generated by the [Form Tag Helper](xref:mvc/views/working-with-forms).</span></span>

## <a name="processing-the-post-request"></a><span data-ttu-id="b8216-156">處理 POST 要求</span><span class="sxs-lookup"><span data-stu-id="b8216-156">Processing the POST Request</span></span>

<span data-ttu-id="b8216-157">下列清單顯示 `[HttpPost]` 版本的 `Edit` 動作方法。</span><span class="sxs-lookup"><span data-stu-id="b8216-157">The following listing shows the `[HttpPost]` version of the `Edit` action method.</span></span>

::: moniker range=">= aspnetcore-2.1"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie21/Controllers/MC1.cs?name=snippet_edit2)]

::: moniker-end

::: moniker range="<= aspnetcore-2.0"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/MC1.cs?name=snippet_edit2)]

::: moniker-end

<span data-ttu-id="b8216-158">`[ValidateAntiForgeryToken]` 屬性會驗證[表單標記協助程式](xref:mvc/views/working-with-forms) 中的防偽語彙基元產生器所產生的隱藏 [XSRF](xref:security/anti-request-forgery) 語彙基元</span><span class="sxs-lookup"><span data-stu-id="b8216-158">The `[ValidateAntiForgeryToken]` attribute validates the hidden [XSRF](xref:security/anti-request-forgery) token generated by the anti-forgery token generator in the [Form Tag Helper](xref:mvc/views/working-with-forms)</span></span>

<span data-ttu-id="b8216-159">[模型繫結](xref:mvc/models/model-binding)系統採用已發佈的表單值，並建立以 `movie` 參數傳遞的 `Movie` 物件。</span><span class="sxs-lookup"><span data-stu-id="b8216-159">The [model binding](xref:mvc/models/model-binding) system takes the posted form values and creates a `Movie` object that's passed as the `movie` parameter.</span></span> <span data-ttu-id="b8216-160">`ModelState.IsValid` 方法會驗證表單中提交的資料可用於修改 (編輯或更新) `Movie` 物件。</span><span class="sxs-lookup"><span data-stu-id="b8216-160">The `ModelState.IsValid` method verifies that the data submitted in the form can be used to modify (edit or update) a `Movie` object.</span></span> <span data-ttu-id="b8216-161">如果資料有效，則會進行儲存。</span><span class="sxs-lookup"><span data-stu-id="b8216-161">If the data is valid, it's saved.</span></span> <span data-ttu-id="b8216-162">藉由呼叫資料庫內容的 `SaveChangesAsync` 方法，更新 (編輯) 的電影資料會儲存到資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8216-162">The updated (edited) movie data is saved to the database by calling the `SaveChangesAsync` method of database context.</span></span> <span data-ttu-id="b8216-163">儲存資料之後，程式碼將使用者重新導向至 `MoviesController` 類別的 `Index` 動作方法，此方法會顯示電影集合，包括剛剛所進行的變更。</span><span class="sxs-lookup"><span data-stu-id="b8216-163">After saving the data, the code redirects the user to the `Index` action method of the `MoviesController` class, which displays the movie collection, including the changes just made.</span></span>

<span data-ttu-id="b8216-164">在表單發佈至伺服器之前，用戶端驗證會對欄位檢查任何驗證規則。</span><span class="sxs-lookup"><span data-stu-id="b8216-164">Before the form is posted to the server, client-side validation checks any validation rules on the fields.</span></span> <span data-ttu-id="b8216-165">如果出現任何驗證錯誤，即會顯示錯誤訊息，且不會發佈該表單。</span><span class="sxs-lookup"><span data-stu-id="b8216-165">If there are any validation errors, an error message is displayed and the form isn't posted.</span></span> <span data-ttu-id="b8216-166">如果已停用 JavaScript，就不會進行用戶端驗證，但伺服器偵測到無效的發佈值，因此會重新顯示表單值並顯示錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="b8216-166">If JavaScript is disabled, you won't have client-side validation but the server will detect the posted values that are not valid, and the form values will be redisplayed with error messages.</span></span> <span data-ttu-id="b8216-167">稍後在本教學課程中，我們會更詳細檢查[模型驗證](xref:mvc/models/validation)。</span><span class="sxs-lookup"><span data-stu-id="b8216-167">Later in the tutorial we examine [Model Validation](xref:mvc/models/validation) in more detail.</span></span> <span data-ttu-id="b8216-168">*Views/Movies/Edit.cshtml* 檢視範本中的[驗證標記協助程式](xref:mvc/views/working-with-forms)負責顯示適當的錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="b8216-168">The [Validation Tag Helper](xref:mvc/views/working-with-forms) in the *Views/Movies/Edit.cshtml* view template takes care of displaying appropriate error messages.</span></span>

![Edit 檢視：Price 值 abc 不正確的例外狀況指出 Price 欄位必須是數字。](~/tutorials/first-mvc-app/controller-methods-views/_static/val.png)

<span data-ttu-id="b8216-171">電影控制器中的所有 `HttpGet` 方法都遵循類似的模式。</span><span class="sxs-lookup"><span data-stu-id="b8216-171">All the `HttpGet` methods in the movie controller follow a similar pattern.</span></span> <span data-ttu-id="b8216-172">他們會取得電影物件 (如果是 `Index`則為物件清單)，並將此物件 (模型) 傳遞至檢視。</span><span class="sxs-lookup"><span data-stu-id="b8216-172">They get a movie object (or list of objects, in the case of `Index`), and pass the object (model) to the view.</span></span> <span data-ttu-id="b8216-173">`Create` 方法會將空白電影物件傳遞至 `Create` 檢視。</span><span class="sxs-lookup"><span data-stu-id="b8216-173">The `Create` method passes an empty movie object to the `Create` view.</span></span> <span data-ttu-id="b8216-174">建立、編輯、刪除或以其他方式修改資料的所有方法都會在方法的 `[HttpPost]` 多載中執行這個動作。</span><span class="sxs-lookup"><span data-stu-id="b8216-174">All the methods that create, edit, delete, or otherwise modify data do so in the `[HttpPost]` overload of the method.</span></span> <span data-ttu-id="b8216-175">修改 `HTTP GET` 方法中的資料會造成安全性風險。</span><span class="sxs-lookup"><span data-stu-id="b8216-175">Modifying data in an `HTTP GET` method is a security risk.</span></span> <span data-ttu-id="b8216-176">修改 `HTTP GET` 方法中的資料，也違反 HTTP 最佳做法及架構式 [REST](http://rest.elkstein.org/) 模式，此模式指定 GET 要求不應該變更應用程式的狀態。</span><span class="sxs-lookup"><span data-stu-id="b8216-176">Modifying data in an `HTTP GET` method also violates HTTP best practices and the architectural [REST](http://rest.elkstein.org/) pattern, which specifies that GET requests shouldn't change the state of your application.</span></span> <span data-ttu-id="b8216-177">也就是說，執行 GET 作業應該是安全的作業，沒有任何副作用，而且不會修改您的保存資料。</span><span class="sxs-lookup"><span data-stu-id="b8216-177">In other words, performing a GET operation should be a safe operation that has no side effects and doesn't modify your persisted data.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="b8216-178">其他資源</span><span class="sxs-lookup"><span data-stu-id="b8216-178">Additional resources</span></span>

* [<span data-ttu-id="b8216-179">全球化和當地語系化</span><span class="sxs-lookup"><span data-stu-id="b8216-179">Globalization and localization</span></span>](xref:fundamentals/localization)
* [<span data-ttu-id="b8216-180">標記協助程式簡介</span><span class="sxs-lookup"><span data-stu-id="b8216-180">Introduction to Tag Helpers</span></span>](xref:mvc/views/tag-helpers/intro)
* [<span data-ttu-id="b8216-181">編寫標籤協助程式</span><span class="sxs-lookup"><span data-stu-id="b8216-181">Author Tag Helpers</span></span>](xref:mvc/views/tag-helpers/authoring)
* [<span data-ttu-id="b8216-182">防偽要求</span><span class="sxs-lookup"><span data-stu-id="b8216-182">Anti-Request Forgery</span></span>](xref:security/anti-request-forgery)
* <span data-ttu-id="b8216-183">保護控制器避免[過度發佈](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application)</span><span class="sxs-lookup"><span data-stu-id="b8216-183">Protect your controller from [over-posting](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application)</span></span>
* [<span data-ttu-id="b8216-184">ViewModels</span><span class="sxs-lookup"><span data-stu-id="b8216-184">ViewModels</span></span>](https://rachelappel.com/use-viewmodels-to-manage-data-amp-organize-code-in-asp-net-mvc-applications/)
* [<span data-ttu-id="b8216-185">表單標記協助程式</span><span class="sxs-lookup"><span data-stu-id="b8216-185">Form Tag Helper</span></span>](xref:mvc/views/working-with-forms)
* [<span data-ttu-id="b8216-186">輸入標記協助程式</span><span class="sxs-lookup"><span data-stu-id="b8216-186">Input Tag Helper</span></span>](xref:mvc/views/working-with-forms)
* [<span data-ttu-id="b8216-187">標籤標記協助程式</span><span class="sxs-lookup"><span data-stu-id="b8216-187">Label Tag Helper</span></span>](xref:mvc/views/working-with-forms)
* [<span data-ttu-id="b8216-188">選取標記協助程式</span><span class="sxs-lookup"><span data-stu-id="b8216-188">Select Tag Helper</span></span>](xref:mvc/views/working-with-forms)
* [<span data-ttu-id="b8216-189">驗證標記協助程式</span><span class="sxs-lookup"><span data-stu-id="b8216-189">Validation Tag Helper</span></span>](xref:mvc/views/working-with-forms)

> [!div class="step-by-step"]
> <span data-ttu-id="b8216-190">[上一頁](working-with-sql.md)
> [下一頁](search.md)</span><span class="sxs-lookup"><span data-stu-id="b8216-190">[Previous](working-with-sql.md)
[Next](search.md)</span></span>  
