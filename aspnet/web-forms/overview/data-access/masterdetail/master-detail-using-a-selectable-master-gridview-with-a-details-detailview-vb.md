---
uid: web-forms/overview/data-access/masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb
title: 使用具有 (VB) 的詳細資料 detailview 之可選取主要 GridView 的主要/詳細資料 |Microsoft Docs
author: rick-anderson
description: 本教學課程中會有的 GridView，其資料列包含名稱和每個產品價格以及 [選取] 按鈕。 按一下 [選取] 按鈕的 particu...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 1d1a7c93-971d-4690-9c5e-dac0e5014a09
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb
msc.type: authoredcontent
ms.openlocfilehash: a97323700e20aed12ee29674952f1ffe9144133c
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/03/2018
ms.locfileid: "37366037"
---
<a name="masterdetail-using-a-selectable-master-gridview-with-a-details-detailview-vb"></a><span data-ttu-id="7a6ac-104">使用具有 (VB) 的詳細資料 detailview 之可選取主要 GridView 的主要/詳細資料</span><span class="sxs-lookup"><span data-stu-id="7a6ac-104">Master/Detail Using a Selectable Master GridView with a Details DetailView (VB)</span></span>
====================
<span data-ttu-id="7a6ac-105">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7a6ac-106">[下載範例應用程式](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_10_VB.exe)或[下載 PDF](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/datatutorial10vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_10_VB.exe) or [Download PDF](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/datatutorial10vb1.pdf)</span></span>

> <span data-ttu-id="7a6ac-107">本教學課程中會有的 GridView，其資料列包含名稱和每個產品價格以及 [選取] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-107">This tutorial will have a GridView whose rows include the name and price of each product along with a Select button.</span></span> <span data-ttu-id="7a6ac-108">按一下特定產品的 [選取] 按鈕將會導致在相同網頁的 DetailsView 控制項中顯示其完整詳細資料。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-108">Clicking the Select button for a particular product will cause its full details to be displayed in a DetailsView control on the same page.</span></span>


## <a name="introduction"></a><span data-ttu-id="7a6ac-109">簡介</span><span class="sxs-lookup"><span data-stu-id="7a6ac-109">Introduction</span></span>

<span data-ttu-id="7a6ac-110">在 [先前的教學課程](master-detail-filtering-across-two-pages-vb.md)我們了解如何建立使用兩個網頁的主版/詳細報告: 「 主要 」 的網頁上，我們用來顯示供應商; 清單，列出所選提供這些產品的 [詳細資料] 網頁供應商。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-110">In the [previous tutorial](master-detail-filtering-across-two-pages-vb.md) we saw how to create a master/detail report using two web pages: a "master" web page, from which we displayed the list of suppliers; and a "details" web page that listed those products provided by the selected supplier.</span></span> <span data-ttu-id="7a6ac-111">這兩個頁面的報表格式可以壓縮成一頁中。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-111">This two page report format can be condensed into one page.</span></span> <span data-ttu-id="7a6ac-112">本教學課程中會有的 GridView，其資料列包含名稱和每個產品價格以及 [選取] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-112">This tutorial will have a GridView whose rows include the name and price of each product along with a Select button.</span></span> <span data-ttu-id="7a6ac-113">按一下特定產品的 [選取] 按鈕將會導致在相同網頁的 DetailsView 控制項中顯示其完整詳細資料。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-113">Clicking the Select button for a particular product will cause its full details to be displayed in a DetailsView control on the same page.</span></span>


<span data-ttu-id="7a6ac-114">[![按一下 [選取] 按鈕會顯示產品的詳細資料](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image2.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-114">[![Clicking the Select Button Displays the Product's Details](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image2.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image1.png)</span></span>

<span data-ttu-id="7a6ac-115">**圖 1**： 按一下 [選取] 按鈕會顯示產品的詳細資料 ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-115">**Figure 1**: Clicking the Select Button Displays the Product's Details ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image3.png))</span></span>


## <a name="step-1-creating-a-selectable-gridview"></a><span data-ttu-id="7a6ac-116">步驟 1： 建立可選取的 GridView</span><span class="sxs-lookup"><span data-stu-id="7a6ac-116">Step 1: Creating a Selectable GridView</span></span>

<span data-ttu-id="7a6ac-117">回想一下，在兩個頁面主版/詳細報告每個主要的記錄包含超連結，按一下時，傳送給使用者傳遞的已按下 資料列的詳細資料頁面`SupplierID`於 querystring 中的值。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-117">Recall that in the two-page master/detail report that each master record included a hyperlink that, when clicked, sent the user to the details page passing the clicked row's `SupplierID` value in the querystring.</span></span> <span data-ttu-id="7a6ac-118">這類的超連結加入至每個使用 HyperLinkField 的 GridView 資料列。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-118">Such a hyperlink was added to each GridView row using a HyperLinkField.</span></span> <span data-ttu-id="7a6ac-119">單一頁面主版/詳細資料報表中，我們需要一個按鈕的每個 GridView 資料列，按一下時，會顯示詳細資料。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-119">For the single page master/details report, we will need a Button for each GridView row that, when clicked, shows the details.</span></span> <span data-ttu-id="7a6ac-120">GridView 控制項可以設定為包含每個資料列，造成回傳，並將該資料列標示為 GridView 的 [選取] 按鈕[SelectedRow](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedrow.aspx)。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-120">The GridView control can be configured to include a Select button for each row that causes a postback and marks that row as the GridView's [SelectedRow](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedrow.aspx).</span></span>

<span data-ttu-id="7a6ac-121">著手將 GridView 控制項加入`DetailsBySelecting.aspx`頁面中`Filtering`資料夾中，設定其`ID`屬性設`ProductsGrid`。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-121">Start by adding a GridView control to the `DetailsBySelecting.aspx` page in the `Filtering` folder, setting its `ID` property to `ProductsGrid`.</span></span> <span data-ttu-id="7a6ac-122">接下來，新增名為新 ObjectDataSource`AllProductsDataSource`叫用`ProductsBLL`類別的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-122">Next, add a new ObjectDataSource named `AllProductsDataSource` that invokes the `ProductsBLL` class's `GetProducts()` method.</span></span>


<span data-ttu-id="7a6ac-123">[![建立名為 AllProductsDataSource ObjectDataSource](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image5.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-123">[![Create an ObjectDataSource Named AllProductsDataSource](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image5.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image4.png)</span></span>

<span data-ttu-id="7a6ac-124">**圖 2**： 建立名為 ObjectDataSource `AllProductsDataSource` ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-124">**Figure 2**: Create an ObjectDataSource Named `AllProductsDataSource` ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image6.png))</span></span>


<span data-ttu-id="7a6ac-125">[![使用 ProductsBLL 類別](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image8.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-125">[![Use the ProductsBLL Class](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image8.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image7.png)</span></span>

<span data-ttu-id="7a6ac-126">**圖 3**： 使用`ProductsBLL`類別 ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-126">**Figure 3**: Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image9.png))</span></span>


<span data-ttu-id="7a6ac-127">[![設定要叫用 GetProducts() 方法的 ObjectDataSource](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image11.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-127">[![Configure the ObjectDataSource to Invoke the GetProducts() Method](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image11.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image10.png)</span></span>

<span data-ttu-id="7a6ac-128">**圖 4**： 設定要叫用 ObjectDataSource`GetProducts()`方法 ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-128">**Figure 4**: Configure the ObjectDataSource to Invoke the `GetProducts()` Method ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image12.png))</span></span>


<span data-ttu-id="7a6ac-129">編輯移除的 GridView 的欄位以外的所有`ProductName`和`UnitPrice`BoundFields。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-129">Edit the GridView's fields removing all but the `ProductName` and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="7a6ac-130">此外，您可以自訂這些 BoundFields 如有需要格式化等`UnitPrice`成貨幣 BoundField 和變更`HeaderText`BoundFields 的屬性。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-130">Also, feel free to customize these BoundFields as needed, such as formatting the `UnitPrice` BoundField as a currency and changing the `HeaderText` properties of the BoundFields.</span></span> <span data-ttu-id="7a6ac-131">按一下 [編輯資料行] 連結，從 GridView 的智慧標籤，或透過手動設定的宣告式語法，可以以圖形方式，完成這些步驟。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-131">These steps can be accomplished graphically, by clicking the Edit Columns link from the GridView's smart tag, or by manually configuring the declarative syntax.</span></span>


<span data-ttu-id="7a6ac-132">[![移除的產品名稱和單價 BoundFields 以外的所有](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image14.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-132">[![Remove All But the ProductName and UnitPrice BoundFields](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image14.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image13.png)</span></span>

<span data-ttu-id="7a6ac-133">**圖 5**： 移除以外的所有`ProductName`並`UnitPrice`BoundFields ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-133">**Figure 5**: Remove All But the `ProductName` and `UnitPrice` BoundFields ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image15.png))</span></span>


<span data-ttu-id="7a6ac-134">GridView 的最後一個標記是：</span><span class="sxs-lookup"><span data-stu-id="7a6ac-134">The final markup for the GridView is:</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample1.aspx)]

<span data-ttu-id="7a6ac-135">接下來，我們需要將標示為選取，將會新增至每個資料列的 [選取] 按鈕的 GridView。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-135">Next, we need to mark the GridView as selectable, which will add a Select button to each row.</span></span> <span data-ttu-id="7a6ac-136">若要達成此目的，只是檢查 GridView 的智慧標籤中啟用選取核取方塊。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-136">To accomplish this, simply check the Enable Selection checkbox in the GridView's smart tag.</span></span>


<span data-ttu-id="7a6ac-137">[![使 GridView 的資料列選取](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image17.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-137">[![Make the GridView's Rows Selectable](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image17.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image16.png)</span></span>

<span data-ttu-id="7a6ac-138">**圖 6**： 讓選取的 GridView 資料列 ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-138">**Figure 6**: Make the GridView's Rows Selectable ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image18.png))</span></span>


<span data-ttu-id="7a6ac-139">檢查 [啟用選取範圍] 選項新增至 CommandField `ProductsGrid` GridView 與其`ShowSelectButton`屬性設為 True。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-139">Checking the Enabling Selection option adds a CommandField to the `ProductsGrid` GridView with its `ShowSelectButton` property set to True.</span></span> <span data-ttu-id="7a6ac-140">這會導致 選取 按鈕的每個資料列的 GridView，如 圖 6 所示。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-140">This results in a Select button for each row of the GridView, as Figure 6 illustrates.</span></span> <span data-ttu-id="7a6ac-141">根據預設，[選取] 按鈕會呈現為 Linkbutton，但是您可以使用按鈕或 ImageButtons 改為透過 CommandField`ButtonType`屬性。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-141">By default, the Select buttons are rendered as LinkButtons, but you can use Buttons or ImageButtons instead through the CommandField's `ButtonType` property.</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample2.aspx)]

<span data-ttu-id="7a6ac-142">按下 GridView 資料列的 [選取] 按鈕時回傳接踵而來和 GridView`SelectedRow`屬性更新。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-142">When a GridView row's Select button is clicked a postback ensues and the GridView's `SelectedRow` property is updated.</span></span> <span data-ttu-id="7a6ac-143">除了`SelectedRow`提供的屬性，GridView [SelectedIndex](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedindex%28VS.80%29.aspx)， [SelectedValue](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedvalue%28VS.80%29.aspx)，和[SelectedDataKey](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selecteddatakey%28VS.80%29.aspx)屬性。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-143">In addition to the `SelectedRow` property, the GridView provides the [SelectedIndex](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedindex%28VS.80%29.aspx), [SelectedValue](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selectedvalue%28VS.80%29.aspx), and [SelectedDataKey](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.selecteddatakey%28VS.80%29.aspx) properties.</span></span> <span data-ttu-id="7a6ac-144">`SelectedIndex`屬性會傳回選取的資料列的索引，而`SelectedValue`並`SelectedDataKey`屬性會傳回值根據 GridView [DataKeyNames 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames%28VS.80%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-144">The `SelectedIndex` property returns the index of the selected row, whereas the `SelectedValue` and `SelectedDataKey` properties return values based upon the GridView's [DataKeyNames property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames%28VS.80%29.aspx).</span></span>

<span data-ttu-id="7a6ac-145">`DataKeyNames`屬性用來建立關聯的其中一個或多個資料欄位值的每一列，並且通常用來從基礎資料與每個 GridView 資料列的唯一識別資訊的屬性。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-145">The `DataKeyNames` property is used to associate one or more data field values with each row and is commonly used to attribute uniquely identifying information from the underlying data with each GridView row.</span></span> <span data-ttu-id="7a6ac-146">`SelectedValue`屬性會傳回值的第一個`DataKeyNames`選取的資料列的資料欄位做為 where`SelectedDataKey`屬性會傳回選取的資料列`DataKey`物件，其中包含所有指定的資料索引鍵欄位的值該資料列。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-146">The `SelectedValue` property returns the value of the first `DataKeyNames` data field for the selected row where as the `SelectedDataKey` property returns the selected row's `DataKey` object, which contains all of the values for the specified data key fields for that row.</span></span>

<span data-ttu-id="7a6ac-147">`DataKeyNames`資料來源繫結至 GridView、 DetailsView 或 FormView 透過設計工具時自動屬性設定為用來唯一識別的資料欄位。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-147">The `DataKeyNames` property is automatically set to the uniquely-identifying data field(s) when you bind a data source to a GridView, DetailsView, or FormView through the Designer.</span></span> <span data-ttu-id="7a6ac-148">雖然設定此屬性已為我們自動在先前的教學課程中，範例會曾不`DataKeyNames`指定的屬性。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-148">While this property has been set for us automatically in the preceding tutorials, the examples would have worked without the `DataKeyNames` property specified.</span></span> <span data-ttu-id="7a6ac-149">不過，在本教學課程中，可選取的 GridView 以及未來的教學課程中我們將會檢查插入、 更新和刪除`DataKeyNames`屬性必須正確設定。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-149">However, for the selectable GridView in this tutorial, as well as for future tutorials in which we'll be examining inserting, updating, and deleting, the `DataKeyNames` property must be set properly.</span></span> <span data-ttu-id="7a6ac-150">請花一點時間確認您的 GridView`DataKeyNames`屬性設定為`ProductID`。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-150">Take a moment to ensure that your GridView's `DataKeyNames` property is set to `ProductID`.</span></span>

<span data-ttu-id="7a6ac-151">讓我們來檢視透過瀏覽器到目前為止我們進度。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-151">Let's view our progress thus far through a browser.</span></span> <span data-ttu-id="7a6ac-152">請注意，GridView 會列出所有選取的 LinkButton 以及產品的價格與名稱。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-152">Note that the GridView lists the name and price for all of the products along with a Select LinkButton.</span></span> <span data-ttu-id="7a6ac-153">按一下 [選取] 按鈕時，會導致回傳。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-153">Clicking the Select button causes a postback.</span></span> <span data-ttu-id="7a6ac-154">在步驟 2 中，我們會看到如何讓此回傳 DetailsView 回應會顯示所選產品的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-154">In Step 2 we'll see how to have a DetailsView respond to this postback by displaying the details for the selected product.</span></span>


<span data-ttu-id="7a6ac-155">[![每個產品的資料列包含選取的 LinkButton](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image20.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-155">[![Each Product Row Contains a Select LinkButton](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image20.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image19.png)</span></span>

<span data-ttu-id="7a6ac-156">**圖 7**： 每個產品的資料列包含選取的 LinkButton ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-156">**Figure 7**: Each Product Row Contains a Select LinkButton ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image21.png))</span></span>


## <a name="highlighting-the-selected-row"></a><span data-ttu-id="7a6ac-157">反白顯示選取的資料列</span><span class="sxs-lookup"><span data-stu-id="7a6ac-157">Highlighting the Selected Row</span></span>

<span data-ttu-id="7a6ac-158">`ProductsGrid` GridView 有`SelectedRowStyle`可以用來指定選取的資料列的視覺化樣式的屬性。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-158">The `ProductsGrid` GridView has a `SelectedRowStyle` property that can be used to dictate the visual style for the selected row.</span></span> <span data-ttu-id="7a6ac-159">使用方式正確，這可以改善使用者經驗的詳細清楚地顯示目前選取的 GridView 資料列。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-159">Used properly, this can improve the user's experience by more clearly showing which row of the GridView is currently selected.</span></span> <span data-ttu-id="7a6ac-160">本教學課程中，讓我們以黃色背景反白顯示選取的資料列。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-160">For this tutorial, let's have the selected row be highlighted with a yellow background.</span></span>

<span data-ttu-id="7a6ac-161">如同我們先前的教學課程，讓我們致力於將定義為 CSS 類別的美觀相關設定。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-161">As with our earlier tutorials, let's strive to keep the aesthetic-related settings defined as CSS classes.</span></span> <span data-ttu-id="7a6ac-162">因此，建立新的 CSS 類別中`Styles.css`名為`SelectedRowStyle`。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-162">Therefore, create a new CSS class in `Styles.css` named `SelectedRowStyle`.</span></span>


[!code-css[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample3.css)]

<span data-ttu-id="7a6ac-163">要套用這個 CSS 類別，以便`SelectedRowStyle`屬性*所有*Gridview，在我們的教學課程系列中，編輯`GridView.skin`面板中`DataWebControls`佈景主題，以包含`SelectedRowStyle`設定，如下所示：</span><span class="sxs-lookup"><span data-stu-id="7a6ac-163">To apply this CSS class to the `SelectedRowStyle` property of *all* GridViews in our tutorial series, edit the `GridView.skin` Skin in the `DataWebControls` Theme to include the `SelectedRowStyle` settings as shown below:</span></span>


[!code-aspx[Main](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/samples/sample4.aspx)]

<span data-ttu-id="7a6ac-164">此步驟中，選取的 GridView 資料列現在反白黃色背景色彩。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-164">With this addition, the selected GridView row is now highlighted with a yellow background color.</span></span>


<span data-ttu-id="7a6ac-165">[![自訂使用 GridView 的 SelectedRowStyle 屬性選取的資料列的外觀](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image23.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-165">[![Customize the Selected Row's Appearance Using the GridView's SelectedRowStyle Property](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image23.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image22.png)</span></span>

<span data-ttu-id="7a6ac-166">**圖 8**： 選取資料列的外觀使用自訂的 GridView`SelectedRowStyle`屬性 ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-166">**Figure 8**: Customize the Selected Row's Appearance Using the GridView's `SelectedRowStyle` Property ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image24.png))</span></span>


## <a name="step-2-displaying-the-selected-products-details-in-a-detailsview"></a><span data-ttu-id="7a6ac-167">步驟 2： 在 DetailsView 中顯示選取之的產品的詳細資料</span><span class="sxs-lookup"><span data-stu-id="7a6ac-167">Step 2: Displaying the Selected Product's Details in a DetailsView</span></span>

<span data-ttu-id="7a6ac-168">使用`ProductsGrid`完成 GridView，所有剩下就是新增顯示所選擇的特定產品的相關資訊的 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-168">With the `ProductsGrid` GridView complete, all that remains is to add a DetailsView that displays information about the particular product selected.</span></span> <span data-ttu-id="7a6ac-169">將上述 GridView DetailsView 控制項，並建立名為新 ObjectDataSource `ProductDetailsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-169">Add a DetailsView control above the GridView and create a new ObjectDataSource named `ProductDetailsDataSource`.</span></span> <span data-ttu-id="7a6ac-170">因為我們希望此 DetailsView 來顯示有關所選產品的特定資訊，請設定`ProductDetailsDataSource`若要使用`ProductsBLL`類別的`GetProductByProductID(productID)`方法。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-170">Since we want this DetailsView to display particular information about the selected product, configure the `ProductDetailsDataSource` to use the `ProductsBLL` class's `GetProductByProductID(productID)` method.</span></span>


<span data-ttu-id="7a6ac-171">[![叫用 ProductsBLL 類別的 GetProductByProductID(productID) 方法](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image26.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-171">[![Invoke the ProductsBLL Class's GetProductByProductID(productID) Method](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image26.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image25.png)</span></span>

<span data-ttu-id="7a6ac-172">**圖 9**： 叫用`ProductsBLL`類別的`GetProductByProductID(productID)`方法 ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-172">**Figure 9**: Invoke the `ProductsBLL` Class's `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image27.png))</span></span>


<span data-ttu-id="7a6ac-173">已*`productID`* 參數的值取自 GridView 控制項`SelectedValue`屬性。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-173">Have the *`productID`* parameter's value obtained from the GridView control's `SelectedValue` property.</span></span> <span data-ttu-id="7a6ac-174">我們稍早所述，GridView 的`SelectedValue`屬性會傳回第一個資料機碼的所選資料列的值。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-174">As we discussed earlier, the GridView's `SelectedValue` property returns the first data key value for the selected row.</span></span> <span data-ttu-id="7a6ac-175">因此，務必，GridView`DataKeyNames`屬性設定為`ProductID`，以便選取的資料列`ProductID`所傳回值`SelectedValue`。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-175">Therefore, it's imperative that the GridView's `DataKeyNames` property is set to `ProductID`, so that the selected row's `ProductID` value is returned by `SelectedValue`.</span></span>


<span data-ttu-id="7a6ac-176">[![將 [productID 參數] 設定 GridView 的 SelectedValue 屬性](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image29.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-176">[![Set the productID Parameter to the GridView's SelectedValue Property](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image29.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image28.png)</span></span>

<span data-ttu-id="7a6ac-177">**圖 10**： 設定*`productID`* GridView 的參數`SelectedValue`屬性 ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-177">**Figure 10**: Set the *`productID`* Parameter to the GridView's `SelectedValue` Property ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image30.png))</span></span>


<span data-ttu-id="7a6ac-178">一次`productDetailsDataSource`ObjectDataSource 已正確設定和繫結至 DetailsView，本教學課程已完成 ！</span><span class="sxs-lookup"><span data-stu-id="7a6ac-178">Once the `productDetailsDataSource` ObjectDataSource has been configured correctly and bound to the DetailsView, this tutorial is complete!</span></span> <span data-ttu-id="7a6ac-179">當第一次瀏覽的頁面已選取任何資料列，因此 GridView 的`SelectedValue`屬性會傳回`Nothing`。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-179">When the page is first visited no row is selected, so the GridView's `SelectedValue` property returns `Nothing`.</span></span> <span data-ttu-id="7a6ac-180">因為沒有與產品`NULL``ProductID`的值，由，會傳回任何記錄`GetProductByProductID(productID)`方法，這表示未顯示 DetailsView （請參閱 圖 11）。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-180">Since there are no products with a `NULL` `ProductID` value, no records are returned by the `GetProductByProductID(productID)` method, meaning that the DetailsView isn't displayed (see Figure 11).</span></span> <span data-ttu-id="7a6ac-181">按下 GridView 資料列的 [選取] 按鈕時回傳是兩邊彼此乾瞪眼並 DetailsView 重新整理為止。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-181">Upon clicking a GridView row's Select button, a postback ensues and the DetailsView is refreshed.</span></span> <span data-ttu-id="7a6ac-182">這次的 GridView`SelectedValue`屬性會傳回`ProductID`所選取的資料列，`GetProductByProductID(productID)`方法會傳回`ProductsDataTable`該特定的產品和 DetailsView 的相關資訊會顯示這些詳細資料 （請參閱 圖 12）。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-182">This time the GridView's `SelectedValue` property returns the `ProductID` of the selected row, the `GetProductByProductID(productID)` method returns a `ProductsDataTable` with information about that particular product, and the DetailsView shows these details (see Figure 12).</span></span>


<span data-ttu-id="7a6ac-183">[![當第一次瀏覽的只有 GridView 顯示](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image32.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-183">[![When First Visited, Only the GridView is Displayed](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image32.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image31.png)</span></span>

<span data-ttu-id="7a6ac-184">**圖 11**： 當第一次瀏覽，只 GridView 會顯示 ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-184">**Figure 11**: When First Visited, Only the GridView is Displayed ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image33.png))</span></span>


<span data-ttu-id="7a6ac-185">[![在選取的資料列，會顯示產品的詳細資料](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image35.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-185">[![Upon Selecting a Row, the Product's Details are Displayed](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image35.png)](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image34.png)</span></span>

<span data-ttu-id="7a6ac-186">**圖 12**： 在選取的資料列，會顯示產品的詳細資料 ([按一下以檢視完整大小的影像](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="7a6ac-186">**Figure 12**: Upon Selecting a Row, the Product's Details are Displayed ([Click to view full-size image](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb/_static/image36.png))</span></span>


## <a name="summary"></a><span data-ttu-id="7a6ac-187">總結</span><span class="sxs-lookup"><span data-stu-id="7a6ac-187">Summary</span></span>

<span data-ttu-id="7a6ac-188">這和上述的三個教學課程中，我們已了解一些技巧可以顯示主版/詳細報告。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-188">In this and the preceding three tutorials we've seen a number of techniques for displaying master/detail reports.</span></span> <span data-ttu-id="7a6ac-189">在本教學課程中，我們檢查使用可選取的 GridView 存放主要記錄和 DetailsView 相同的頁面上顯示所選的主要記錄的相關詳細資料。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-189">In this tutorial we examined using a selectable GridView to house the master records and a DetailsView to display details about the selected master record on the same page.</span></span> <span data-ttu-id="7a6ac-190">在先前的教學課程中，我們討論過如何顯示主版/詳細資料報表使用 dropdownlist 進行與上一個網頁及詳細的記錄，另一個顯示主要的記錄。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-190">In the earlier tutorials we looked at how to display master/details reports using DropDownLists and displaying master records on one web page and detail records on another.</span></span>

<span data-ttu-id="7a6ac-191">本教學課程結束時，我們檢查主版/詳細報告。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-191">This tutorial concludes our examination of master/detail reports.</span></span> <span data-ttu-id="7a6ac-192">我們將開始下一個教學課程來開始探索的自訂格式設定與 GridView、 DetailsView 和 FormView。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-192">Starting with the next tutorial we'll begin our exploration of customized formatting with the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="7a6ac-193">我們會看到如何自訂這些繫結到這些資料為基礎的控制項的外觀、 如何在 GridView 的頁尾中的資料摘述和如何使用範本，以取得更高的版面配置上的控制項。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-193">We'll see how to customize the appearance of these controls based on the data bound to them, how to summarize data in the GridView's footer, and how to use templates to obtain a greater degree of control over the layout.</span></span>

<span data-ttu-id="7a6ac-194">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="7a6ac-194">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="7a6ac-195">關於作者</span><span class="sxs-lookup"><span data-stu-id="7a6ac-195">About the Author</span></span>

<span data-ttu-id="7a6ac-196">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-196">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7a6ac-197">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-197">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7a6ac-198">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-198">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7a6ac-199">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-199">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7a6ac-200">或透過他的部落格，這位於[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-200">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="7a6ac-201">特別感謝</span><span class="sxs-lookup"><span data-stu-id="7a6ac-201">Special Thanks To</span></span>

<span data-ttu-id="7a6ac-202">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-202">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="7a6ac-203">本教學課程中的潛在客戶檢閱者已 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="7a6ac-203">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="7a6ac-204">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="7a6ac-204">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="7a6ac-205">如果是這樣，psychic 在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7a6ac-205">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="7a6ac-206">上一步</span><span class="sxs-lookup"><span data-stu-id="7a6ac-206">Previous</span></span>](master-detail-filtering-across-two-pages-vb.md)
