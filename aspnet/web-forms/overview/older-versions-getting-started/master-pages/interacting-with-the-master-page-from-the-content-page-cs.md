---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-cs
title: "使用主版頁面，從 [內容] 頁面 (C#) 互動 |Microsoft 文件"
author: rick-anderson
description: "會檢查呼叫方法、 從內容頁面中的程式碼中設定屬性的主版頁面等等的方式。"
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/11/2008
ms.topic: article
ms.assetid: 32d54638-71b2-491d-81f4-f7417a13a62f
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-cs
msc.type: authoredcontent
ms.openlocfilehash: 054c67ec7d7eec38d46933417930161a0edd5a60
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/10/2017
---
<a name="interacting-with-the-master-page-from-the-content-page-c"></a><span data-ttu-id="bd2ee-103">互動主版頁面，從 [內容] 頁面 (C#)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-103">Interacting with the Master Page from the Content Page (C#)</span></span>
====================
<span data-ttu-id="bd2ee-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="bd2ee-105">[下載程式碼](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_CS.zip)或[下載 PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_CS.pdf)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-105">[Download Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_CS.zip) or [Download PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_CS.pdf)</span></span>

> <span data-ttu-id="bd2ee-106">會檢查呼叫方法、 從內容頁面中的程式碼中設定屬性的主版頁面等等的方式。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>


## <a name="introduction"></a><span data-ttu-id="bd2ee-107">簡介</span><span class="sxs-lookup"><span data-stu-id="bd2ee-107">Introduction</span></span>

<span data-ttu-id="bd2ee-108">在我們已經探討如何建立主版頁面的過去五個教學課程的過程中，定義內容區域、 將 ASP.NET 網頁繫結至主版頁面中，以及定義頁面的特定內容。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="bd2ee-109">當訪客要求特定的內容頁面上時，也會在執行階段，導致統一的控制項階層架構的轉譯 fused 內容和主版頁面的標記。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="bd2ee-110">因此，我們已經看過另一種方式在主版頁面和其內容頁的其中一個可以互動: [內容] 頁面會列出要 transfuse 主版頁面的 ContentPlaceHolder 控制項的標記。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="bd2ee-111">我們配置了尚未檢查是主版頁面和內容頁面可以互動方式以程式設計的方式。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="bd2ee-112">除了定義的主版頁面 ContentPlaceHolder 控制項的標記，內容頁面也可以將值指派給其主版頁面的公用屬性，並叫用其公用方法。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="bd2ee-113">同樣地，可能會與其內容的頁面互動主版頁面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="bd2ee-114">較不常見，其宣告式標記之間的互動比主要和內容頁面之間的程式設計互動時，有許多情況都需要這類的程式設計互動的位置。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="bd2ee-115">在本教學課程中我們檢驗如何以程式設計方式進行內容的頁面互動其主版頁面;在下一個教學課程中，我們將探討如何主版頁面可以同樣地互動其內容頁。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="bd2ee-116">內容頁面和其主版頁面之間的程式設計互動的範例</span><span class="sxs-lookup"><span data-stu-id="bd2ee-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="bd2ee-117">當頁面的特定區域，就必須設定頁面的頁面為基礎時，我們會使用 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="bd2ee-118">但大部分的網頁要發出特定的輸出，但量少的頁面的情況下需要自訂它以顯示其他項目呢？</span><span class="sxs-lookup"><span data-stu-id="bd2ee-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="bd2ee-119">其中一個這類範例，其中我們探討[*多個 ContentPlaceHolders 和預設內容*](multiple-contentplaceholders-and-default-content-cs.md)教學課程中，包含每個頁面上顯示登入介面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-cs.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="bd2ee-120">雖然大部分頁面都應該包括登入介面，它應該隱藏少數幾個頁面，例如： 主登入頁面 (`Login.aspx`); 建立帳戶 頁面中; 與其他頁面，才可存取已驗證的使用者。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="bd2ee-121">[*多個 ContentPlaceHolders 和預設內容*](multiple-contentplaceholders-and-default-content-cs.md)教學課程說明如何針對 ContentPlaceHolder 主版頁面中定義的預設內容，然後如何覆寫它，這些頁面的位置預設的內容已不需要。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-cs.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="bd2ee-122">另一個選項是建立的公用屬性或方法中的主版頁面，指出是否要顯示或隱藏登入介面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="bd2ee-123">例如，主版頁面可能會包含名為的公用屬性`ShowLoginUI`其值用來設定`Visible`主版頁面中的登入控制項的屬性。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="bd2ee-124">然後無法以程式設計方式設定這些內容的頁面，其中應該隱藏登入使用者介面`ShowLoginUI`屬性`false`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `false`.</span></span>

<span data-ttu-id="bd2ee-125">可能是主版頁面需要重新整理後一些動作發生的內容頁面中顯示的資料時，就會發生最常見的內容和主版頁面互動的範例。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="bd2ee-126">請考慮包含的 GridView 會顯示五個最新的主版頁面從特定的資料庫資料表時，加入記錄和其內容頁的其中一種包含將新記錄新增至相同資料表的介面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="bd2ee-127">當使用者造訪的頁面，即可加入新的記錄時，她看到五個最新加入的主版頁面中顯示的記錄。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="bd2ee-128">之後填入新資料錄的資料行的值，她送出表單。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="bd2ee-129">假設 GridView 主版頁面中的具有其`EnableViewState`屬性設定為 true （預設值），其內容會重新載入從檢視狀態，即使較新的記錄剛新增到資料庫，因此，顯示五個相同的記錄。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-129">Assuming that the GridView in the master page has its `EnableViewState` property set to true (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="bd2ee-130">這可能會混淆使用者。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="bd2ee-131">即使您停用 GridView 的檢視狀態，讓它重新繫結至其在每次回傳的基礎資料來源時，它仍不會顯示只是加入資料錄因為資料繫結至 GridView 稍網頁生命週期，比 datab 當加入新的記錄ase。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>


<span data-ttu-id="bd2ee-132">若要補救這種情況，使剛加入的記錄會顯示在主版頁面的回傳我們需要以指示其資料來源重新繫結至 GridView GridView*之後*資料庫已加入新的記錄。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="bd2ee-133">這需要的內容和主版頁面之間的互動，因為加入新的記錄 （和其事件處理常式） 會在 [內容] 頁面，但是需要重新整理的 GridView 的介面是主版頁面中。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="bd2ee-134">因為重新整理從內容頁面中的事件處理常式的主版頁面的顯示是其中一個最常見的需求，對內容和主版頁面互動，讓我們來探索更多詳細資料中的這個主題。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="bd2ee-135">在此教學課程下載包含名為 Microsoft SQL Server 2005 Express 的 Edition 資料庫`NORTHWIND.MDF`之網站中`App_Data`資料夾。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="bd2ee-136">Northwind 資料庫儲存產品、 員工和虛構的公司，Northwind Traders 的銷售資訊。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="bd2ee-137">步驟 1 會逐步解說顯示五個最新加入的 GridView 主版頁面中的產品。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="bd2ee-138">步驟 2 建立的內容頁面加入新的產品。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="bd2ee-139">會查看如何在主版頁面中，建立公用屬性及方法的步驟 3 和步驟 4 說明如何以程式設計方式使用這些屬性和方法，從 [內容] 頁面的介面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="bd2ee-140">本教學課程不會深入在 ASP.NET 中使用資料的細節。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="bd2ee-141">設定主版頁面，來顯示資料和插入資料的內容頁面的步驟都完成，尚未 breezy。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="bd2ee-142">顯示和插入資料並使用 SqlDataSource 和 GridView 控制項更深入探討，請參閱本教學課程結尾處的進一步讀取區段中的資源。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>


## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="bd2ee-143">步驟 1： 顯示五個最近新增主版頁面中的產品</span><span class="sxs-lookup"><span data-stu-id="bd2ee-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="bd2ee-144">開啟`Site.master`主版頁面，並加入標籤和 GridView 控制項`leftContent` `<div>`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-144">Open the `Site.master` master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="bd2ee-145">清除標籤的`Text`屬性，將其`EnableViewState`屬性設定為 false，且其`ID`屬性`GridMessage`; 設定 GridView 的`ID`屬性`RecentProducts`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-145">Clear out the Label's `Text` property, set its `EnableViewState` property to false, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="bd2ee-146">接下來，從設計工具中，展開 GridView 的智慧標籤，然後選擇繫結至新的資料來源。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="bd2ee-147">這會啟動 資料來源組態精靈。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="bd2ee-148">因為 Northwind 資料庫中`App_Data`資料夾是 Microsoft SQL Server 資料庫中，選擇所選取 （請參閱圖 1） 建立 SqlDataSource; SqlDataSource `RecentProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>


<span data-ttu-id="bd2ee-149">[![將 GridView 繫結至名為 RecentProductsDataSource SqlDataSource 控制項](interacting-with-the-master-page-from-the-content-page-cs/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-cs/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image1.png)</span></span>

<span data-ttu-id="bd2ee-150">**圖 01**: SqlDataSource 控制項名為繫結的 GridView `RecentProductsDataSource` ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="bd2ee-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-cs/_static/image3.png))</span></span>


<span data-ttu-id="bd2ee-151">下一個步驟會詢問我們指定連接到目標資料庫。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="bd2ee-152">選擇`NORTHWIND.MDF`資料庫檔案，從下拉式清單中，按一下 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="bd2ee-153">因為這是我們會使用此資料庫的第一次，精靈會提供連接字串中的儲存`Web.config`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="bd2ee-154">已使用名稱的連接字串儲存它`NorthwindConnectionString`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>


<span data-ttu-id="bd2ee-155">[![連接至 Northwind 資料庫](interacting-with-the-master-page-from-the-content-page-cs/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-cs/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image4.png)</span></span>

<span data-ttu-id="bd2ee-156">**圖 02**： 連接至 Northwind 資料庫 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="bd2ee-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-cs/_static/image6.png))</span></span>


<span data-ttu-id="bd2ee-157">設定資料來源精靈會提供兩個方法，我們可以指定用來擷取資料的查詢：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="bd2ee-158">藉由指定自訂 SQL 陳述式或預存程序，或</span><span class="sxs-lookup"><span data-stu-id="bd2ee-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="bd2ee-159">選取資料表或檢視表，，然後指定要傳回的資料行</span><span class="sxs-lookup"><span data-stu-id="bd2ee-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="bd2ee-160">由於我們想要傳回只五個最新加入的產品，我們需要指定自訂的 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="bd2ee-161">使用下列的 SELECT 查詢：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-161">Use the following SELECT query:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-cs/samples/sample1.sql)]

<span data-ttu-id="bd2ee-162">`TOP 5`關鍵字的查詢傳回前五筆記錄。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="bd2ee-163">`Products`資料表的主索引鍵， `ProductID`，是`IDENTITY`資料行，以確保我們新產品加入至資料表會有比先前的項目較大的值。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="bd2ee-164">因此，排序結果，您可以`ProductID`以遞減順序傳回開頭為最新建立的產品。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>


<span data-ttu-id="bd2ee-165">[![傳回最近加入的五項產品](interacting-with-the-master-page-from-the-content-page-cs/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-cs/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image7.png)</span></span>

<span data-ttu-id="bd2ee-166">**圖 03**： 傳回五個最最近加入產品 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="bd2ee-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-cs/_static/image9.png))</span></span>


<span data-ttu-id="bd2ee-167">完成精靈之後，Visual Studio 會產生兩個顯示 gridview BoundFields`ProductName`和`UnitPrice`從資料庫傳回的欄位。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="bd2ee-168">此時主版頁面的宣告式標記應包含標記如下所示：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>


[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-cs/samples/sample2.aspx)]

<span data-ttu-id="bd2ee-169">如您所見，標記包含： 標籤 Web 控制項 (`GridMessage`); GridView `RecentProducts`，兩個 BoundFields; 它會傳回 5 個最近新增產品的 SqlDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="bd2ee-170">與這個 GridView 建立和設定，其 SqlDataSource 控制項，請造訪的網站透過瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="bd2ee-171">如圖 4 所示，您會看到的方格中列出，這 5 個最近的左下角新增產品。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>


<span data-ttu-id="bd2ee-172">[![在 GridView 會顯示最近加入的五項產品](interacting-with-the-master-page-from-the-content-page-cs/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-cs/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image10.png)</span></span>

<span data-ttu-id="bd2ee-173">**圖 04**: GridView 會顯示五個最最近加入產品 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="bd2ee-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-cs/_static/image12.png))</span></span>


> [!NOTE]
> <span data-ttu-id="bd2ee-174">請隨意清除 GridView 的外觀。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="bd2ee-175">某些建議包括格式顯示`UnitPrice`值做為貨幣，並使用背景色彩和字型，以改善格線的外觀。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>


## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="bd2ee-176">步驟 2： 建立內容的頁面，即可將新的產品</span><span class="sxs-lookup"><span data-stu-id="bd2ee-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="bd2ee-177">下一步是建立內容頁面，使用者可以從此處新增至新的產品`Products`資料表。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="bd2ee-178">加入新的內容頁面以`Admin`資料夾名為`AddProduct.aspx`，務必將它繫結讓`Site.master`主版頁面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="bd2ee-179">此頁面已加入至網站之後，圖 5 顯示 [方案總管]。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>


<span data-ttu-id="bd2ee-180">[![將新的 ASP.NET 網頁新增至 [Admin] 資料夾](interacting-with-the-master-page-from-the-content-page-cs/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-cs/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image13.png)</span></span>

<span data-ttu-id="bd2ee-181">**圖 05**： 加入新的 ASP.NET 網頁的`Admin`資料夾 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="bd2ee-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-cs/_static/image15.png))</span></span>


<span data-ttu-id="bd2ee-182">請記得，在[*主版頁面中指定的標題、 Meta 標記和其他 HTML 標頭*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md)教學課程中我們建立名為基礎的自訂頁面類別`BasePage`它產生頁面的標題未明確設定。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="bd2ee-183">移至`AddProduct.aspx`網頁的程式碼後置類別，並讓它衍生自`BasePage`(而不是從`System.Web.UI.Page`)。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="bd2ee-184">最後，更新`Web.sitemap`檔案至這一課中加入一個項目。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="bd2ee-185">加入下列標記下方`<siteMapNode>`控制識別碼命名的問題一課：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>


[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-cs/samples/sample3.xml)]

<span data-ttu-id="bd2ee-186">這個加法圖 6 所示`<siteMapNode>`項目會反映在課程清單中。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="bd2ee-187">返回`AddProduct.aspx`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="bd2ee-188">在內容控制項中`MainContent`ContentPlaceHolder，加入 DetailsView 控制項並將其命名`NewProduct`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="bd2ee-189">繫結至新的 SqlDataSource 控制項，名為的 DetailsView `NewProductDataSource`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="bd2ee-190">要使用在步驟 1 中 SqlDataSource，設定精靈以便讓它使用 Northwind 資料庫，然後選擇指定自訂的 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="bd2ee-191">在 DetailsView 將用來將項目加入至資料庫，因為我們需要同時指定`SELECT`陳述式和`INSERT`陳述式。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="bd2ee-192">使用下列`SELECT`查詢：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-192">Use the following `SELECT` query:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-cs/samples/sample4.sql)]

<span data-ttu-id="bd2ee-193">然後，從 [插入] 索引標籤中，加入下列`INSERT`陳述式：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-cs/samples/sample5.sql)]

<span data-ttu-id="bd2ee-194">完成精靈之後前往 DetailsView 的智慧標籤，選取 「 啟用插入 」 的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="bd2ee-195">這會將 CommandField DetailsView 加入其`ShowInsertButton`屬性設為 true。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to true.</span></span> <span data-ttu-id="bd2ee-196">因為此 DetailsView 會用來插入資料，設定在 DetailsView 的`DefaultMode`屬性`Insert`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="bd2ee-197">這就是這麼簡單 ！</span><span class="sxs-lookup"><span data-stu-id="bd2ee-197">That's all there is to it!</span></span> <span data-ttu-id="bd2ee-198">我們來測試此頁面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-198">Let's test this page.</span></span> <span data-ttu-id="bd2ee-199">請瀏覽`AddProduct.aspx`透過瀏覽器中，輸入名稱和價格 （請參閱圖 6）。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>


<span data-ttu-id="bd2ee-200">[![將新的產品加入資料庫](interacting-with-the-master-page-from-the-content-page-cs/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-cs/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image16.png)</span></span>

<span data-ttu-id="bd2ee-201">**圖 06**： 將新的產品加入資料庫 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="bd2ee-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-cs/_static/image18.png))</span></span>


<span data-ttu-id="bd2ee-202">在輸入中的名稱和新的產品的價格後, 按一下 [插入] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="bd2ee-203">這會導致回傳表單。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-203">This causes the form to postback.</span></span> <span data-ttu-id="bd2ee-204">在回傳時，SqlDataSource 控制項的`INSERT`執行陳述式; 它的兩個參數會填入使用者輸入控制項中的值在 DetailsView 的兩個文字方塊。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="bd2ee-205">很遺憾，目前沒有視覺回應可插入已發生。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="bd2ee-206">是最好的訊息，確認已加入新的記錄。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="bd2ee-207">我將保留此為一項工作讀取器。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="bd2ee-208">此外之後從 DetailsView 加入新的記錄, 中的主版頁面 GridView 仍會顯示五個記錄與相同。它不包含剛加入的記錄。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="bd2ee-209">我們將檢驗如何補救這種情況中的後續步驟。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="bd2ee-210">除了新增某種形式的視覺化回應，已成功插入，我會建議您也會更新以包含驗證的 DetailsView 的插入介面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="bd2ee-211">目前沒有任何驗證。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-211">Currently, there is no validation.</span></span> <span data-ttu-id="bd2ee-212">如果使用者輸入的值無效`UnitPrice`欄位，例如 「 太昂貴，"將會擲回例外狀況在回傳時系統會嘗試將該字串轉換成十進位。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="bd2ee-213">如需有關自訂插入介面，請參閱[*自訂的資料修改介面*教學課程](../../data-access/editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md)從我[使用教學課程系列資料](../../data-access/index.md).</span><span class="sxs-lookup"><span data-stu-id="bd2ee-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](../../data-access/editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>


## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="bd2ee-214">步驟 3： 建立主版頁面中的公用屬性和方法</span><span class="sxs-lookup"><span data-stu-id="bd2ee-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="bd2ee-215">在步驟 1 中，我們新增標籤 Web 控制項，名為`GridMessage`GridView 主版頁面上方。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="bd2ee-216">此標籤會選擇性地顯示一則訊息。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="bd2ee-217">比方說之後加入新的記錄，到,`Products`資料表中，我們可能會想要顯示讀取的訊息:"*ProductName*已加入至資料庫。 」</span><span class="sxs-lookup"><span data-stu-id="bd2ee-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="bd2ee-218">而不是硬式編碼為主版頁面中的標籤文字，我們可能會想要依內容頁可自訂訊息。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="bd2ee-219">Label 控制項會實作為主版頁面內的受保護的成員變數，因為它無法直接從內容頁面存取。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="bd2ee-220">若要使用主版頁面，從 [內容] 頁面 （或，而且任何主版頁面中的 Web 控制項） 中的標籤我們要公開 Web 控制項，或做為 proxy 的其中一個屬性可以是主版頁面中建立的公用屬性 存取。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="bd2ee-221">主版頁面的程式碼後置類別公開的標籤加入下列語法`Text`屬性：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>


[!code-csharp[Main](interacting-with-the-master-page-from-the-content-page-cs/samples/sample6.cs)]

<span data-ttu-id="bd2ee-222">若要加入新的記錄時`Products`內容頁面的表格`RecentProducts`GridView 主版頁面中的，需要重新繫結至其基礎資料來源。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="bd2ee-223">若要重新繫結的 GridView 呼叫其`DataBind`方法。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="bd2ee-224">GridView 主版頁面中的不是透過程式設計方式存取內容頁面，因為我們建立的公用方法主版頁面中，呼叫時，需要重新繫結至 GridView 的資料。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="bd2ee-225">將下列方法加入至主版頁面的程式碼後置類別：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-225">Add the following method to the master page's code-behind class:</span></span>


[!code-csharp[Main](interacting-with-the-master-page-from-the-content-page-cs/samples/sample7.cs)]

<span data-ttu-id="bd2ee-226">與`GridMessageText`屬性和`RefreshRecentProductsGrid`方法就地任何內容的頁面可以透過程式設計方式設定或讀取的值`GridMessage`標籤的`Text`屬性或重新繫結至資料`RecentProducts`GridView。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="bd2ee-227">步驟 4 會檢查如何從內容頁面存取主版頁面的公用屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="bd2ee-228">別忘了標記主版頁面的屬性和方法`public`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-228">Don't forget to mark the master page's properties and methods as `public`.</span></span> <span data-ttu-id="bd2ee-229">如果您不明確代表這些屬性和方法做為`public`，它們將無法再從 [內容] 頁面存取。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-229">If you do not explicitly denote these properties and methods as `public`, they will not be accessible from the content page.</span></span>


## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="bd2ee-230">步驟 4： 從內容頁面呼叫主版頁面的公用成員</span><span class="sxs-lookup"><span data-stu-id="bd2ee-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="bd2ee-231">現在，主版頁面都有必要的公用屬性和方法，我們要叫用這些屬性和方法，從準備`AddProduct.aspx`內容頁面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="bd2ee-232">具體來說，我們需要設定主版頁面的`GridMessageText`屬性並呼叫其`RefreshRecentProductsGrid`方法之後，新的產品加入資料庫。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="bd2ee-233">所有 ASP.NET 資料 Web 控制項都引發事件之前和之後完成各種工作，簡化網頁開發人員来採取某些程式設計動作之前或之後的工作。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="bd2ee-234">例如，當使用者按一下 DetailsView 的 [插入] 按鈕，在回傳 DetailsView 引發其`ItemInserting`開始插入的工作流程之前的事件。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="bd2ee-235">然後，它會將記錄插入資料庫。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-235">It then inserts the record into the database.</span></span> <span data-ttu-id="bd2ee-236">接下來，在 DetailsView 引發其`ItemInserted`事件。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="bd2ee-237">因此，為了加入新的產品後，請使用主版頁面，建立事件處理常式的 DetailsView 的`ItemInserted`事件。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="bd2ee-238">有兩個內容頁面以程式設計的方式可在其主版頁面互動的方式：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="bd2ee-239">使用`Page.Master`屬性，傳回主版頁面的鬆散型別參考，或</span><span class="sxs-lookup"><span data-stu-id="bd2ee-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="bd2ee-240">指定網頁的主版頁面類型或檔案路徑透過`@MasterType`指示詞; 這會自動將強型別屬性加入名為頁面`Master`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="bd2ee-241">讓我們來討論這兩種方法。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="bd2ee-242">使用鬆散型別`Page.Master`屬性</span><span class="sxs-lookup"><span data-stu-id="bd2ee-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="bd2ee-243">所有的 ASP.NET web pages 必須衍生自`Page`類別位於`System.Web.UI`命名空間。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="bd2ee-244">`Page`類別包含[`Master`屬性](https://msdn.microsoft.com/en-us/library/system.web.ui.page.master.aspx)傳回網頁的主版頁面的參考。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/en-us/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="bd2ee-245">如果頁面沒有主版頁面`Master`傳回`null`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-245">If the page does not have a master page `Master` returns `null`.</span></span>

<span data-ttu-id="bd2ee-246">`Master`屬性會傳回型別的物件[ `MasterPage` ](https://msdn.microsoft.com/en-us/library/system.web.ui.masterpage.aspx) (同樣位於`System.Web.UI`命名空間) 即從衍生自所有主版頁面的基底類型。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/en-us/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="bd2ee-247">因此，若要使用的公用屬性或方法定義在我們的網站的主版頁面我們必須轉換`MasterPage`從傳回的物件`Master`適當類型的屬性。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="bd2ee-248">因為我們名為我們的主版頁面檔案`Site.master`，程式碼後置類別命名為`Site`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="bd2ee-249">因此，下列程式碼轉換`Page.Master`網站類別的執行個體的屬性。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-249">Therefore, the following code casts the `Page.Master` property to an instance of the Site class.</span></span>


[!code-csharp[Main](interacting-with-the-master-page-from-the-content-page-cs/samples/sample8.cs)]

<span data-ttu-id="bd2ee-250">現在，我們已經轉換鬆散型別`Page.Master`屬性`Site`我們可以參考的屬性和站台的特定方法的型別。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-250">Now that we have casted the loosely-typed `Page.Master` property to the `Site` type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="bd2ee-251">如圖 7 所示的公用屬性`GridMessageText`出現在 IntelliSense 下拉式清單中。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>


<span data-ttu-id="bd2ee-252">[![IntelliSense 會顯示我們主版頁面的公用屬性和方法](interacting-with-the-master-page-from-the-content-page-cs/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-cs/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image19.png)</span></span>

<span data-ttu-id="bd2ee-253">**圖 07**: IntelliSense 會顯示我們主版頁面的公用屬性和方法 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="bd2ee-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-cs/_static/image21.png))</span></span>


> [!NOTE]
> <span data-ttu-id="bd2ee-254">如果您命名為您的主版頁面檔案`MasterPage.master`主版頁面的程式碼後置類別名稱是`MasterPage`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="bd2ee-255">這可能會導致模稜兩可的程式碼的型別轉型時`System.Web.UI.MasterPage`到您`MasterPage`類別。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="bd2ee-256">簡單地說，您需要完整限定的類型，您和轉換，可能會有點時使用的網站專案模型。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="bd2ee-257">我的建議，可請確定當您建立您的主版頁面您命名它的項目以外`MasterPage.master`或更好的是，建立強型別參考的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>


### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="bd2ee-258">建立具有的強型別參考`@MasterType`指示詞</span><span class="sxs-lookup"><span data-stu-id="bd2ee-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="bd2ee-259">如果您仔細查看您可以看到 ASP.NET 網頁的程式碼後置類別是部分類別 (請注意`partial`類別定義中的關鍵字)。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `partial` keyword in the class definition).</span></span> <span data-ttu-id="bd2ee-260">部分類別 C# 和 Visual Basic 以 Framework 2.0 中導入，以及簡單的說，允許跨多個檔案會定義類別的成員。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="bd2ee-261">程式碼後置類別檔中- `AddProduct.aspx.cs`，例如包含網頁開發人員，我們建立的程式碼。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-261">The code-behind class file - `AddProduct.aspx.cs`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="bd2ee-262">我們的程式碼中，除了 ASP.NET 引擎會自動建立個別的類別檔案屬性和事件處理常式中，會轉譯頁面的類別階層架構中的宣告式標記。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="bd2ee-263">每當瀏覽 ASP.NET 網頁時就會發生自動程式碼產生微不足道部分而不是相關且實用的可能性。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="bd2ee-264">在主版頁面中，如果我們告訴我們內容的頁面正在使用哪些主版頁面的 ASP.NET 引擎就會產生強型別`Master`為我們的屬性。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="bd2ee-265">使用[`@MasterType`指示詞](https://msdn.microsoft.com/en-us/library/ms228274.aspx)，告知 ASP.NET 引擎的內容頁面的主版頁面類型。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/en-us/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="bd2ee-266">`@MasterType`指示詞可接受主版頁面的型別名稱，或是其檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="bd2ee-267">若要指定`AddProduct.aspx`頁面使用`Site.master`做為其主版頁面的頂端加入下列指示詞`AddProduct.aspx`:</span><span class="sxs-lookup"><span data-stu-id="bd2ee-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>


[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-cs/samples/sample9.aspx)]

<span data-ttu-id="bd2ee-268">這個指示詞會指示 ASP.NET 引擎加入主版頁面透過名為屬性的強型別參考`Master`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="bd2ee-269">與`@MasterType`就地指示詞時，我們就可以呼叫`Site.master`主要頁面上的公用屬性及方法直接透過`Master`沒有任何轉換的屬性。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="bd2ee-270">如果您省略`@MasterType`指示詞，語法`Page.Master`和`Master`傳回相同的作業： 在頁面的主版頁面的鬆散型別物件。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="bd2ee-271">如果您包含`@MasterType`指示詞再`Master`傳回指定的主版頁面的強型別參考。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="bd2ee-272">`Page.Master`不過，仍會傳回鬆散型別的參考。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="bd2ee-273">以更徹底地查看原因是這種情況以及如何`Master`屬性的建構時`@MasterType`指示詞之後，請參閱[K.Scott Allen](http://odetocode.com/blogs/scott/default.aspx)的部落格項目[`@MasterType`在 ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span><span class="sxs-lookup"><span data-stu-id="bd2ee-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>


### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="bd2ee-274">加入新的產品之後更新主版頁面</span><span class="sxs-lookup"><span data-stu-id="bd2ee-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="bd2ee-275">既然我們已經知道如何叫用主版頁面的公用屬性和內容頁面的方法，我們準備好更新`AddProduct.aspx`頁面，如此在主版頁面重新整理之後加入新的產品。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="bd2ee-276">步驟 4 的開頭，我們建立 DetailsView 控制項的事件處理常式`ItemInserting`事件，新的產品加入資料庫之後，立即執行。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="bd2ee-277">將下列程式碼加入至該事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-277">Add the following code to that event handler:</span></span>


[!code-csharp[Main](interacting-with-the-master-page-from-the-content-page-cs/samples/sample10.cs)]

<span data-ttu-id="bd2ee-278">上述程式碼會使用這兩個鬆散型別`Page.Master`屬性和強型別`Master`屬性。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="bd2ee-279">請注意，`GridMessageText`屬性設定為"*ProductName*加入至資料格...」剛加入的產品值的存取透過`e.Values`集合; 您可以看到，只要加入`ProductName`透過存取值`e.Values["ProductName"]`。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values["ProductName"]`.</span></span>

<span data-ttu-id="bd2ee-280">圖 8 顯示`AddProduct.aspx`立即在新的產品-Scott Soda-之後的頁面已加入至資料庫。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="bd2ee-281">請注意剛加入的產品名稱述主版頁面的標籤和 GridView 已重新整理包含產品和其價格。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>


<span data-ttu-id="bd2ee-282">[![主版頁面的標籤和 GridView 會顯示剛加入的產品](interacting-with-the-master-page-from-the-content-page-cs/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-cs/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-cs/_static/image22.png)</span></span>

<span data-ttu-id="bd2ee-283">**圖 08**: 主版頁面的標籤和 GridView 會顯示 Just-Added 產品 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="bd2ee-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-cs/_static/image24.png))</span></span>


## <a name="summary"></a><span data-ttu-id="bd2ee-284">總結</span><span class="sxs-lookup"><span data-stu-id="bd2ee-284">Summary</span></span>

<span data-ttu-id="bd2ee-285">在理想情況下，主版頁面和其內容的頁面是完全獨立的另一個，而且需要互動的任何層級。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="bd2ee-286">雖然主版頁面和內容頁面設計時應該記住該目標，但是會有其主版頁面內容的頁面必須介面中的常見案例的數目。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="bd2ee-287">其中一個最常見的原因而中心更新該批內容頁面中的某些動作為基礎的主版頁面顯示的特定部分。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="bd2ee-288">好消息是相當簡單，有一個以程式設計方式互動其主版頁面的內容頁面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="bd2ee-289">開始建立封裝的功能，需要叫用的內容頁的主版頁面中的公用屬性或方法。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="bd2ee-290">然後，在 [內容] 頁面，存取主版頁面的屬性和方法透過鬆散型別`Page.Master`屬性或使用`@MasterType`指示詞，以建立強型別參考主版頁面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="bd2ee-291">在下一個教學課程中，我們檢驗如何以程式設計方式互動的其中一個其內容頁的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="bd2ee-292">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="bd2ee-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="bd2ee-293">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="bd2ee-293">Further Reading</span></span>

<span data-ttu-id="bd2ee-294">如需有關在本教學課程所討論的主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="bd2ee-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="bd2ee-295">存取及更新在 ASP.NET 中的資料</span><span class="sxs-lookup"><span data-stu-id="bd2ee-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="bd2ee-296">ASP.NET 主版頁面： 秘訣、 竅門與設陷</span><span class="sxs-lookup"><span data-stu-id="bd2ee-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="bd2ee-297">`@MasterType`在 ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="bd2ee-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="bd2ee-298">主版頁面內容之間傳遞資訊</span><span class="sxs-lookup"><span data-stu-id="bd2ee-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="bd2ee-299">在 ASP.NET 教學課程中使用的資料</span><span class="sxs-lookup"><span data-stu-id="bd2ee-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="bd2ee-300">關於作者</span><span class="sxs-lookup"><span data-stu-id="bd2ee-300">About the Author</span></span>

<span data-ttu-id="bd2ee-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的多個 ASP/ASP.NET 書籍和 4GuysFromRolla.com 的創辦，目前正在使用 Microsoft Web 技術從 1998 年。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="bd2ee-302">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="bd2ee-303">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 3.5 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="bd2ee-304">在可到達 Scott [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com)或透過在他的部落格[http://ScottOnWriting.NET](http://scottonwriting.net/)。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="bd2ee-305">特別感謝</span><span class="sxs-lookup"><span data-stu-id="bd2ee-305">Special Thanks To</span></span>

<span data-ttu-id="bd2ee-306">許多有用的檢閱者已檢閱本教學課程系列。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="bd2ee-307">在此教學課程的前導檢閱者已 Zack Jones。</span><span class="sxs-lookup"><span data-stu-id="bd2ee-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="bd2ee-308">檢閱我即將推出的 MSDN 文件有興趣嗎？</span><span class="sxs-lookup"><span data-stu-id="bd2ee-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="bd2ee-309">如果是這樣，卸除我一行[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="bd2ee-310">[上一頁](control-id-naming-in-content-pages-cs.md)
[下一頁](interacting-with-the-content-page-from-the-master-page-cs.md)</span><span class="sxs-lookup"><span data-stu-id="bd2ee-310">[Previous](control-id-naming-in-content-pages-cs.md)
[Next](interacting-with-the-content-page-from-the-master-page-cs.md)</span></span>
