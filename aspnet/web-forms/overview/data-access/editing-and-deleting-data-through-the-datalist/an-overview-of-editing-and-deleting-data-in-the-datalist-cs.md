---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-cs
title: 編輯和刪除 DataList (C#) 中的資料的概觀 |Microsoft Docs
author: rick-anderson
description: 雖然 DataList 缺少內建的編輯和刪除功能，在本教學課程中我們將看到如何建立支援編輯和刪除 o DataList...
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: c3b0c86e-fe98-41ee-b26f-ca38cddaa75e
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-cs
msc.type: authoredcontent
ms.openlocfilehash: 7f1e8e542a72653879cd0ca6a6b4afeb481fda59
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/03/2018
ms.locfileid: "37379802"
---
<a name="an-overview-of-editing-and-deleting-data-in-the-datalist-c"></a><span data-ttu-id="f0536-103">編輯和刪除 DataList (C#) 中的資料的概觀</span><span class="sxs-lookup"><span data-stu-id="f0536-103">An Overview of Editing and Deleting Data in the DataList (C#)</span></span>
====================
<span data-ttu-id="f0536-104">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f0536-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f0536-105">[下載範例應用程式](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_36_CS.exe)或[下載 PDF](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/datatutorial36cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f0536-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_36_CS.exe) or [Download PDF](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/datatutorial36cs1.pdf)</span></span>

> <span data-ttu-id="f0536-106">雖然 DataList 缺少內建的編輯和刪除功能，在本教學課程中我們會看到如何建立支援編輯和刪除其基礎資料的 DataList。</span><span class="sxs-lookup"><span data-stu-id="f0536-106">While the DataList lacks built-in editing and deleting capabilities, in this tutorial we'll see how to create a DataList that supports editing and deleting of its underlying data.</span></span>


## <a name="introduction"></a><span data-ttu-id="f0536-107">簡介</span><span class="sxs-lookup"><span data-stu-id="f0536-107">Introduction</span></span>

<span data-ttu-id="f0536-108">在 [概觀的插入、 更新和刪除資料](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)教學課程中我們探討了如何插入、 更新和刪除資料使用的應用程式架構、 ObjectDataSource，和 GridView、 DetailsView 和 FormView控制項。</span><span class="sxs-lookup"><span data-stu-id="f0536-108">In the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial we looked at how to insert, update, and delete data using the application architecture, an ObjectDataSource, and the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="f0536-109">使用 ObjectDataSource 和下列三個資料 Web 控制項，實作簡單的資料修改介面是嵌入式管理單元，以及涉及只計時從智慧標籤的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="f0536-109">With the ObjectDataSource and these three data Web controls, implementing simple data modification interfaces was a snap and involved merely ticking a checkbox from a smart tag.</span></span> <span data-ttu-id="f0536-110">不需要撰寫的程式碼。</span><span class="sxs-lookup"><span data-stu-id="f0536-110">No code needed to be written.</span></span>

<span data-ttu-id="f0536-111">不幸的是，DataList 缺少內建編輯和刪除 GridView 控制項中固有的功能。</span><span class="sxs-lookup"><span data-stu-id="f0536-111">Unfortunately, the DataList lacks the built-in editing and deleting capabilities inherent in the GridView control.</span></span> <span data-ttu-id="f0536-112">缺少的功能是部分 DataList 是從舊版的 ASP.NET，relic 宣告式資料來源控制項和免程式碼的資料修改網頁時無法使用。</span><span class="sxs-lookup"><span data-stu-id="f0536-112">This missing functionality is due in part to the fact that the DataList is a relic from the previous version of ASP.NET, when declarative data source controls and code-free data modification pages were unavailable.</span></span> <span data-ttu-id="f0536-113">DataList ASP.NET 2.0 中的未提供立即可用的相同資料修改功能為 GridView，而我們可以使用 ASP.NET 1.x 技術，以包含這類功能。</span><span class="sxs-lookup"><span data-stu-id="f0536-113">While the DataList in ASP.NET 2.0 does not offer the same out of the box data modification capabilities as the GridView, we can use ASP.NET 1.x techniques to include such functionality.</span></span> <span data-ttu-id="f0536-114">此方法需要的程式碼，但 DataList 來協助此程序中，我們會看到在本教學課程中，有一些事件和屬性。</span><span class="sxs-lookup"><span data-stu-id="f0536-114">This approach requires a bit of code but, as we'll see in this tutorial, the DataList has some events and properties in place to aid in this process.</span></span>

<span data-ttu-id="f0536-115">在本教學課程中，我們會看到如何建立支援編輯和刪除其基礎資料的 DataList。</span><span class="sxs-lookup"><span data-stu-id="f0536-115">In this tutorial we'll see how to create a DataList that supports editing and deleting of its underlying data.</span></span> <span data-ttu-id="f0536-116">未來的教學課程將探討更進階的編輯和刪除案例輸入的欄位驗證，包括依正常程序處理例外狀況引發的資料存取或商務邏輯層，依此類推。</span><span class="sxs-lookup"><span data-stu-id="f0536-116">Future tutorials will examine more advanced editing and deleting scenarios, including input field validation, gracefully handling exceptions raised from the Data Access or Business Logic Layers, and so on.</span></span>

> [!NOTE]
> <span data-ttu-id="f0536-117">像 DataList 和 Repeater 控制項缺少外的插入、 更新或刪除預設功能。</span><span class="sxs-lookup"><span data-stu-id="f0536-117">Like the DataList, the Repeater control lacks the out of the box functionality for inserting, updating, or deleting.</span></span> <span data-ttu-id="f0536-118">雖然這類功能，可以加入 DataList 會包含屬性和事件中繼器中找不到可簡化新增這類功能。</span><span class="sxs-lookup"><span data-stu-id="f0536-118">While such functionality can be added, the DataList includes properties and events not found in the Repeater that simplify adding such capabilities.</span></span> <span data-ttu-id="f0536-119">因此，本教學課程和查看編輯和刪除的未來的焦點嚴格來說，資料清單。</span><span class="sxs-lookup"><span data-stu-id="f0536-119">Therefore, this tutorial and future ones that look at editing and deleting will focus strictly on the DataList.</span></span>


## <a name="step-1-creating-the-editing-and-deleting-tutorials-web-pages"></a><span data-ttu-id="f0536-120">步驟 1： 建立編輯和刪除教學課程網頁</span><span class="sxs-lookup"><span data-stu-id="f0536-120">Step 1: Creating the Editing and Deleting Tutorials Web Pages</span></span>

<span data-ttu-id="f0536-121">我們開始探索如何更新及刪除資料清單中的資料之前，讓先花點時間在本教學課程的下一步 的數個工具，我們將需要我們網站專案中建立 ASP.NET 網頁的 s。</span><span class="sxs-lookup"><span data-stu-id="f0536-121">Before we start exploring how to update and delete data from a DataList, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="f0536-122">藉由新增新的資料夾，名為啟動`EditDeleteDataList`。</span><span class="sxs-lookup"><span data-stu-id="f0536-122">Start by adding a new folder named `EditDeleteDataList`.</span></span> <span data-ttu-id="f0536-123">接下來，新增到該資料夾，並確認其關聯與每個頁面的 下列 ASP.NET 網頁`Site.master`主版頁面：</span><span class="sxs-lookup"><span data-stu-id="f0536-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `BatchUpdate.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`


![如需教學課程加入 ASP.NET 網頁](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image1.png)

<span data-ttu-id="f0536-125">**圖 1**： 加入 ASP.NET 網頁的教學課程</span><span class="sxs-lookup"><span data-stu-id="f0536-125">**Figure 1**: Add the ASP.NET Pages for the Tutorials</span></span>


<span data-ttu-id="f0536-126">在其他資料夾，例如`Default.aspx`在`EditDeleteDataList`資料夾 > 一節中列出的教學課程。</span><span class="sxs-lookup"><span data-stu-id="f0536-126">Like in the other folders, `Default.aspx` in the `EditDeleteDataList` folder lists the tutorials in its section.</span></span> <span data-ttu-id="f0536-127">請記得，`SectionLevelTutorialListing.ascx`使用者控制項提供這項功能。</span><span class="sxs-lookup"><span data-stu-id="f0536-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="f0536-128">因此，新增此使用者控制項`Default.aspx`從拖曳到頁面的設計 檢視中的 方案總管 中拖曳。</span><span class="sxs-lookup"><span data-stu-id="f0536-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="f0536-129">[![將 SectionLevelTutorialListing.ascx 使用者控制項新增至 Default.aspx](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image3.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image3.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image2.png)</span></span>

<span data-ttu-id="f0536-130">**圖 2**： 新增`SectionLevelTutorialListing.ascx`使用者控制項`Default.aspx`([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image4.png))</span></span>


<span data-ttu-id="f0536-131">最後，將頁面新增項目，以作為`Web.sitemap`檔案。</span><span class="sxs-lookup"><span data-stu-id="f0536-131">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="f0536-132">具體來說，在使用 DataList 與重複項的主版/詳細報告之後新增下列標記`<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="f0536-132">Specifically, add the following markup after the Master/Detail Reports with the DataList and Repeater `<siteMapNode>`:</span></span>


[!code-xml[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample1.xml)]

<span data-ttu-id="f0536-133">在更新之後`Web.sitemap`，花點時間檢視教學課程網站，透過瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="f0536-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="f0536-134">在左側功能表現在包含 DataList 編輯和刪除教學課程的項目。</span><span class="sxs-lookup"><span data-stu-id="f0536-134">The menu on the left now includes items for the DataList editing and deleting tutorials.</span></span>


![網站導覽現在包含項目 DataList 編輯和刪除教學課程](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image5.png)

<span data-ttu-id="f0536-136">**圖 3**： 網站地圖現在包含項目 DataList 編輯和刪除教學課程</span><span class="sxs-lookup"><span data-stu-id="f0536-136">**Figure 3**: The Site Map Now Includes Entries for the DataList Editing and Deleting Tutorials</span></span>


## <a name="step-2-examining-techniques-for-updating-and-deleting-data"></a><span data-ttu-id="f0536-137">步驟 2： 檢查更新和刪除的資料技術</span><span class="sxs-lookup"><span data-stu-id="f0536-137">Step 2: Examining Techniques for Updating and Deleting Data</span></span>

<span data-ttu-id="f0536-138">編輯和刪除的 GridView 資料是很容易，因為基本上，GridView 和 ObjectDataSource 正常運作。</span><span class="sxs-lookup"><span data-stu-id="f0536-138">Editing and deleting data with the GridView is so easy because, underneath the covers, the GridView and ObjectDataSource work in concert.</span></span> <span data-ttu-id="f0536-139">中所述[檢查與插入、 更新和刪除事件相關聯](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)教學課程中，按一下資料列 s 的更新 按鈕時，GridView 會自動指派使用雙向資料繫結其欄位`UpdateParameters`其 ObjectDataSource 的集合，然後叫用該 ObjectDataSource 的`Update()`方法。</span><span class="sxs-lookup"><span data-stu-id="f0536-139">As discussed in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial, when a row s Update button is clicked, the GridView automatically assigns its fields that used two-way databinding to the `UpdateParameters` collection of its ObjectDataSource and then invokes that ObjectDataSource s `Update()` method.</span></span>

<span data-ttu-id="f0536-140">可惜的是，DataList 不提供任何此內建的功能。</span><span class="sxs-lookup"><span data-stu-id="f0536-140">Sadly, the DataList does not provide any of this built-in functionality.</span></span> <span data-ttu-id="f0536-141">它是我們有責任確保使用者的值會指派至 ObjectDataSource 的參數，且其`Update()`呼叫方法。</span><span class="sxs-lookup"><span data-stu-id="f0536-141">It is our responsibility to ensure that the user s values are assigned to the ObjectDataSource s parameters and that its `Update()` method is called.</span></span> <span data-ttu-id="f0536-142">為了協助我們在此工作中，DataList 會提供下列屬性和事件：</span><span class="sxs-lookup"><span data-stu-id="f0536-142">To aid us in this endeavor, the DataList provides the following properties and events:</span></span>

- <span data-ttu-id="f0536-143">**[ `DataKeyField`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeyfield.aspx)** 當更新或刪除時，我們必須要能夠唯一識別 DataList 中的每個項目。</span><span class="sxs-lookup"><span data-stu-id="f0536-143">**The [`DataKeyField` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeyfield.aspx)** when updating or deleting, we need to be able to uniquely identify each item in the DataList.</span></span> <span data-ttu-id="f0536-144">這個屬性設為顯示資料的主索引鍵的欄位。</span><span class="sxs-lookup"><span data-stu-id="f0536-144">Set this property to the primary key field of the displayed data.</span></span> <span data-ttu-id="f0536-145">如此一來，將會填入 DataList s [ `DataKeys`集合](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeys.aspx)具有指定`DataKeyField`每個 DataList 項目的值。</span><span class="sxs-lookup"><span data-stu-id="f0536-145">Doing so will populate the DataList s [`DataKeys` collection](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeys.aspx) with the specified `DataKeyField` value for each DataList item.</span></span>
- <span data-ttu-id="f0536-146">**[ `EditCommand`事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.editcommand.aspx)**  按鈕、 LinkButton 或 ImageButton 時，就會引發其`CommandName`屬性設定為按下編輯。</span><span class="sxs-lookup"><span data-stu-id="f0536-146">**The [`EditCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.editcommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Edit is clicked.</span></span>
- <span data-ttu-id="f0536-147">**[ `CancelCommand`事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.cancelcommand.aspx)**  按鈕、 LinkButton 或 ImageButton 時，就會引發其`CommandName`屬性設定為按下 [取消]。</span><span class="sxs-lookup"><span data-stu-id="f0536-147">**The [`CancelCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.cancelcommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Cancel is clicked.</span></span>
- <span data-ttu-id="f0536-148">**[ `UpdateCommand`事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.updatecommand.aspx)**  按鈕、 LinkButton 或 ImageButton 時，就會引發其`CommandName`屬性設定為按下更新。</span><span class="sxs-lookup"><span data-stu-id="f0536-148">**The [`UpdateCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.updatecommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Update is clicked.</span></span>
- <span data-ttu-id="f0536-149">**[ `DeleteCommand`事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.deletecommand.aspx)**  按鈕、 LinkButton 或 ImageButton 時，就會引發其`CommandName`屬性設定為按下 Delete。</span><span class="sxs-lookup"><span data-stu-id="f0536-149">**The [`DeleteCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.deletecommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete is clicked.</span></span>

<span data-ttu-id="f0536-150">使用這些屬性和事件，有四個方法可用來更新和刪除資料清單中的資料：</span><span class="sxs-lookup"><span data-stu-id="f0536-150">Using these properties and events, there are four approaches we can use to update and delete data from the DataList:</span></span>

1. <span data-ttu-id="f0536-151">**使用 ASP.NET 1.x 技術**DataList ASP.NET 2.0 和 ObjectDataSources 前存在且能夠更新及刪除資料，完全透過程式設計的方式。</span><span class="sxs-lookup"><span data-stu-id="f0536-151">**Using ASP.NET 1.x Techniques** the DataList existed prior to ASP.NET 2.0 and ObjectDataSources and was able to update and delete data entirely through programmatic means.</span></span> <span data-ttu-id="f0536-152">這項技術完全 ditches ObjectDataSource 和需要，我們將資料繫結至 DataList 直接從商務邏輯層，同時在擷取資料時要顯示和更新或刪除記錄時。</span><span class="sxs-lookup"><span data-stu-id="f0536-152">This technique ditches the ObjectDataSource altogether and requires that we bind the data to the DataList directly from the Business Logic Layer, both in retrieving the data to display and when updating or deleting a record.</span></span>
2. <span data-ttu-id="f0536-153">**用於選取、 更新和刪除的頁面上的單一 ObjectDataSource 控制項**DataList 缺少的 GridView s 固有編輯與刪除功能，而沒有 s 沒有理由，我們可以 t 中加入它們自己。</span><span class="sxs-lookup"><span data-stu-id="f0536-153">**Using a Single ObjectDataSource Control on the Page for Selecting, Updating, and Deleting** while the DataList lacks the GridView s inherent editing and deleting capabilities, there s no reason we can t add them in ourselves.</span></span> <span data-ttu-id="f0536-154">使用此方法時，我們在 GridView 範例中，就像使用 ObjectDataSource，但必須建立事件處理常式，如 DataList s`UpdateCommand`事件，我們可在此設定 ObjectDataSource 的參數並呼叫其`Update()`方法。</span><span class="sxs-lookup"><span data-stu-id="f0536-154">With this approach, we use an ObjectDataSource just like in the GridView examples, but must create an event handler for the DataList s `UpdateCommand` event where we set the ObjectDataSource s parameters and call its `Update()` method.</span></span>
3. <span data-ttu-id="f0536-155">**使用 ObjectDataSource 控制項的選取，但正在更新及刪除直接針對 BLL**時使用選項 2，我們必須撰寫的程式碼中`UpdateCommand`事件，並指派參數值，依此類推。</span><span class="sxs-lookup"><span data-stu-id="f0536-155">**Using an ObjectDataSource Control for Selecting, but Updating and Deleting Directly Against the BLL** when using option 2, we need to write a bit of code in the `UpdateCommand` event, assigning parameter values and so on.</span></span> <span data-ttu-id="f0536-156">相反地，我們可以堅持使用 ObjectDataSource 選取，但更新和刪除對進行呼叫直接 BLL （例如與選項 1）。</span><span class="sxs-lookup"><span data-stu-id="f0536-156">Instead, we can stick with using the ObjectDataSource for selecting, but make the updating and deleting calls directly against the BLL (like with option 1).</span></span> <span data-ttu-id="f0536-157">在我看來，直接與 BLL 互動來更新的資料會導致更容易閱讀程式碼與指派的 ObjectDataSource 秒`UpdateParameters`，然後呼叫其`Update()`方法。</span><span class="sxs-lookup"><span data-stu-id="f0536-157">In my opinion, updating data by interfacing directly with the BLL leads to more readable code than assigning the ObjectDataSource s `UpdateParameters` and calling its `Update()` method.</span></span>
4. <span data-ttu-id="f0536-158">**使用宣告式的方式，透過多個 ObjectDataSources**所有先前三種方法需要的程式碼。</span><span class="sxs-lookup"><span data-stu-id="f0536-158">**Using Declarative Means through Multiple ObjectDataSources** the previous three approaches all require a bit of code.</span></span> <span data-ttu-id="f0536-159">如果您 d 而繼續使用做為盡可能多宣告式語法，最後一個選項是包含多個頁面上的 ObjectDataSources。</span><span class="sxs-lookup"><span data-stu-id="f0536-159">If you d rather keep using as much declarative syntax as possible, a final option is to include multiple ObjectDataSources on the page.</span></span> <span data-ttu-id="f0536-160">第一個 ObjectDataSource BLL 從擷取資料，並將它繫結至 DataList。</span><span class="sxs-lookup"><span data-stu-id="f0536-160">The first ObjectDataSource retrieves the data from the BLL and binds it to the DataList.</span></span> <span data-ttu-id="f0536-161">更新，另一個的 ObjectDataSource 會新增，但新增直接在 DataList 的`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="f0536-161">For updating, another ObjectDataSource is added, but added directly within the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="f0536-162">若要包含刪除的支援，還另一個的 ObjectDataSource 會需要在`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="f0536-162">To include deleting support, yet another ObjectDataSource would be needed in the `ItemTemplate`.</span></span> <span data-ttu-id="f0536-163">使用此方法時，這些內嵌使用 ObjectDataSource`ControlParameters`若要以宣告方式繫結到使用者輸入控制項的 ObjectDataSource 的參數 (而不需要以程式設計方式指定 DataList s 中`UpdateCommand`事件處理常式)。</span><span class="sxs-lookup"><span data-stu-id="f0536-163">With this approach, these embedded ObjectDataSource s use `ControlParameters` to declaratively bind the ObjectDataSource s parameters to the user input controls (rather than having to specify them programmatically in the DataList s `UpdateCommand` event handler).</span></span> <span data-ttu-id="f0536-164">此方法仍需要的程式碼，我們必須呼叫內嵌的 ObjectDataSource s`Update()`或`Delete()`命令但需要遠小於使用其他三個方法。</span><span class="sxs-lookup"><span data-stu-id="f0536-164">This approach still requires a bit of code we need to call the embedded ObjectDataSource s `Update()` or `Delete()` command but requires far less than with the other three approaches.</span></span> <span data-ttu-id="f0536-165">這裡的缺點是，多個 ObjectDataSources 執行弄亂 頁面上，從整體可讀性 detracting。</span><span class="sxs-lookup"><span data-stu-id="f0536-165">The downside here is that the multiple ObjectDataSources do clutter up the page, detracting from the overall readability.</span></span>

<span data-ttu-id="f0536-166">如果強制只會使用其中一種方式，d 我選擇選項 1，因為它提供最大的彈性，而且 DataList 原先設計來容納此模式也一樣。</span><span class="sxs-lookup"><span data-stu-id="f0536-166">If forced to only ever use one of these approaches, I d choose option 1 because it provides the most flexibility and because the DataList was originally designed to accommodate this pattern.</span></span> <span data-ttu-id="f0536-167">雖然 DataList 已擴充，可使用 ASP.NET 2.0 資料來源控制項，它並沒有擴充點的所有或正式的 ASP.NET 2.0 資料 Web 控制項 （GridView、 DetailsView 和 FormView） 的功能。</span><span class="sxs-lookup"><span data-stu-id="f0536-167">While the DataList was extended to work with the ASP.NET 2.0 data source controls, it does not have all of the extensibility points or features of the official ASP.NET 2.0 data Web controls (the GridView, DetailsView, and FormView).</span></span> <span data-ttu-id="f0536-168">選項 2 到 4 不值得一讀，不過。</span><span class="sxs-lookup"><span data-stu-id="f0536-168">Options 2 through 4 are not without merit, though.</span></span>

<span data-ttu-id="f0536-169">這和未來編輯和刪除教學課程會使用 ObjectDataSource 擷取資料以顯示，並直接呼叫來更新和刪除資料 （選項 3） BLL。</span><span class="sxs-lookup"><span data-stu-id="f0536-169">This and the future editing and deleting tutorials will use an ObjectDataSource for retrieving the data to display and direct calls to the BLL to update and delete data (option 3).</span></span>

## <a name="step-3-adding-the-datalist-and-configuring-its-objectdatasource"></a><span data-ttu-id="f0536-170">步驟 3： 加入 DataList 和設定其 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="f0536-170">Step 3: Adding the DataList and Configuring its ObjectDataSource</span></span>

<span data-ttu-id="f0536-171">在本教學課程中，我們將建立資料清單，列出產品資訊，並針對每個產品，提供使用者編輯的名稱和價格，並一併刪除產品的能力。</span><span class="sxs-lookup"><span data-stu-id="f0536-171">In this tutorial we will create a DataList that lists product information and, for each product, provides the user the ability to edit the name and price and to delete the product altogether.</span></span> <span data-ttu-id="f0536-172">特別的是，我們將擷取的記錄，以顯示使用 ObjectDataSource，但執行更新和刪除動作直接與 BLL 互動。</span><span class="sxs-lookup"><span data-stu-id="f0536-172">In particular, we will retrieve the records to display using an ObjectDataSource, but perform the update and delete actions by interfacing directly with the BLL.</span></span> <span data-ttu-id="f0536-173">我們會擔心至 DataList 的編輯和刪除功能實作之前，讓 s 首先取得唯讀介面中顯示的產品頁面。</span><span class="sxs-lookup"><span data-stu-id="f0536-173">Before we worry about implementing the editing and deleting capabilities to the DataList, let s first get the page to display the products in a read-only interface.</span></span> <span data-ttu-id="f0536-174">因為我們 ve 檢查下列步驟在上一個教學課程中，我將繼續透過這些快速。</span><span class="sxs-lookup"><span data-stu-id="f0536-174">Since we ve examined these steps in previous tutorials, I'll proceed through them quickly.</span></span>

<span data-ttu-id="f0536-175">首先開啟`Basics.aspx`頁面中`EditDeleteDataList`資料夾並從 設計 檢視中，加入至頁面的 DataList。</span><span class="sxs-lookup"><span data-stu-id="f0536-175">Start by opening the `Basics.aspx` page in the `EditDeleteDataList` folder and, from the Design view, add a DataList to the page.</span></span> <span data-ttu-id="f0536-176">接下來，從 DataList s 智慧標籤，建立新的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="f0536-176">Next, from the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="f0536-177">因為我們正與產品資料，將它設定為使用`ProductsBLL`類別。</span><span class="sxs-lookup"><span data-stu-id="f0536-177">Since we are working with product data, configure it to use the `ProductsBLL` class.</span></span> <span data-ttu-id="f0536-178">若要擷取*所有*產品中，選擇`GetProducts()`選取索引標籤中的方法。</span><span class="sxs-lookup"><span data-stu-id="f0536-178">To retrieve *all* products, choose the `GetProducts()` method in the SELECT tab.</span></span>


<span data-ttu-id="f0536-179">[![設定使用 ProductsBLL 類別 ObjectDataSource](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image7.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-179">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image7.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image6.png)</span></span>

<span data-ttu-id="f0536-180">**圖 4**： 設定要使用 ObjectDataSource`ProductsBLL`類別 ([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-180">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image8.png))</span></span>


<span data-ttu-id="f0536-181">[![傳回使用 GetProducts() 方法的產品資訊](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image10.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-181">[![Return the Product Information Using the GetProducts() Method](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image10.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image9.png)</span></span>

<span data-ttu-id="f0536-182">**圖 5**： 傳回產品資訊使用`GetProducts()`方法 ([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-182">**Figure 5**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image11.png))</span></span>


<span data-ttu-id="f0536-183">DataList，像是 GridView，不是插入新的資料;因此，請選取 （無）] 選項從下拉式清單中 [插入] 索引標籤。也選擇 （無） 更新和刪除索引標籤，因為會透過 BLL 以程式設計方式執行 [更新與刪除。</span><span class="sxs-lookup"><span data-stu-id="f0536-183">The DataList, like the GridView, is not designed for inserting new data; therefore, select the (None) option from the drop-down list in the INSERT tab. Also choose (None) for the UPDATE and DELETE tabs since the updates and deletes will be performed programmatically through the BLL.</span></span>


<span data-ttu-id="f0536-184">[![確認下拉式清單會列出在 Sqldatasource 插入、 更新和刪除索引標籤設為 （無）](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image13.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-184">[![Confirm that the Drop-Down Lists in the ObjectDataSource s INSERT, UPDATE, and DELETE Tabs are Set to (None)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image13.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image12.png)</span></span>

<span data-ttu-id="f0536-185">**圖 6**： 確認 ObjectDataSource 的插入、 更新和刪除索引標籤中的下拉式清單是否設定為 （無） ([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-185">**Figure 6**: Confirm that the Drop-Down Lists in the ObjectDataSource s INSERT, UPDATE, and DELETE Tabs are Set to (None) ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image14.png))</span></span>


<span data-ttu-id="f0536-186">設定 ObjectDataSource 之後, 按一下 完成，返回 設計工具。</span><span class="sxs-lookup"><span data-stu-id="f0536-186">After configuring the ObjectDataSource, click Finish, returning to the Designer.</span></span> <span data-ttu-id="f0536-187">為我們建立時自動完成的 ObjectDataSource 組態時，Visual Studio，在過去的範例中，看到 ve`ItemTemplate`的下拉式清單中，顯示每個資料欄位。</span><span class="sxs-lookup"><span data-stu-id="f0536-187">As we ve seen in past examples, when completing the ObjectDataSource configuration, Visual Studio automatically creates an `ItemTemplate` for the DropDownList, displaying each of the data fields.</span></span> <span data-ttu-id="f0536-188">取代此項`ItemTemplate`與其中一個會顯示只有產品的名稱和價格。</span><span class="sxs-lookup"><span data-stu-id="f0536-188">Replace this `ItemTemplate` with one that displays only the product s name and price.</span></span> <span data-ttu-id="f0536-189">此外，設定`RepeatColumns`屬性設為 2。</span><span class="sxs-lookup"><span data-stu-id="f0536-189">Also, set the `RepeatColumns` property to 2.</span></span>

> [!NOTE]
> <span data-ttu-id="f0536-190">中所述*概觀的插入、 更新和刪除的資料*教學課程中，修改資料使用我們的架構需要我們移除 ObjectDataSource 時`OldValuesParameterFormatString`從 ObjectDataSource 的屬性宣告式標記 (或其重設為其預設值`{0}`)。</span><span class="sxs-lookup"><span data-stu-id="f0536-190">As discussed in the *Overview of Inserting, Updating, and Deleting Data* tutorial, when modifying data using the ObjectDataSource our architecture requires that we remove the `OldValuesParameterFormatString` property from the ObjectDataSource s declarative markup (or reset it to its default value, `{0}`).</span></span> <span data-ttu-id="f0536-191">在本教學課程中，不過，我們會使用 ObjectDataSource 僅適用於擷取資料。</span><span class="sxs-lookup"><span data-stu-id="f0536-191">In this tutorial, however, we are using the ObjectDataSource only for retrieving data.</span></span> <span data-ttu-id="f0536-192">因此，我們不需要修改 ObjectDataSource 的`OldValuesParameterFormatString`屬性值 (雖然它不 t 會降低，若要這樣做)。</span><span class="sxs-lookup"><span data-stu-id="f0536-192">Therefore, we do not need to modify the ObjectDataSource s `OldValuesParameterFormatString` property value (although it doesn t hurt to do so).</span></span>


<span data-ttu-id="f0536-193">取代預設 DataList 後`ItemTemplate`一個自訂頁面上的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="f0536-193">After replacing the default DataList `ItemTemplate` with a customized one, the declarative markup on your page should look similar to the following:</span></span>


[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample2.aspx)]

<span data-ttu-id="f0536-194">請花一點時間檢閱我們透過瀏覽器的進度。</span><span class="sxs-lookup"><span data-stu-id="f0536-194">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="f0536-195">如 [圖 7] 所示，DataList 會顯示在兩個資料行中的每個產品的產品名稱和單位價格。</span><span class="sxs-lookup"><span data-stu-id="f0536-195">As Figure 7 shows, the DataList displays the product name and unit price for each product in two columns.</span></span>


<span data-ttu-id="f0536-196">[![產品名稱和優惠的價格會顯示在兩個資料行的資料清單](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image16.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-196">[![The Products Names and Prices are Displayed in a Two-Column DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image16.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image15.png)</span></span>

<span data-ttu-id="f0536-197">**圖 7**: 產品名稱和價格會顯示在兩個資料行 DataList ([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-197">**Figure 7**: The Products Names and Prices are Displayed in a Two-Column DataList ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image17.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f0536-198">DataList 的所需的更新和刪除處理程序的屬性數目，這些值會儲存檢視狀態中。</span><span class="sxs-lookup"><span data-stu-id="f0536-198">The DataList has a number of properties that are required for the updating and deleting process, and these values are stored in view state.</span></span> <span data-ttu-id="f0536-199">因此，當建置 DataList 支援編輯或刪除資料，很重要，啟用 DataList 的檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="f0536-199">Therefore, when building a DataList that supports editing or deleting data, it is essential that the DataList s view state be enabled.</span></span>  
>   
>  <span data-ttu-id="f0536-200">精明的讀者可能還記得我們才能夠建立可編輯的 Gridview、 DetailsViews 和 FormViews 時停用檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="f0536-200">The astute reader may recall that we were able to disable view state when creating editable GridViews, DetailsViews, and FormViews.</span></span> <span data-ttu-id="f0536-201">這是因為 ASP.NET 2.0 Web 控制項可以包含*控制狀態*，它會在類似的檢視狀態，但會被視為必要回傳間保存狀態。</span><span class="sxs-lookup"><span data-stu-id="f0536-201">This is because ASP.NET 2.0 Web controls can include *control state*, which is state persisted across postbacks like view state, but deemed essential.</span></span>


<span data-ttu-id="f0536-202">停用檢視 GridView 內的狀態只是省略了簡單的狀態資訊，但維持控制狀態 （其中包含所需的編輯和刪除的狀態）。</span><span class="sxs-lookup"><span data-stu-id="f0536-202">Disabling view state in the GridView merely omits trivial state information, but maintains the control state (which includes the state necessary for editing and deleting).</span></span> <span data-ttu-id="f0536-203">DataList，已經建立在 ASP.NET 1.x 時間範圍內，不會使用控制項狀態，因此必須啟用檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="f0536-203">The DataList, having been created in the ASP.NET 1.x timeframe, does not utilize control state and therefore must have view state enabled.</span></span> <span data-ttu-id="f0536-204">請參閱[vs 控制項狀態。檢視狀態](https://msdn.microsoft.com/library/1whwt1k7.aspx)如用途的控制項狀態，並從檢視狀態的不同方式的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="f0536-204">See [Control State vs. View State](https://msdn.microsoft.com/library/1whwt1k7.aspx) for more information on the purpose of control state and how it differs from view state.</span></span>

## <a name="step-4-adding-an-editing-user-interface"></a><span data-ttu-id="f0536-205">步驟 4： 加入編輯的使用者介面</span><span class="sxs-lookup"><span data-stu-id="f0536-205">Step 4: Adding an Editing User Interface</span></span>

<span data-ttu-id="f0536-206">GridView 控制項是由欄位 （BoundFields CheckBoxFields、 TemplateFields，等等） 的集合所組成。</span><span class="sxs-lookup"><span data-stu-id="f0536-206">The GridView control is composed of a collection of fields (BoundFields, CheckBoxFields, TemplateFields, and so on).</span></span> <span data-ttu-id="f0536-207">這些欄位可以調整其呈現的標記，視其模式而定。</span><span class="sxs-lookup"><span data-stu-id="f0536-207">These fields can adjust their rendered markup depending on their mode.</span></span> <span data-ttu-id="f0536-208">例如，在唯讀模式中，BoundField 顯示其資料欄位值為文字;處於編輯模式時，它會轉譯文字方塊的 Web 控制項`Text`屬性會被指派資料欄位值。</span><span class="sxs-lookup"><span data-stu-id="f0536-208">For example, when in read-only mode, a BoundField displays its data field value as text; when in edit mode, it renders a TextBox Web control whose `Text` property is assigned the data field value.</span></span>

<span data-ttu-id="f0536-209">DataList，相反地，會呈現其使用範本的項目。</span><span class="sxs-lookup"><span data-stu-id="f0536-209">The DataList, on the other hand, renders its items using templates.</span></span> <span data-ttu-id="f0536-210">唯讀項目會使用來呈現`ItemTemplate`而在編輯模式中的項目會轉譯透過`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="f0536-210">Read-only items are rendered using the `ItemTemplate` whereas items in edit mode are rendered via the `EditItemTemplate`.</span></span> <span data-ttu-id="f0536-211">到目前為止，我們 DataList 只有`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="f0536-211">At this point, our DataList has only an `ItemTemplate`.</span></span> <span data-ttu-id="f0536-212">若要支援項目層級編輯的功能，我們需要加入`EditItemTemplate`，其中包含可編輯的項目要顯示的標記。</span><span class="sxs-lookup"><span data-stu-id="f0536-212">To support item-level editing functionality we need to add an `EditItemTemplate` that contains the markup to be displayed for the editable item.</span></span> <span data-ttu-id="f0536-213">本教學課程中，我們將使用 TextBox Web 控制項編輯產品的名稱與單位價格。</span><span class="sxs-lookup"><span data-stu-id="f0536-213">For this tutorial, we'll use TextBox Web controls for editing the product s name and unit price.</span></span>

<span data-ttu-id="f0536-214">`EditItemTemplate`可以建立以宣告方式或透過設計工具 （從 DataList s 智慧標籤中選取 [編輯範本] 選項）。</span><span class="sxs-lookup"><span data-stu-id="f0536-214">The `EditItemTemplate` can be created either declaratively or through the Designer (by selecting the Edit Templates option from the DataList s smart tag).</span></span> <span data-ttu-id="f0536-215">若要使用 編輯範本 選項，請先按一下 編輯範本中的 連結的智慧標籤，然後按`EditItemTemplate`從下拉式清單中的項目。</span><span class="sxs-lookup"><span data-stu-id="f0536-215">To use the Edit Templates option, first click the Edit Templates link in the smart tag and then select the `EditItemTemplate` item from the drop-down list.</span></span>


<span data-ttu-id="f0536-216">[![使用 DataList 的 EditItemTemplate 選擇](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image19.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-216">[![Opt to Work with the DataList s EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image19.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image18.png)</span></span>

<span data-ttu-id="f0536-217">**圖 8**： 選擇使用 DataList s `EditItemTemplate` ([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-217">**Figure 8**: Opt to Work with the DataList s `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image20.png))</span></span>


<span data-ttu-id="f0536-218">接下來，輸入產品名稱： 和價格:，然後拖曳兩個 TextBox 控制項，從工具箱拖曳到`EditItemTemplate`設計工具上的介面。</span><span class="sxs-lookup"><span data-stu-id="f0536-218">Next, type in Product name: and Price: and then drag two TextBox controls from the Toolbox into the `EditItemTemplate` interface on the Designer.</span></span> <span data-ttu-id="f0536-219">設定文字方塊`ID`屬性，以`ProductName`和`UnitPrice`。</span><span class="sxs-lookup"><span data-stu-id="f0536-219">Set the TextBoxes `ID` properties to `ProductName` and `UnitPrice`.</span></span>


<span data-ttu-id="f0536-220">[![產品名稱和價格加入文字方塊](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image22.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-220">[![Add a TextBox for the Product s Name and Price](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image22.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image21.png)</span></span>

<span data-ttu-id="f0536-221">**圖 9**： 新增文字方塊中的產品名稱和價格 ([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-221">**Figure 9**: Add a TextBox for the Product s Name and Price ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image23.png))</span></span>


<span data-ttu-id="f0536-222">我們要繫結到對應的產品資料欄位值`Text`兩個文字方塊的屬性。</span><span class="sxs-lookup"><span data-stu-id="f0536-222">We need to bind the corresponding product data field values to the `Text` properties of the two TextBoxes.</span></span> <span data-ttu-id="f0536-223">從文字方塊的智慧標籤，按一下 [編輯資料繫結] 連結，並將關聯的適當的資料欄位`Text`屬性，如 [圖 10] 所示。</span><span class="sxs-lookup"><span data-stu-id="f0536-223">From the TextBoxes smart tags, click on the Edit DataBindings link and then associate the appropriate data field with the `Text` property, as shown in Figure 10.</span></span>

> [!NOTE]
> <span data-ttu-id="f0536-224">當繫結`UnitPrice`價格文字方塊 s 的資料欄位`Text`欄位中，您可能會將它格式化為貨幣值 (`{0:C}`)，一般數字 (`{0:N}`)，或將它保留為未格式化。</span><span class="sxs-lookup"><span data-stu-id="f0536-224">When binding the `UnitPrice` data field to the price TextBox s `Text` field, you may format it as a currency value (`{0:C}`), a general number (`{0:N}`), or leave it unformatted.</span></span>


![將 ProductName 和 UnitPrice 資料欄位繫結到文字方塊的 Text 屬性](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image24.png)

<span data-ttu-id="f0536-226">**圖 10**： 繫結`ProductName`並`UnitPrice`資料欄位加入`Text`文字方塊的屬性</span><span class="sxs-lookup"><span data-stu-id="f0536-226">**Figure 10**: Bind the `ProductName` and `UnitPrice` Data Fields to the `Text` Properties of the TextBoxes</span></span>


<span data-ttu-id="f0536-227">請注意圖 10 中的 編輯資料繫結 對話方塊是怎麼*不*包含編輯為 TemplateField GridView 或 DetailsView 或 FormView 的範本時顯示的雙向資料繫結核取方塊。</span><span class="sxs-lookup"><span data-stu-id="f0536-227">Notice how the Edit DataBindings dialog box in Figure 10 does *not* include the Two-way databinding checkbox that is present when editing a TemplateField in the GridView or DetailsView, or a template in the FormView.</span></span> <span data-ttu-id="f0536-228">雙向資料繫結功能允許自動指派給對應的 ObjectDataSource s 的輸入 Web 控制項的輸入值`InsertParameters`或`UpdateParameters`插入或更新資料時。</span><span class="sxs-lookup"><span data-stu-id="f0536-228">The two-way databinding feature allowed the value entered into the input Web control to be automatically assigned to the corresponding ObjectDataSource s `InsertParameters` or `UpdateParameters` when inserting or updating data.</span></span> <span data-ttu-id="f0536-229">DataList 不支援雙向資料繫結，因為我們將於稍後看到在本教學課程中，使用者可讓她變更，並已準備好更新的資料之後，我們必須以程式設計方式存取這些文字方塊`Text`屬性，並傳入其值適當`UpdateProduct`方法中的`ProductsBLL`類別。</span><span class="sxs-lookup"><span data-stu-id="f0536-229">The DataList does not support two-way databinding as we'll see later on in this tutorial, after the user makes her changes and is ready to update the data, we will need to programmatically access these TextBoxes `Text` properties and pass in their values to the appropriate `UpdateProduct` method in the `ProductsBLL` class.</span></span>

<span data-ttu-id="f0536-230">最後，我們需要新增更新] 和 [取消按鈕`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="f0536-230">Finally, we need to add Update and Cancel buttons to the `EditItemTemplate`.</span></span> <span data-ttu-id="f0536-231">如我們在中所見[主要/詳細說明使用具有詳細資料 DataList 的主要記錄項目符號清單](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)教學課程中，或按鈕時，LinkButton、 ImageButton 其`CommandName`設定 DataList 和 Repeater 內按一下從Repeater 或 DataList`ItemCommand`就會引發事件。</span><span class="sxs-lookup"><span data-stu-id="f0536-231">As we saw in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial, when a Button, LinkButton, or ImageButton whose `CommandName` property is set is clicked from within a Repeater or DataList, the Repeater or DataList s `ItemCommand` event is raised.</span></span> <span data-ttu-id="f0536-232">針對 DataList，如果`CommandName`屬性設定為某個值，也可能引發其他事件。</span><span class="sxs-lookup"><span data-stu-id="f0536-232">For the DataList, if the `CommandName` property is set to a certain value, an additional event may be raised as well.</span></span> <span data-ttu-id="f0536-233">特殊`CommandName`包含屬性值，其他項目：</span><span class="sxs-lookup"><span data-stu-id="f0536-233">The special `CommandName` property values include, among others:</span></span>

- <span data-ttu-id="f0536-234">取消引發`CancelCommand`事件</span><span class="sxs-lookup"><span data-stu-id="f0536-234">Cancel raises the `CancelCommand` event</span></span>
- <span data-ttu-id="f0536-235">編輯引發`EditCommand`事件</span><span class="sxs-lookup"><span data-stu-id="f0536-235">Edit raises the `EditCommand` event</span></span>
- <span data-ttu-id="f0536-236">更新會引發`UpdateCommand`事件</span><span class="sxs-lookup"><span data-stu-id="f0536-236">Update raises the `UpdateCommand` event</span></span>

<span data-ttu-id="f0536-237">請記住，這些事件會引發*除了*`ItemCommand`事件。</span><span class="sxs-lookup"><span data-stu-id="f0536-237">Keep in mind that these events are raised *in addition to* the `ItemCommand` event.</span></span>

<span data-ttu-id="f0536-238">若要新增`EditItemTemplate`兩個按鈕 Web 控制項、 一個其`CommandName`設定為 更新和其他 s 設定為 取消。</span><span class="sxs-lookup"><span data-stu-id="f0536-238">Add to the `EditItemTemplate` two Button Web controls, one whose `CommandName` is set to Update and the other s set to Cancel.</span></span> <span data-ttu-id="f0536-239">在之後加入這兩個按鈕 Web 控制項設計工具看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="f0536-239">After adding these two Button Web controls the Designer should look similar to the following:</span></span>


<span data-ttu-id="f0536-240">[![新增更新和取消 EditItemTemplate 的按鈕](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image26.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-240">[![Add Update and Cancel Buttons to the EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image26.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image25.png)</span></span>

<span data-ttu-id="f0536-241">**圖 11**： 新增更新和取消按鈕，以`EditItemTemplate`([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-241">**Figure 11**: Add Update and Cancel Buttons to the `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image27.png))</span></span>


<span data-ttu-id="f0536-242">使用`EditItemTemplate`完整 DataList s 宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="f0536-242">With the `EditItemTemplate` complete your DataList s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample3.aspx)]

## <a name="step-5-adding-the-plumbing-to-enter-edit-mode"></a><span data-ttu-id="f0536-243">步驟 5： 新增要進入編輯模式</span><span class="sxs-lookup"><span data-stu-id="f0536-243">Step 5: Adding the Plumbing to Enter Edit Mode</span></span>

<span data-ttu-id="f0536-244">此時我們 DataList 有編輯介面透過定義其`EditItemTemplate`; 不過，那里 s 目前無法讓使用者瀏覽我們的頁面來表示他想要編輯產品的資訊。</span><span class="sxs-lookup"><span data-stu-id="f0536-244">At this point our DataList has an editing interface defined via its `EditItemTemplate`; however, there s currently no way for a user visiting our page to indicate that he wants to edit a product s information.</span></span> <span data-ttu-id="f0536-245">我們需要新增至每個產品，按一下時，會轉譯該 DataList 項目處於編輯模式的 [編輯] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="f0536-245">We need to add an Edit button to each product that, when clicked, renders that DataList item in edit mode.</span></span> <span data-ttu-id="f0536-246">新增至 [編輯] 按鈕開始`ItemTemplate`，透過設計工具或以宣告方式。</span><span class="sxs-lookup"><span data-stu-id="f0536-246">Start by adding an Edit button to the `ItemTemplate`, either through the Designer or declaratively.</span></span> <span data-ttu-id="f0536-247">一定要在設定 [編輯] 按鈕的`CommandName`若要編輯的屬性。</span><span class="sxs-lookup"><span data-stu-id="f0536-247">Be certain to set the Edit button s `CommandName` property to Edit .</span></span>

<span data-ttu-id="f0536-248">您加入此 [編輯] 按鈕之後，請花一點時間檢視透過瀏覽器頁面。</span><span class="sxs-lookup"><span data-stu-id="f0536-248">After you have added this Edit button, take a moment to view the page through a browser.</span></span> <span data-ttu-id="f0536-249">此步驟中，每個產品清單應包含 [編輯] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="f0536-249">With this addition, each product listing should include an Edit button.</span></span>


<span data-ttu-id="f0536-250">[![新增更新和取消 EditItemTemplate 的按鈕](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image29.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-250">[![Add Update and Cancel Buttons to the EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image29.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image28.png)</span></span>

<span data-ttu-id="f0536-251">**圖 12**： 新增更新和取消按鈕，以`EditItemTemplate`([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-251">**Figure 12**: Add Update and Cancel Buttons to the `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image30.png))</span></span>


<span data-ttu-id="f0536-252">按一下按鈕會導致回傳，但卻*不*將進入編輯模式中列出的產品。</span><span class="sxs-lookup"><span data-stu-id="f0536-252">Clicking the button causes a postback, but does *not* bring the product listing into edit mode.</span></span> <span data-ttu-id="f0536-253">若要讓產品可供編輯，我們需要：</span><span class="sxs-lookup"><span data-stu-id="f0536-253">To make the product editable, we need to:</span></span>

1. <span data-ttu-id="f0536-254">設定 DataList s [ `EditItemIndex`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx)目的索引`DataListItem`只按下的 [編輯] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="f0536-254">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of the `DataListItem` whose Edit button was just clicked.</span></span>
2. <span data-ttu-id="f0536-255">重新繫結至 DataList 的資料。</span><span class="sxs-lookup"><span data-stu-id="f0536-255">Rebind the data to the DataList.</span></span> <span data-ttu-id="f0536-256">DataList 時重新呈現`DataListItem`其`ItemIndex`DataList s 與相對應`EditItemIndex`會呈現使用其`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="f0536-256">When the DataList is re-rendered, the `DataListItem` whose `ItemIndex` corresponds with the DataList s `EditItemIndex` will render using its `EditItemTemplate`.</span></span>

<span data-ttu-id="f0536-257">因為 DataList s`EditCommand`時會引發事件，按一下 [編輯] 按鈕時，建立`EditCommand`為下列程式碼的事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="f0536-257">Since the DataList s `EditCommand` event is fired when the Edit button is clicked, create an `EditCommand` event handler with the following code:</span></span>


[!code-csharp[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample4.cs)]

<span data-ttu-id="f0536-258">`EditCommand`型別的物件傳遞的事件處理常式`DataListCommandEventArgs`做為其第二個輸入參數，其中包含的參考`DataListItem`按下的 [編輯] 按鈕 (`e.Item`)。</span><span class="sxs-lookup"><span data-stu-id="f0536-258">The `EditCommand` event handler is passed in an object of type `DataListCommandEventArgs` as its second input parameter, which includes a reference to the `DataListItem` whose Edit button was clicked (`e.Item`).</span></span> <span data-ttu-id="f0536-259">事件處理常式會先設定 DataList s`EditItemIndex`要`ItemIndex`的可編輯`DataListItem`，然後會重新繫結至 DataList 的資料藉由呼叫 DataList 的`DataBind()`方法。</span><span class="sxs-lookup"><span data-stu-id="f0536-259">The event handler first sets the DataList s `EditItemIndex` to the `ItemIndex` of the editable `DataListItem` and then rebinds the data to the DataList by calling the DataList s `DataBind()` method.</span></span>

<span data-ttu-id="f0536-260">加入這個事件處理常式之後, 重新瀏覽的瀏覽器頁面。</span><span class="sxs-lookup"><span data-stu-id="f0536-260">After adding this event handler, revisit the page in a browser.</span></span> <span data-ttu-id="f0536-261">現在按一下 編輯 按鈕，讓已按下的產品可以讓您編輯 （請參閱 圖 13）。</span><span class="sxs-lookup"><span data-stu-id="f0536-261">Clicking the Edit button now makes the clicked product editable (see Figure 13).</span></span>


<span data-ttu-id="f0536-262">[![按一下 [編輯] 按鈕可讓產品可編輯](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image32.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-262">[![Clicking the Edit Button Makes the Product Editable](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image32.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image31.png)</span></span>

<span data-ttu-id="f0536-263">**圖 13**： 按一下 [編輯] 按鈕，讓產品可編輯 ([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-263">**Figure 13**: Clicking the Edit Button Makes the Product Editable ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image33.png))</span></span>


## <a name="step-6-saving-the-user-s-changes"></a><span data-ttu-id="f0536-264">步驟 6： 儲存使用者的變更</span><span class="sxs-lookup"><span data-stu-id="f0536-264">Step 6: Saving the User s Changes</span></span>

<span data-ttu-id="f0536-265">按一下 [取消] 按鈕的已編輯的產品 s Update 此時; 沒有任何作用若要新增此功能，我們需要建立事件處理常式的 DataList s`UpdateCommand`和`CancelCommand`事件。</span><span class="sxs-lookup"><span data-stu-id="f0536-265">Clicking the edited product s Update or Cancel buttons does nothing at this point; to add this functionality we need to create event handlers for the DataList s `UpdateCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="f0536-266">開始建立`CancelCommand`事件處理常式中，按一下 編輯的產品 s 取消 按鈕和它負責傳回 DataList 預先編輯狀態時執行。</span><span class="sxs-lookup"><span data-stu-id="f0536-266">Start by creating the `CancelCommand` event handler, which will execute when the edited product s Cancel button is clicked and it tasked with returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="f0536-267">若要讓 DataList 呈現其所有項在唯讀模式中，我們需要：</span><span class="sxs-lookup"><span data-stu-id="f0536-267">To have the DataList render all of its items in the read-only mode, we need to:</span></span>

1. <span data-ttu-id="f0536-268">設定 DataList s [ `EditItemIndex`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx)不存在的索引`DataListItem`索引。</span><span class="sxs-lookup"><span data-stu-id="f0536-268">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of a non-existent `DataListItem` index.</span></span> <span data-ttu-id="f0536-269">`-1` 是安全的選擇，因為`DataListItem`的索引開始`0`。</span><span class="sxs-lookup"><span data-stu-id="f0536-269">`-1` is a safe choice, since the `DataListItem` indexes start at `0`.</span></span>
2. <span data-ttu-id="f0536-270">重新繫結至 DataList 的資料。</span><span class="sxs-lookup"><span data-stu-id="f0536-270">Rebind the data to the DataList.</span></span> <span data-ttu-id="f0536-271">因為沒有`DataListItem` `ItemIndex` es 對應至 DataList 的`EditItemIndex`，整個 DataList 會呈現在唯讀模式。</span><span class="sxs-lookup"><span data-stu-id="f0536-271">Since no `DataListItem` `ItemIndex` es correspond to the DataList s `EditItemIndex`, the entire DataList will be rendered in a read-only mode.</span></span>

<span data-ttu-id="f0536-272">下列事件處理常式程式碼就可完成下列步驟：</span><span class="sxs-lookup"><span data-stu-id="f0536-272">These steps can be accomplished with the following event handler code:</span></span>


[!code-csharp[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample5.cs)]

<span data-ttu-id="f0536-273">此步驟中，按一下 [取消] 按鈕便會回到 DataList 其預先編輯的狀態。</span><span class="sxs-lookup"><span data-stu-id="f0536-273">With this addition, clicking the Cancel button returns the DataList to its pre-editing state.</span></span>

<span data-ttu-id="f0536-274">我們必須完成最後一個事件處理常式是`UpdateCommand`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="f0536-274">The last event handler we need to complete is the `UpdateCommand` event handler.</span></span> <span data-ttu-id="f0536-275">這個事件處理常式必須：</span><span class="sxs-lookup"><span data-stu-id="f0536-275">This event handler needs to:</span></span>

1. <span data-ttu-id="f0536-276">以程式設計方式存取使用者輸入的產品名稱和價格，以及編輯的產品的`ProductID`。</span><span class="sxs-lookup"><span data-stu-id="f0536-276">Programmatically access the user-entered product name and price as well as the edited product s `ProductID`.</span></span>
2. <span data-ttu-id="f0536-277">藉由呼叫適當的起始更新程序`UpdateProduct`多載中`ProductsBLL`類別。</span><span class="sxs-lookup"><span data-stu-id="f0536-277">Initiate the update process by calling the appropriate `UpdateProduct` overload in the `ProductsBLL` class.</span></span>
3. <span data-ttu-id="f0536-278">設定 DataList s [ `EditItemIndex`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx)不存在的索引`DataListItem`索引。</span><span class="sxs-lookup"><span data-stu-id="f0536-278">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of a non-existent `DataListItem` index.</span></span> <span data-ttu-id="f0536-279">`-1` 是安全的選擇，因為`DataListItem`的索引開始`0`。</span><span class="sxs-lookup"><span data-stu-id="f0536-279">`-1` is a safe choice, since the `DataListItem` indexes start at `0`.</span></span>
4. <span data-ttu-id="f0536-280">重新繫結至 DataList 的資料。</span><span class="sxs-lookup"><span data-stu-id="f0536-280">Rebind the data to the DataList.</span></span> <span data-ttu-id="f0536-281">因為沒有`DataListItem` `ItemIndex` es 對應至 DataList 的`EditItemIndex`，整個 DataList 會呈現在唯讀模式。</span><span class="sxs-lookup"><span data-stu-id="f0536-281">Since no `DataListItem` `ItemIndex` es correspond to the DataList s `EditItemIndex`, the entire DataList will be rendered in a read-only mode.</span></span>

<span data-ttu-id="f0536-282">步驟 1 和 2 會負責儲存使用者的變更;步驟 3 和 4 返回 DataList 預先編輯狀態所做的變更尚未儲存，並與執行中的步驟之後`CancelCommand`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="f0536-282">Steps 1 and 2 are responsible for saving the user s changes; steps 3 and 4 return the DataList to its pre-editing state after the changes have been saved and are identical to the steps performed in the `CancelCommand` event handler.</span></span>

<span data-ttu-id="f0536-283">若要取得更新的產品名稱和價格，我們必須使用`FindControl`方法來以程式設計方式 TextBox Web 控制項內的參考`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="f0536-283">To get the updated product name and price, we need to use the `FindControl` method to programmatically reference the TextBox Web controls within the `EditItemTemplate`.</span></span> <span data-ttu-id="f0536-284">我們也需要取得已編輯的產品的`ProductID`值。</span><span class="sxs-lookup"><span data-stu-id="f0536-284">We also need to get the edited product s `ProductID` value.</span></span> <span data-ttu-id="f0536-285">當我們一開始會結合至 DataList 的 ObjectDataSource 時，Visual Studio 指派 DataList s`DataKeyField`屬性從資料來源的主索引鍵值 (`ProductID`)。</span><span class="sxs-lookup"><span data-stu-id="f0536-285">When we initially bound the ObjectDataSource to the DataList, Visual Studio assigned the DataList s `DataKeyField` property to the primary key value from the data source (`ProductID`).</span></span> <span data-ttu-id="f0536-286">此值則可以擷取從 DataList 的`DataKeys`集合。</span><span class="sxs-lookup"><span data-stu-id="f0536-286">This value can then be retrieved from the DataList s `DataKeys` collection.</span></span> <span data-ttu-id="f0536-287">請花一點時間確認`DataKeyField`確實設定為`ProductID`。</span><span class="sxs-lookup"><span data-stu-id="f0536-287">Take a moment to ensure that the `DataKeyField` property is indeed set to `ProductID`.</span></span>

<span data-ttu-id="f0536-288">下列程式碼會實作四個步驟：</span><span class="sxs-lookup"><span data-stu-id="f0536-288">The following code implements the four steps:</span></span>


[!code-csharp[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample6.cs)]

<span data-ttu-id="f0536-289">事件處理常式一開始會讀取已編輯的產品 s`ProductID`從`DataKeys`集合。</span><span class="sxs-lookup"><span data-stu-id="f0536-289">The event handler starts by reading in the edited product s `ProductID` from the `DataKeys` collection.</span></span> <span data-ttu-id="f0536-290">下一步，在兩個文字方塊`EditItemTemplate`參考和其`Text`屬性儲存在區域變數`productNameValue`和`unitPriceValue`。</span><span class="sxs-lookup"><span data-stu-id="f0536-290">Next, the two TextBoxes in the `EditItemTemplate` are referenced and their `Text` properties stored in local variables, `productNameValue` and `unitPriceValue`.</span></span> <span data-ttu-id="f0536-291">我們會使用`Decimal.Parse()`方法來讀取的值從`UnitPrice`文字方塊中，因此，如果輸入的值有貨幣符號，它仍然正確可轉換為`Decimal`值。</span><span class="sxs-lookup"><span data-stu-id="f0536-291">We use the `Decimal.Parse()` method to read the value from the `UnitPrice` TextBox so that if the value entered has a currency symbol, it can still be correctly converted into a `Decimal` value.</span></span>

> [!NOTE]
> <span data-ttu-id="f0536-292">將值從`ProductName`和`UnitPrice`的文字方塊只會指派給在 productNameValue 和 unitPriceValue 變數如果文字方塊的 Text 屬性具有指定的值。</span><span class="sxs-lookup"><span data-stu-id="f0536-292">The values from the `ProductName` and `UnitPrice` TextBoxes are only assigned to the productNameValue and unitPriceValue variables if the TextBoxes Text properties have a value specified.</span></span> <span data-ttu-id="f0536-293">否則，值為`Nothing`用於變數中，使用資料庫來更新資料的效果`NULL`值。</span><span class="sxs-lookup"><span data-stu-id="f0536-293">Otherwise, a value of `Nothing` is used for the variables, which has the effect of updating the data with a database `NULL` value.</span></span> <span data-ttu-id="f0536-294">也就是我們的程式碼會將空字串，以資料庫`NULL`是 GridView、 DetailsView 和 FormView 控制項的編輯介面的預設行為的值。</span><span class="sxs-lookup"><span data-stu-id="f0536-294">That is, our code treats converts empty strings to database `NULL` values, which is the default behavior of the editing interface in the GridView, DetailsView, and FormView controls.</span></span>


<span data-ttu-id="f0536-295">在讀取值之後`ProductsBLL`類別 s`UpdateProduct`呼叫方法，傳入 s 產品名稱、 價格和`ProductID`。</span><span class="sxs-lookup"><span data-stu-id="f0536-295">After reading the values, the `ProductsBLL` class s `UpdateProduct` method is called, passing in the product s name, price, and `ProductID`.</span></span> <span data-ttu-id="f0536-296">事件處理常式完成藉由使用完全相同的邏輯中做為其預先編輯狀態傳回 DataList`CancelCommand`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="f0536-296">The event handler completes by returning the DataList to its pre-editing state using the exact same logic as in the `CancelCommand` event handler.</span></span>

<span data-ttu-id="f0536-297">具有`EditCommand`， `CancelCommand`，和`UpdateCommand`事件處理常式完成，訪客可以編輯的名稱和產品的價格。</span><span class="sxs-lookup"><span data-stu-id="f0536-297">With the `EditCommand`, `CancelCommand`, and `UpdateCommand` event handlers complete, a visitor can edit the name and price of a product.</span></span> <span data-ttu-id="f0536-298">圖 14-16 會顯示作用中的此編輯工作流程。</span><span class="sxs-lookup"><span data-stu-id="f0536-298">Figures 14-16 show this editing workflow in action.</span></span>


<span data-ttu-id="f0536-299">[![當第一次瀏覽頁面、 所有產品是在唯讀模式中](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image35.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-299">[![When First Visiting the Page, All Products are in Read-Only Mode](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image35.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image34.png)</span></span>

<span data-ttu-id="f0536-300">**圖 14**： 所有的產品時第一次瀏覽的頁面，會在唯讀模式中 ([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-300">**Figure 14**: When First Visiting the Page, All Products are in Read-Only Mode ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image36.png))</span></span>


<span data-ttu-id="f0536-301">[![若要更新的產品名稱的價格，請按一下 [編輯] 按鈕](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image38.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-301">[![To Update a Product s Name or Price, Click the Edit Button](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image38.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image37.png)</span></span>

<span data-ttu-id="f0536-302">**圖 15**： 若要更新的產品名稱或價格，請按一下 [編輯] 按鈕 ([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-302">**Figure 15**: To Update a Product s Name or Price, Click the Edit Button ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image39.png))</span></span>


<span data-ttu-id="f0536-303">[![在之後變更的值中，按一下 更新以唯讀模式返回](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image41.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="f0536-303">[![After Changing the Value, Click Update to Return to the Read-Only Mode](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image41.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image40.png)</span></span>

<span data-ttu-id="f0536-304">**圖 16**： 在之後變更的值，按一下 [更新]，以回復成唯讀模式 ([按一下以檢視完整大小的影像](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="f0536-304">**Figure 16**: After Changing the Value, Click Update to Return to the Read-Only Mode ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/_static/image42.png))</span></span>


## <a name="step-7-adding-delete-capabilities"></a><span data-ttu-id="f0536-305">步驟 7： 加入刪除功能</span><span class="sxs-lookup"><span data-stu-id="f0536-305">Step 7: Adding Delete Capabilities</span></span>

<span data-ttu-id="f0536-306">將刪除功能新增至 DataList 的步驟會類似於將編輯功能。</span><span class="sxs-lookup"><span data-stu-id="f0536-306">The steps for adding delete capabilities to a DataList are similar to those for adding editing capabilities.</span></span> <span data-ttu-id="f0536-307">簡單地說，我們需要加入至 [刪除] 按鈕`ItemTemplate`，按下時：</span><span class="sxs-lookup"><span data-stu-id="f0536-307">In short, we need to add a Delete button to the `ItemTemplate` that, when clicked:</span></span>

1. <span data-ttu-id="f0536-308">會在對應的產品 s 中讀取`ProductID`透過`DataKeys`集合。</span><span class="sxs-lookup"><span data-stu-id="f0536-308">Reads in the corresponding product s `ProductID` via the `DataKeys` collection.</span></span>
2. <span data-ttu-id="f0536-309">藉由呼叫執行 delete`ProductsBLL`類別的`DeleteProduct`方法。</span><span class="sxs-lookup"><span data-stu-id="f0536-309">Performs the delete by calling the `ProductsBLL` class s `DeleteProduct` method.</span></span>
3. <span data-ttu-id="f0536-310">重新繫結至 DataList 的資料。</span><span class="sxs-lookup"><span data-stu-id="f0536-310">Rebinds the data to the DataList.</span></span>

<span data-ttu-id="f0536-311">讓 s 新增到 [刪除] 按鈕開始`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="f0536-311">Let s start by adding a Delete button to the `ItemTemplate`.</span></span>

<span data-ttu-id="f0536-312">按下按鈕時其`CommandName`編輯、 更新、 或取消引發 DataList s`ItemCommand`以及其他事件的事件 (例如，當使用編輯`EditCommand`以及引發事件)。</span><span class="sxs-lookup"><span data-stu-id="f0536-312">When clicked, a Button whose `CommandName` is Edit, Update, or Cancel raises the DataList s `ItemCommand` event along with an additional event (for example, when using Edit the `EditCommand` event is raised as well).</span></span> <span data-ttu-id="f0536-313">同樣地，任何按鈕、 LinkButton 或 ImageButton DataList 中的其`CommandName`屬性設定為刪除的原因`DeleteCommand`引發的事件 (連同`ItemCommand`)。</span><span class="sxs-lookup"><span data-stu-id="f0536-313">Similarly, any Button, LinkButton, or ImageButton in the DataList whose `CommandName` property is set to Delete causes the `DeleteCommand` event to fire (along with `ItemCommand`).</span></span>

<span data-ttu-id="f0536-314">新增在 [編輯] 按鈕旁邊的 [刪除] 按鈕`ItemTemplate`，將其`CommandName`要刪除的屬性。</span><span class="sxs-lookup"><span data-stu-id="f0536-314">Add a Delete button next to the Edit button in the `ItemTemplate`, setting its `CommandName` property to Delete.</span></span> <span data-ttu-id="f0536-315">之後新增此按鈕會控制您 DataList 的`ItemTemplate`宣告式語法應該看起來像：</span><span class="sxs-lookup"><span data-stu-id="f0536-315">After adding this Button control your DataList s `ItemTemplate` declarative syntax should look like:</span></span>


[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample7.aspx)]

<span data-ttu-id="f0536-316">接下來，建立事件處理常式，如 DataList 的`DeleteCommand`事件，使用下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="f0536-316">Next, create an event handler for the DataList s `DeleteCommand` event, using the following code:</span></span>


[!code-csharp[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-cs/samples/sample8.cs)]

<span data-ttu-id="f0536-317">按一下 [刪除] 按鈕會造成回傳，並引發 DataList 的`DeleteCommand`事件。</span><span class="sxs-lookup"><span data-stu-id="f0536-317">Clicking the Delete button causes a postback and fires the DataList s `DeleteCommand` event.</span></span> <span data-ttu-id="f0536-318">在 事件處理常式中，按下的產品 s`ProductID`值從存取`DataKeys`集合。</span><span class="sxs-lookup"><span data-stu-id="f0536-318">In the event handler, the clicked product s `ProductID` value is accessed from the `DataKeys` collection.</span></span> <span data-ttu-id="f0536-319">接下來，呼叫刪除產品後`ProductsBLL`類別的`DeleteProduct`方法。</span><span class="sxs-lookup"><span data-stu-id="f0536-319">Next, the product is deleted by calling the `ProductsBLL` class s `DeleteProduct` method.</span></span>

<span data-ttu-id="f0536-320">刪除產品之後, 它重要我們重新繫結至 DataList 的資料 (`DataList1.DataBind()`)，否則 DataList 會繼續顯示只是已刪除的產品。</span><span class="sxs-lookup"><span data-stu-id="f0536-320">After deleting the product, it s important that we rebind the data to the DataList (`DataList1.DataBind()`), otherwise the DataList will continue to show the product that was just deleted.</span></span>

## <a name="summary"></a><span data-ttu-id="f0536-321">總結</span><span class="sxs-lookup"><span data-stu-id="f0536-321">Summary</span></span>

<span data-ttu-id="f0536-322">雖然 DataList 缺少點，然後按一下 編輯和刪除支援藉由 GridView，簡短的程式碼稍微它可以增強以包括這些功能。</span><span class="sxs-lookup"><span data-stu-id="f0536-322">While the DataList lacks the point and click editing and deleting support enjoyed by the GridView, with a short bit of code it can be enhanced to include these features.</span></span> <span data-ttu-id="f0536-323">在本教學課程中，我們了解如何建立，無法被刪除，而且無法編輯其名稱和價格的產品的兩個資料行清單的內容。</span><span class="sxs-lookup"><span data-stu-id="f0536-323">In this tutorial we saw how to create a two-column listing of products that could be deleted and whose name and price could be edited.</span></span> <span data-ttu-id="f0536-324">加入編輯和刪除支援是包括在適當的 Web 控制項的事宜`ItemTemplate`和`EditItemTemplate`、 建立相對應的事件處理常式、 讀取使用者輸入和主要金鑰值，以及配合企業邏輯層。</span><span class="sxs-lookup"><span data-stu-id="f0536-324">Adding editing and deleting support is a matter of including the appropriate Web controls in the `ItemTemplate` and `EditItemTemplate`, creating the corresponding event handlers, reading the user-entered and primary key values, and interfacing with the Business Logic Layer.</span></span>

<span data-ttu-id="f0536-325">雖然我們已加入基本編輯和刪除至 DataList 的功能，它會缺少更進階的功能。</span><span class="sxs-lookup"><span data-stu-id="f0536-325">While we have added basic editing and deleting capabilities to the DataList, it lacks more advanced features.</span></span> <span data-ttu-id="f0536-326">比方說，沒有任何輸入的欄位驗證-如果使用者輸入太價格昂貴，將會擲回例外狀況`Decimal.Parse`時嘗試轉換太昂貴到`Decimal`。</span><span class="sxs-lookup"><span data-stu-id="f0536-326">For example, there is no input field validation - if a user enters a price of Too expensive, an exception will be thrown by `Decimal.Parse` when attempting to convert Too expensive into a `Decimal`.</span></span> <span data-ttu-id="f0536-327">同樣地，如果在更新商務邏輯的資料或資料存取層級問題使用者會看到標準錯誤畫面。</span><span class="sxs-lookup"><span data-stu-id="f0536-327">Similarly, if there is a problem in updating the data at the Business Logic or Data Access Layers the user will be presented with the standard error screen.</span></span> <span data-ttu-id="f0536-328">沒有任何一種確認刪除 按鈕，不小心刪除產品是所有太可能。</span><span class="sxs-lookup"><span data-stu-id="f0536-328">Without any sort of confirmation on the Delete button, accidentally deleting a product is all too likely.</span></span>

<span data-ttu-id="f0536-329">教學課程，我們會了解如何改善編輯的使用者體驗的未來。</span><span class="sxs-lookup"><span data-stu-id="f0536-329">In future tutorials we'll see how to improve the editing user experience.</span></span>

<span data-ttu-id="f0536-330">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="f0536-330">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f0536-331">關於作者</span><span class="sxs-lookup"><span data-stu-id="f0536-331">About the Author</span></span>

<span data-ttu-id="f0536-332">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="f0536-332">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f0536-333">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="f0536-333">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f0536-334">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="f0536-334">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f0536-335">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f0536-335">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f0536-336">或透過他的部落格，這位於[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="f0536-336">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f0536-337">特別感謝</span><span class="sxs-lookup"><span data-stu-id="f0536-337">Special Thanks To</span></span>

<span data-ttu-id="f0536-338">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="f0536-338">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f0536-339">本教學課程中的潛在客戶檢閱者已 Zack Jones、 Ken Pespisa 和 Randy Schmidt。</span><span class="sxs-lookup"><span data-stu-id="f0536-339">Lead reviewers for this tutorial were Zack Jones, Ken Pespisa, and Randy Schmidt.</span></span> <span data-ttu-id="f0536-340">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="f0536-340">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f0536-341">如果是這樣，psychic 在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f0536-341">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="f0536-342">下一步</span><span class="sxs-lookup"><span data-stu-id="f0536-342">Next</span></span>](performing-batch-updates-cs.md)
