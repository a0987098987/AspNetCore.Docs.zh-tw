---
uid: web-forms/overview/data-access/custom-button-actions-with-the-datalist-and-repeater/custom-buttons-in-the-datalist-and-repeater-vb
title: "在 DataList 和中繼器 (VB) 中的自訂按鈕 |Microsoft 文件"
author: rick-anderson
description: "在本教學課程中，我們將建立一種介面，用於在系統中，列出分類，且每個分類提供按鈕，顯示其 associ 中繼器..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/13/2006
ms.topic: article
ms.assetid: 1afdb14d-6e49-4e1f-aead-2934730d472e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions-with-the-datalist-and-repeater/custom-buttons-in-the-datalist-and-repeater-vb
msc.type: authoredcontent
ms.openlocfilehash: fc6c297f08790cdcc74867df21e32258017c5a7d
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/24/2018
---
<a name="custom-buttons-in-the-datalist-and-repeater-vb"></a><span data-ttu-id="02e4d-103">在 DataList 和中繼器 (VB) 中的自訂按鈕</span><span class="sxs-lookup"><span data-stu-id="02e4d-103">Custom Buttons in the DataList and Repeater (VB)</span></span>
====================
<span data-ttu-id="02e4d-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="02e4d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="02e4d-105">[下載範例應用程式](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_46_VB.exe)或[下載 PDF](custom-buttons-in-the-datalist-and-repeater-vb/_static/datatutorial46vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="02e4d-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_46_VB.exe) or [Download PDF](custom-buttons-in-the-datalist-and-repeater-vb/_static/datatutorial46vb1.pdf)</span></span>

> <span data-ttu-id="02e4d-106">在本教學課程中，我們會建置用來在系統中，列出分類，且提供按鈕，以顯示其相關聯的產品使用 BulletedList 控制每個分類的中繼器的介面。</span><span class="sxs-lookup"><span data-stu-id="02e4d-106">In this tutorial we'll build an interface that uses a Repeater to list the categories in the system, with each category providing a button to show its associated products using a BulletedList control.</span></span>


## <a name="introduction"></a><span data-ttu-id="02e4d-107">簡介</span><span class="sxs-lookup"><span data-stu-id="02e4d-107">Introduction</span></span>

<span data-ttu-id="02e4d-108">在過去十七 DataList 和中繼器教學課程，我們已建立唯讀的範例和編輯和刪除範例。</span><span class="sxs-lookup"><span data-stu-id="02e4d-108">Throughout the past seventeen DataList and Repeater tutorials, we ve created both read-only examples and editing and deleting examples.</span></span> <span data-ttu-id="02e4d-109">若要簡化編輯和刪除功能在 DataList 內，我們加入按鈕 DataList s `ItemTemplate` ，按一下時，導致回傳，並引發對應的按鈕 s DataList 事件`CommandName`屬性。</span><span class="sxs-lookup"><span data-stu-id="02e4d-109">To facilitate editing and deleting capabilities within a DataList, we added buttons to the DataList s `ItemTemplate` that, when clicked, caused a postback and raised a DataList event corresponding to the button s `CommandName` property.</span></span> <span data-ttu-id="02e4d-110">例如，加入至按鈕`ItemTemplate`與`CommandName`編輯屬性值會導致 DataList s`EditCommand`成發生回傳時引發一個`CommandName`刪除引發`DeleteCommand`。</span><span class="sxs-lookup"><span data-stu-id="02e4d-110">For example, adding a button to the `ItemTemplate` with a `CommandName` property value of Edit causes the DataList s `EditCommand` to fire on postback; one with the `CommandName` Delete raises the `DeleteCommand`.</span></span>

<span data-ttu-id="02e4d-111">此外編輯和刪除按鈕、 DataList 和中繼器控制項也可以包含按鈕、 LinkButtons 或 ImageButtons，按一下時，執行一些自訂的伺服器端邏輯。</span><span class="sxs-lookup"><span data-stu-id="02e4d-111">In addition to Edit and Delete buttons, the DataList and Repeater controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="02e4d-112">在本教學課程中，我們會建置會使用中繼器列出系統中的類別介面。</span><span class="sxs-lookup"><span data-stu-id="02e4d-112">In this tutorial we'll build an interface that uses a Repeater to list the categories in the system.</span></span> <span data-ttu-id="02e4d-113">為每個類別目錄，中繼器將包含按鈕以顯示類別目錄相關聯產品使用 BulletedList 控制項 （請參閱圖 1）。</span><span class="sxs-lookup"><span data-stu-id="02e4d-113">For each category, the Repeater will include a button to show the category s associated products using a BulletedList control (see Figure 1).</span></span>


<span data-ttu-id="02e4d-114">[![按一下 顯示產品連結會顯示在項目符號清單中的類別目錄的產品](custom-buttons-in-the-datalist-and-repeater-vb/_static/image2.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="02e4d-114">[![Clicking the Show Products Link Displays the Category s Products in a Bulleted List](custom-buttons-in-the-datalist-and-repeater-vb/_static/image2.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image1.png)</span></span>

<span data-ttu-id="02e4d-115">**圖 1**： 按一下 顯示產品連結會顯示項目符號清單中的 s 產品類別目錄 ([按一下以檢視完整大小的影像](custom-buttons-in-the-datalist-and-repeater-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="02e4d-115">**Figure 1**: Clicking the Show Products Link Displays the Category s Products in a Bulleted List ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-vb/_static/image3.png))</span></span>


## <a name="step-1-adding-the-custom-button-tutorial-web-pages"></a><span data-ttu-id="02e4d-116">步驟 1： 加入自訂按鈕的教學課程 Web 網頁</span><span class="sxs-lookup"><span data-stu-id="02e4d-116">Step 1: Adding the Custom Button Tutorial Web Pages</span></span>

<span data-ttu-id="02e4d-117">我們會審視如何新增自訂按鈕之前，可讓 s 先花點時間在我們的網站專案，我們需要在此教學課程中建立 ASP.NET 網頁。</span><span class="sxs-lookup"><span data-stu-id="02e4d-117">Before we look at how to add a custom button, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="02e4d-118">加入新的資料夾，名為啟動`CustomButtonsDataListRepeater`。</span><span class="sxs-lookup"><span data-stu-id="02e4d-118">Start by adding a new folder named `CustomButtonsDataListRepeater`.</span></span> <span data-ttu-id="02e4d-119">接下來，將下列兩個 ASP.NET 網頁新增至該資料夾中，務必要建立關聯的每一頁`Site.master`主版頁面：</span><span class="sxs-lookup"><span data-stu-id="02e4d-119">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`


![如需自訂的按鈕相關教學課程中加入 ASP.NET 網頁](custom-buttons-in-the-datalist-and-repeater-vb/_static/image4.png)

<span data-ttu-id="02e4d-121">**圖 2**： 加入 ASP.NET 網頁的自訂按鈕相關教學課程</span><span class="sxs-lookup"><span data-stu-id="02e4d-121">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>


<span data-ttu-id="02e4d-122">如同在其他資料夾，`Default.aspx`中`CustomButtonsDataListRepeater`資料夾會列出這些教學課程 > 一節中。</span><span class="sxs-lookup"><span data-stu-id="02e4d-122">Like in the other folders, `Default.aspx` in the `CustomButtonsDataListRepeater` folder will list the tutorials in its section.</span></span> <span data-ttu-id="02e4d-123">請記得，`SectionLevelTutorialListing.ascx`使用者控制項提供這項功能。</span><span class="sxs-lookup"><span data-stu-id="02e4d-123">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="02e4d-124">將此使用者控制項加入`Default.aspx`拖曳到頁面的設計 檢視中的 方案總管 中。</span><span class="sxs-lookup"><span data-stu-id="02e4d-124">Add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="02e4d-125">[![將 SectionLevelTutorialListing.ascx 使用者控制項加入至 Default.aspx](custom-buttons-in-the-datalist-and-repeater-vb/_static/image6.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="02e4d-125">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](custom-buttons-in-the-datalist-and-repeater-vb/_static/image6.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image5.png)</span></span>

<span data-ttu-id="02e4d-126">**圖 3**： 新增`SectionLevelTutorialListing.ascx`使用者控制項加入`Default.aspx`([按一下以檢視完整大小的影像](custom-buttons-in-the-datalist-and-repeater-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="02e4d-126">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-vb/_static/image7.png))</span></span>


<span data-ttu-id="02e4d-127">最後，將頁面加入做為項目至`Web.sitemap`檔案。</span><span class="sxs-lookup"><span data-stu-id="02e4d-127">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="02e4d-128">具體來說，加入下列標記之後的分頁和排序 DataList 與中繼器`<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="02e4d-128">Specifically, add the following markup after the Paging and Sorting with the DataList and Repeater `<siteMapNode>`:</span></span>


[!code-xml[Main](custom-buttons-in-the-datalist-and-repeater-vb/samples/sample1.xml)]

<span data-ttu-id="02e4d-129">在更新之後， `Web.sitemap`，花一點時間來檢視此教學課程網站，透過瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="02e4d-129">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="02e4d-130">在左側功能表現在包含編輯、 插入和刪除教學課程的項目。</span><span class="sxs-lookup"><span data-stu-id="02e4d-130">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![站台地圖現在包含之項目的自訂按鈕教學課程](custom-buttons-in-the-datalist-and-repeater-vb/_static/image8.png)

<span data-ttu-id="02e4d-132">**圖 4**： 網站導覽現在包含之項目的自訂按鈕教學課程</span><span class="sxs-lookup"><span data-stu-id="02e4d-132">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>


## <a name="step-2-adding-the-list-of-categories"></a><span data-ttu-id="02e4d-133">步驟 2： 加入類別目錄的清單</span><span class="sxs-lookup"><span data-stu-id="02e4d-133">Step 2: Adding the List of Categories</span></span>

<span data-ttu-id="02e4d-134">我們要建立列出所有類別，以及顯示的產品 LinkButton 中繼器本教學課程中，按一下時，會顯示相關的類別的產品項目符號清單中。</span><span class="sxs-lookup"><span data-stu-id="02e4d-134">For this tutorial we need to create a Repeater that lists all categories along with a Show Products LinkButton that, when clicked, displays the associated category s products in a bulleted list.</span></span> <span data-ttu-id="02e4d-135">可讓第一次建立類別目錄會列出系統中的簡單中繼器 s。</span><span class="sxs-lookup"><span data-stu-id="02e4d-135">Let s first create a simple Repeater that lists the categories in the system.</span></span> <span data-ttu-id="02e4d-136">先開啟`CustomButtons.aspx`頁面`CustomButtonsDataListRepeater`資料夾。</span><span class="sxs-lookup"><span data-stu-id="02e4d-136">Start by opening the `CustomButtons.aspx` page in the `CustomButtonsDataListRepeater` folder.</span></span> <span data-ttu-id="02e4d-137">從工具箱拖曳至設計工具和設定拖曳中繼器其`ID`屬性`Categories`。</span><span class="sxs-lookup"><span data-stu-id="02e4d-137">Drag a Repeater from the Toolbox onto the Designer and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="02e4d-138">接下來，建立新的資料來源控制項從中繼器 s 智慧標籤。</span><span class="sxs-lookup"><span data-stu-id="02e4d-138">Next, create a new data source control from the Repeater s smart tag.</span></span> <span data-ttu-id="02e4d-139">具體而言，建立新的 ObjectDataSource 控制項，名為`CategoriesDataSource`選取其資料從`CategoriesBLL`類別的`GetCategories()`方法。</span><span class="sxs-lookup"><span data-stu-id="02e4d-139">Specifically, create a new ObjectDataSource control named `CategoriesDataSource` that selects its data from the `CategoriesBLL` class s `GetCategories()` method.</span></span>


<span data-ttu-id="02e4d-140">[![設定為使用 CategoriesBLL 類別的 GetCategories() 方法 ObjectDataSource](custom-buttons-in-the-datalist-and-repeater-vb/_static/image10.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="02e4d-140">[![Configure the ObjectDataSource to Use the CategoriesBLL Class s GetCategories() Method](custom-buttons-in-the-datalist-and-repeater-vb/_static/image10.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image9.png)</span></span>

<span data-ttu-id="02e4d-141">**圖 5**： 設定要使用 ObjectDataSource`CategoriesBLL`類別 s`GetCategories()`方法 ([按一下以檢視完整大小的影像](custom-buttons-in-the-datalist-and-repeater-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="02e4d-141">**Figure 5**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class s `GetCategories()` Method ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-vb/_static/image11.png))</span></span>


<span data-ttu-id="02e4d-142">DataList 控制項，Visual Studio 會建立預設值與`ItemTemplate`根據資料來源，s 中繼器範本必須以手動方式定義。</span><span class="sxs-lookup"><span data-stu-id="02e4d-142">Unlike the DataList control, for which Visual Studio creates a default `ItemTemplate` based on the data source, the Repeater s templates must be manually defined.</span></span> <span data-ttu-id="02e4d-143">此外，s 中繼器範本必須進行建立或編輯以宣告方式 （也就是沒有 s 沒有編輯的範本選項在中繼器 s 智慧標籤）。</span><span class="sxs-lookup"><span data-stu-id="02e4d-143">Furthermore, the Repeater s templates must be created and edited declaratively (that is, there s no Edit Templates option in the Repeater s smart tag).</span></span>

<span data-ttu-id="02e4d-144">按一下左上角的 [來源] 索引標籤上，新增`ItemTemplate`顯示中的類別目錄的名稱`<h3>`項目和其描述在段落標記，包括`SeparatorTemplate`顯示水平尺規 (`<hr />`) 之間類別目錄。</span><span class="sxs-lookup"><span data-stu-id="02e4d-144">Click on the Source tab in the bottom left corner and add an `ItemTemplate` that displays the category s name in an `<h3>` element and its description in a paragraph tag; include a `SeparatorTemplate` that displays a horizontal rule (`<hr />`) between each category.</span></span> <span data-ttu-id="02e4d-145">也新增 LinkButton 其`Text`屬性設定為顯示的產品。</span><span class="sxs-lookup"><span data-stu-id="02e4d-145">Also add a LinkButton with its `Text` property set to Show Products.</span></span> <span data-ttu-id="02e4d-146">完成這些步驟之後，頁面 s 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="02e4d-146">After completing these steps, your page s declarative markup should look like the following:</span></span>


[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-vb/samples/sample2.aspx)]

<span data-ttu-id="02e4d-147">圖 6 顯示透過瀏覽器檢視時的頁面。</span><span class="sxs-lookup"><span data-stu-id="02e4d-147">Figure 6 shows the page when viewed through a browser.</span></span> <span data-ttu-id="02e4d-148">會列出每個分類名稱和描述。</span><span class="sxs-lookup"><span data-stu-id="02e4d-148">Each category name and description is listed.</span></span> <span data-ttu-id="02e4d-149">顯示產品按鈕，按一下時，會導致回傳，但尚未執行任何動作。</span><span class="sxs-lookup"><span data-stu-id="02e4d-149">The Show Products button, when clicked, causes a postback but does not yet perform any action.</span></span>


<span data-ttu-id="02e4d-150">[![每個類別名稱和描述會顯示，並顯示產品 LinkButton](custom-buttons-in-the-datalist-and-repeater-vb/_static/image13.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="02e4d-150">[![Each Category s Name and Description is Displayed, Along with a Show Products LinkButton](custom-buttons-in-the-datalist-and-repeater-vb/_static/image13.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image12.png)</span></span>

<span data-ttu-id="02e4d-151">**圖 6**： 每個類別目錄名稱和描述會顯示，並顯示產品 LinkButton ([按一下以檢視完整大小的影像](custom-buttons-in-the-datalist-and-repeater-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="02e4d-151">**Figure 6**: Each Category s Name and Description is Displayed, Along with a Show Products LinkButton ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-vb/_static/image14.png))</span></span>


## <a name="step-3-executing-server-side-logic-when-the-show-products-linkbutton-is-clicked"></a><span data-ttu-id="02e4d-152">步驟 3： 執行伺服器端邏輯時顯示產品 LinkButton 已按下</span><span class="sxs-lookup"><span data-stu-id="02e4d-152">Step 3: Executing Server-Side Logic When the Show Products LinkButton is Clicked</span></span>

<span data-ttu-id="02e4d-153">每當按鈕、 LinkButton 或在 DataList 或中繼器範本內的 imagebutton 已按下時，就會發生回傳和 DataList 或中繼器的`ItemCommand`事件引發。</span><span class="sxs-lookup"><span data-stu-id="02e4d-153">Anytime a Button, LinkButton, or ImageButton within a template in a DataList or Repeater is clicked, a postback occurs and the DataList or Repeater s `ItemCommand` event fires.</span></span> <span data-ttu-id="02e4d-154">除了`ItemCommand`事件，控制項也可能會引發另一個、 更特定的事件，如果在 DataList 按鈕 s`CommandName`屬性設定為其中一個保留的字串 （刪除、 編輯、 取消、 更新或選取），但`ItemCommand`事件是*一律*引發。</span><span class="sxs-lookup"><span data-stu-id="02e4d-154">In addition to the `ItemCommand` event, the DataList control may also raise another, more specific event if the button s `CommandName` property is set to one of the reserved strings ( Delete, Edit, Cancel, Update, or Select ), but the `ItemCommand` event is *always* fired.</span></span>

<span data-ttu-id="02e4d-155">在 DataList 或中繼器中按一下按鈕時，有時候我們需要將傳遞的 button 已按下 （在案例中可能會有多個按鈕，在控制項內，例如兩個的編輯和刪除 按鈕） 和其他資訊 （例如主索引鍵值的 button 已按下的項目）。</span><span class="sxs-lookup"><span data-stu-id="02e4d-155">When a button is clicked within a DataList or Repeater, oftentimes we need to pass along which button was clicked (in the case that there may be multiple buttons within the control, such as both an Edit and Delete button) and perhaps some additional information (such as the primary key value of the item whose button was clicked).</span></span> <span data-ttu-id="02e4d-156">按鈕、 LinkButton 和 ImageButton 提供兩個屬性，其值會傳遞給`ItemCommand`事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="02e4d-156">The Button, LinkButton, and ImageButton provide two properties whose values are passed to the `ItemCommand` event handler:</span></span>

- <span data-ttu-id="02e4d-157">`CommandName`字串，通常用來識別每個範本中的按鈕</span><span class="sxs-lookup"><span data-stu-id="02e4d-157">`CommandName` a string typically used to identify each button in the template</span></span>
- <span data-ttu-id="02e4d-158">`CommandArgument`通常用來保留某些資料欄位，例如主索引鍵值的值</span><span class="sxs-lookup"><span data-stu-id="02e4d-158">`CommandArgument` commonly used to hold the value of some data field, such as the primary key value</span></span>

<span data-ttu-id="02e4d-159">這個範例中，將設定 LinkButton s`CommandName`屬性設為 ShowProducts 並繫結的目前記錄 s 主索引鍵值`CategoryID`至`CommandArgument`屬性使用的資料繫結語法`CategoryArgument='<%# Eval("CategoryID") %>'`。</span><span class="sxs-lookup"><span data-stu-id="02e4d-159">For this example, set the LinkButton s `CommandName` property to ShowProducts and bind the current record s primary key value `CategoryID` to the `CommandArgument` property using the databinding syntax `CategoryArgument='<%# Eval("CategoryID") %>'`.</span></span> <span data-ttu-id="02e4d-160">指定這兩個屬性之後, LinkButton s 宣告式語法看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="02e4d-160">After specifying these two properties, the LinkButton s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-vb/samples/sample3.aspx)]

<span data-ttu-id="02e4d-161">當按一下按鈕，就會發生回傳，DataList 或中繼器的`ItemCommand`事件引發。</span><span class="sxs-lookup"><span data-stu-id="02e4d-161">When the button is clicked, a postback occurs and the DataList or Repeater s `ItemCommand` event fires.</span></span> <span data-ttu-id="02e4d-162">此事件處理常式會傳遞按鈕 s`CommandName`和`CommandArgument`值。</span><span class="sxs-lookup"><span data-stu-id="02e4d-162">The event handler is passed the button s `CommandName` and `CommandArgument` values.</span></span>

<span data-ttu-id="02e4d-163">建立事件處理常式的中繼器 s`ItemCommand`事件，請注意第二個參數傳遞至事件處理常式 (名稱為`e`)。</span><span class="sxs-lookup"><span data-stu-id="02e4d-163">Create an event handler for the Repeater s `ItemCommand` event and note the second parameter passed into the event handler (named `e`).</span></span> <span data-ttu-id="02e4d-164">這個第二個參數的型別是[ `RepeaterCommandEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeatercommandeventargs.aspx)而且具有下列四個屬性：</span><span class="sxs-lookup"><span data-stu-id="02e4d-164">This second parameter is of type [`RepeaterCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeatercommandeventargs.aspx) and has the following four properties:</span></span>

- <span data-ttu-id="02e4d-165">`CommandArgument`按下按鈕的值`CommandArgument`屬性</span><span class="sxs-lookup"><span data-stu-id="02e4d-165">`CommandArgument` the value of the clicked button s `CommandArgument` property</span></span>
- <span data-ttu-id="02e4d-166">`CommandName`按鈕的值`CommandName`屬性</span><span class="sxs-lookup"><span data-stu-id="02e4d-166">`CommandName` the value of the button s `CommandName` property</span></span>
- <span data-ttu-id="02e4d-167">`CommandSource`已按下按鈕控制項的參考</span><span class="sxs-lookup"><span data-stu-id="02e4d-167">`CommandSource` a reference to the button control that was clicked</span></span>
- <span data-ttu-id="02e4d-168">`Item`若要參考[ `RepeaterItem` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem.aspx)包含已按下的按鈕; 繫結至中繼器每一筆記錄，會顯示為`RepeaterItem`</span><span class="sxs-lookup"><span data-stu-id="02e4d-168">`Item` a reference to the [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem.aspx) that contains the button that was clicked; each record bound to the Repeater is manifested as a `RepeaterItem`</span></span>

<span data-ttu-id="02e4d-169">因為選取的類別 s`CategoryID`透過傳入`CommandArgument`屬性，我們可以得到的選取類別目錄中相關聯的產品集`ItemCommand`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="02e4d-169">Since the selected category s `CategoryID` is passed in via the `CommandArgument` property, we can get the set of products associated with the selected category in the `ItemCommand` event handler.</span></span> <span data-ttu-id="02e4d-170">這些產品則會至設定 BulletedList 的控制項繫結`ItemTemplate`(哪些我們將尚未發生)。</span><span class="sxs-lookup"><span data-stu-id="02e4d-170">These products can then be bound to a BulletedList control in the `ItemTemplate` (which we ve yet to add).</span></span> <span data-ttu-id="02e4d-171">所有維持狀態，然後是加入 BulletedList，參考在`ItemCommand`事件處理常式，並繫結至其產品，我們將會處理在步驟 4 中所選取類別目錄的集合。</span><span class="sxs-lookup"><span data-stu-id="02e4d-171">All that remains, then, is to add the BulletedList, reference it in the `ItemCommand` event handler, and bind to it the set of products for the selected category, which we'll tackle in Step 4.</span></span>

> [!NOTE]
> <span data-ttu-id="02e4d-172">DataList s`ItemCommand`事件處理常式會傳遞類型的物件[ `DataListCommandEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistcommandeventargs.aspx)，提供相同的四個內容`RepeaterCommandEventArgs`類別。</span><span class="sxs-lookup"><span data-stu-id="02e4d-172">The DataList s `ItemCommand` event handler is passed an object of type [`DataListCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistcommandeventargs.aspx), which offers the same four properties as the `RepeaterCommandEventArgs` class.</span></span>


## <a name="step-4-displaying-the-selected-category-s-products-in-a-bulleted-list"></a><span data-ttu-id="02e4d-173">步驟 4： 在項目符號清單中顯示選取的類別的產品</span><span class="sxs-lookup"><span data-stu-id="02e4d-173">Step 4: Displaying the Selected Category s Products in a Bulleted List</span></span>

<span data-ttu-id="02e4d-174">選取的類別的產品可以顯示在中繼器的`ItemTemplate`使用任何數目的控制項。</span><span class="sxs-lookup"><span data-stu-id="02e4d-174">The selected category s products can be displayed within the Repeater s `ItemTemplate` using any number of controls.</span></span> <span data-ttu-id="02e4d-175">我們可以加入另一個巢狀中繼器、 DataList、 DropDownList、 GridView 中等等。</span><span class="sxs-lookup"><span data-stu-id="02e4d-175">We could add another nested Repeater, a DataList, a DropDownList, a GridView, and so on.</span></span> <span data-ttu-id="02e4d-176">因為我們想要為項目符號清單中顯示的產品，不過，我們會使用設定 BulletedList 控制項。</span><span class="sxs-lookup"><span data-stu-id="02e4d-176">Since we want to display the products as a bulleted list, though, we'll use the BulletedList control.</span></span> <span data-ttu-id="02e4d-177">返回`CustomButtons.aspx`頁面 s 宣告式標記中，將設定 BulletedList 控制項加入`ItemTemplate`之後顯示產品 LinkButton。</span><span class="sxs-lookup"><span data-stu-id="02e4d-177">Returning to the `CustomButtons.aspx` page s declarative markup, add a BulletedList control to the `ItemTemplate` after the Show Products LinkButton.</span></span> <span data-ttu-id="02e4d-178">設定 BulletedLists s`ID`至`ProductsInCategory`。</span><span class="sxs-lookup"><span data-stu-id="02e4d-178">Set the BulletedLists s `ID` to `ProductsInCategory`.</span></span> <span data-ttu-id="02e4d-179">BulletedList 顯示透過指定資料欄位的值`DataTextField`屬性; 因為此控制項能與它繫結，將產品資訊`DataTextField`屬性`ProductName`。</span><span class="sxs-lookup"><span data-stu-id="02e4d-179">The BulletedList displays the value of the data field specified via the `DataTextField` property; since this control will have product information bound to it, set the `DataTextField` property to `ProductName`.</span></span>


[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-vb/samples/sample4.aspx)]

<span data-ttu-id="02e4d-180">在`ItemCommand`事件處理常式，參考這個控制項使用`e.Item.FindControl("ProductsInCategory")`並將它繫結至選取的類別相關聯的產品集。</span><span class="sxs-lookup"><span data-stu-id="02e4d-180">In the `ItemCommand` event handler, reference this control using `e.Item.FindControl("ProductsInCategory")` and bind it to the set of products associated with the selected category.</span></span>


[!code-vb[Main](custom-buttons-in-the-datalist-and-repeater-vb/samples/sample5.vb)]

<span data-ttu-id="02e4d-181">然後再執行任何動作中的`ItemCommand`事件處理常式，它 s 審慎的作法是先檢查傳入的值`CommandName`。</span><span class="sxs-lookup"><span data-stu-id="02e4d-181">Before performing any action in the `ItemCommand` event handler, it s prudent to first check the value of the incoming `CommandName`.</span></span> <span data-ttu-id="02e4d-182">因為`ItemCommand`時引發事件處理常式*任何*按一下按鈕時，如果範本使用中有多個按鈕`CommandName`分辨要採取的動作值。</span><span class="sxs-lookup"><span data-stu-id="02e4d-182">Since the `ItemCommand` event handler fires when *any* button is clicked, if there are multiple buttons in the template use the `CommandName` value to discern what action to take.</span></span> <span data-ttu-id="02e4d-183">檢查`CommandName`以下是毫無意義，因為我們只需要單一按鈕，但它是個好習慣至表單。</span><span class="sxs-lookup"><span data-stu-id="02e4d-183">Checking the `CommandName` here is moot, since we only have a single button, but it is a good habit to form.</span></span> <span data-ttu-id="02e4d-184">下一步`CategoryID`所選類別擷取自`CommandArgument`屬性。</span><span class="sxs-lookup"><span data-stu-id="02e4d-184">Next, the `CategoryID` of the selected category is retrieved from the `CommandArgument` property.</span></span> <span data-ttu-id="02e4d-185">然後參考範本中的設定 BulletedList 控制項並繫結至結果的`ProductsBLL`類別的`GetProductsByCategoryID(categoryID)`方法。</span><span class="sxs-lookup"><span data-stu-id="02e4d-185">The BulletedList control in the template is then referenced and bound to the results of the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="02e4d-186">在這類的使用中 DataList，按鈕的上一個教學課程[概觀的編輯和刪除的資料在 DataList](../editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md)，我們判斷出指定的項目，透過主索引鍵值`DataKeys`集合。</span><span class="sxs-lookup"><span data-stu-id="02e4d-186">In previous tutorials that used the buttons within a DataList, such as [An Overview of Editing and Deleting Data in the DataList](../editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md), we determined the primary key value of a given item via the `DataKeys` collection.</span></span> <span data-ttu-id="02e4d-187">雖然這種方法適用於在 DataList，中繼器並沒有`DataKeys`屬性。</span><span class="sxs-lookup"><span data-stu-id="02e4d-187">While this approach works well with the DataList, the Repeater does not have a `DataKeys` property.</span></span> <span data-ttu-id="02e4d-188">相反地，我們必須使用另一個方法來提供這類的主索引鍵值，透過 [s] 按鈕`CommandArgument`屬性或藉由將主索引鍵值指派給隱藏標籤 Web 控制項範本內，並讀取其值在`ItemCommand`事件處理常式使用`e.Item.FindControl("LabelID")`。</span><span class="sxs-lookup"><span data-stu-id="02e4d-188">Instead, we must use an alternative approach for supplying the primary key value, such as through the button s `CommandArgument` property or by assigning the primary key value to a hidden Label Web control within the template and reading its value back in the `ItemCommand` event handler using `e.Item.FindControl("LabelID")`.</span></span>

<span data-ttu-id="02e4d-189">完成之後`ItemCommand`事件處理常式，請花一點時間測試的瀏覽器中的此頁面。</span><span class="sxs-lookup"><span data-stu-id="02e4d-189">After completing the `ItemCommand` event handler, take a moment to test out this page in a browser.</span></span> <span data-ttu-id="02e4d-190">如圖 7 所示，按一下顯示的產品連結導致回傳並設定 BulletedList 中顯示所選取類別目錄的產品。</span><span class="sxs-lookup"><span data-stu-id="02e4d-190">As Figure 7 shows, clicking the Show Products link causes a postback and displays the products for the selected category in a BulletedList.</span></span> <span data-ttu-id="02e4d-191">此外，請注意，就會維持這個產品資訊，即使按一下其他類別顯示的產品連結。</span><span class="sxs-lookup"><span data-stu-id="02e4d-191">Furthermore, note that this product information remains, even if other categories Show Products links are clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="02e4d-192">如果您想要修改這份報表的行為，使得只有一個類別目錄的產品列出一次，只要設定 BulletedList 控制項 s`EnableViewState`屬性`False`。</span><span class="sxs-lookup"><span data-stu-id="02e4d-192">If you want to modify the behavior of this report, such that the only one category s products are listed at a time, simply set the BulletedList control s `EnableViewState` property to `False`.</span></span>


<span data-ttu-id="02e4d-193">[![BulletedList 用來顯示選取的類別目錄的產品](custom-buttons-in-the-datalist-and-repeater-vb/_static/image16.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="02e4d-193">[![A BulletedList is used to Display the Products of the Selected Category](custom-buttons-in-the-datalist-and-repeater-vb/_static/image16.png)](custom-buttons-in-the-datalist-and-repeater-vb/_static/image15.png)</span></span>

<span data-ttu-id="02e4d-194">**圖 7**: BulletedList 用來顯示選取的類別目錄的產品 ([按一下以檢視完整大小的影像](custom-buttons-in-the-datalist-and-repeater-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="02e4d-194">**Figure 7**: A BulletedList is used to Display the Products of the Selected Category ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-vb/_static/image17.png))</span></span>


## <a name="summary"></a><span data-ttu-id="02e4d-195">總結</span><span class="sxs-lookup"><span data-stu-id="02e4d-195">Summary</span></span>

<span data-ttu-id="02e4d-196">DataList 和中繼器控制項可以包含任意數目的按鈕、 LinkButtons 或 ImageButtons 其範本中。</span><span class="sxs-lookup"><span data-stu-id="02e4d-196">The DataList and Repeater controls can include any number of Buttons, LinkButtons, or ImageButtons within their templates.</span></span> <span data-ttu-id="02e4d-197">這類的按鈕，按一下時，會導致回傳，並引發`ItemCommand`事件。</span><span class="sxs-lookup"><span data-stu-id="02e4d-197">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event.</span></span> <span data-ttu-id="02e4d-198">自訂伺服器端動作與在按下的按鈕，建立事件處理常式`ItemCommand`事件。</span><span class="sxs-lookup"><span data-stu-id="02e4d-198">To associate custom server-side action with a button being clicked, create an event handler for the `ItemCommand` event.</span></span> <span data-ttu-id="02e4d-199">在此事件處理常式先檢查傳入`CommandName`值，以判斷哪一個按鈕已按下。</span><span class="sxs-lookup"><span data-stu-id="02e4d-199">In this event handler first check the incoming `CommandName` value to determine which button was clicked.</span></span> <span data-ttu-id="02e4d-200">其他資訊 （選擇性） 可以透過 [s] 按鈕來提供`CommandArgument`屬性。</span><span class="sxs-lookup"><span data-stu-id="02e4d-200">Additional information can optionally be supplied through the button s `CommandArgument` property.</span></span>

<span data-ttu-id="02e4d-201">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="02e4d-201">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="02e4d-202">關於作者</span><span class="sxs-lookup"><span data-stu-id="02e4d-202">About the Author</span></span>

<span data-ttu-id="02e4d-203">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP/ASP.NET 書籍和的創辦[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已從 1998 年使用 Microsoft Web 技術。</span><span class="sxs-lookup"><span data-stu-id="02e4d-203">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="02e4d-204">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="02e4d-204">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="02e4d-205">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 2.0 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="02e4d-205">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="02e4d-206">他可以在達到[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或透過他的部落格，這可以在找到[http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="02e4d-206">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="02e4d-207">特別感謝</span><span class="sxs-lookup"><span data-stu-id="02e4d-207">Special Thanks To</span></span>

<span data-ttu-id="02e4d-208">許多有用的檢閱者已檢閱本教學課程系列。</span><span class="sxs-lookup"><span data-stu-id="02e4d-208">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="02e4d-209">在此教學課程的前導檢閱者已 Dennis Patterson。</span><span class="sxs-lookup"><span data-stu-id="02e4d-209">Lead reviewer for this tutorial was Dennis Patterson.</span></span> <span data-ttu-id="02e4d-210">檢閱我即將推出的 MSDN 文件有興趣嗎？</span><span class="sxs-lookup"><span data-stu-id="02e4d-210">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="02e4d-211">如果是這樣，卸除我一行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="02e4d-211">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="02e4d-212">上一步</span><span class="sxs-lookup"><span data-stu-id="02e4d-212">Previous</span></span>](custom-buttons-in-the-datalist-and-repeater-cs.md)
