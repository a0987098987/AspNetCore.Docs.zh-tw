---
uid: identity/overview/getting-started/introduction-to-aspnet-identity
title: ASP.NET Identity 簡介 |Microsoft Docs
author: jongalloway
description: ASP.NET 成員資格系統被引進與 ASP.NET 2.0 後，在 2005 中，而由於然後中已有許多的變更方式的 web 應用程式通常...
ms.author: riande
ms.date: 01/22/2019
ms.assetid: 38717fc1-5989-43cf-952d-4007cc1dd923
msc.legacyurl: /identity/overview/getting-started/introduction-to-aspnet-identity
msc.type: authoredcontent
ms.openlocfilehash: 4a545e52d2d9ea04a10c37c116fd326c60de9f8f
ms.sourcegitcommit: c47d7c131eebbcd8811e31edda210d64cf4b9d6b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/30/2019
ms.locfileid: "55236441"
---
<a name="introduction-to-aspnet-identity"></a><span data-ttu-id="65cf7-103">ASP.NET Identity 簡介</span><span class="sxs-lookup"><span data-stu-id="65cf7-103">Introduction to ASP.NET Identity</span></span>
====================

> <span data-ttu-id="65cf7-104">ASP.NET 成員資格系統被引進 ASP.NET 2.0 後在 2005 中，而由於則已有許多變更 web 應用程式通常會處理驗證和授權方式。</span><span class="sxs-lookup"><span data-stu-id="65cf7-104">The ASP.NET membership system was introduced with ASP.NET 2.0 back in 2005, and since then there have been many changes in the ways web applications typically handle authentication and authorization.</span></span> <span data-ttu-id="65cf7-105">ASP.NET 身分識別是成員資格系統應該是什麼當您在建立 web、 手機或平板電腦的現代化應用程式的全新觀點。</span><span class="sxs-lookup"><span data-stu-id="65cf7-105">ASP.NET Identity is a fresh look at what the membership system should be when you are building modern applications for the web, phone, or tablet.</span></span>


## <a name="background-membership-in-aspnet"></a><span data-ttu-id="65cf7-106">背景：在 ASP.NET 中的成員資格</span><span class="sxs-lookup"><span data-stu-id="65cf7-106">Background: Membership in ASP.NET</span></span>

### <a name="aspnet-membership"></a><span data-ttu-id="65cf7-107">ASP.NET 成員資格</span><span class="sxs-lookup"><span data-stu-id="65cf7-107">ASP.NET Membership</span></span>

<span data-ttu-id="65cf7-108">[ASP.NET 成員資格](https://msdn.microsoft.com/library/yh26yfzy(v=VS.100).aspx)用來解決常用的 2005，因為它牽涉到表單驗證，以及使用者名稱、 密碼和設定檔資料的 SQL Server 資料庫的站台成員資格需求。</span><span class="sxs-lookup"><span data-stu-id="65cf7-108">[ASP.NET Membership](https://msdn.microsoft.com/library/yh26yfzy(v=VS.100).aspx) was designed to solve site membership requirements that were common in 2005, which involved Forms Authentication, and a SQL Server database for user names, passwords, and profile data.</span></span> <span data-ttu-id="65cf7-109">目前沒有更廣泛的 web 應用程式，資料儲存體選項，而且大部分的開發人員想要啟用自己的網站使用社交識別提供者驗證和授權功能。</span><span class="sxs-lookup"><span data-stu-id="65cf7-109">Today there is a much broader array of data storage options for web applications, and most developers want to enable their sites to use social identity providers for authentication and authorization functionality.</span></span> <span data-ttu-id="65cf7-110">ASP.NET 成員資格的設計限制進行這項轉換不容易：</span><span class="sxs-lookup"><span data-stu-id="65cf7-110">The limitations of ASP.NET Membership's design make this transition difficult:</span></span>

- <span data-ttu-id="65cf7-111">資料庫結構描述專為 SQL Server，您無法變更它。</span><span class="sxs-lookup"><span data-stu-id="65cf7-111">The database schema was designed for SQL Server and you can't change it.</span></span> <span data-ttu-id="65cf7-112">您可以新增設定檔資訊，但其他的資料封裝至不同的資料表，很難存取的設定檔提供者 API 透過任何方式除外。</span><span class="sxs-lookup"><span data-stu-id="65cf7-112">You can add profile information, but the additional data is packed into a different table, which makes it difficult to access by any means except through the Profile Provider API.</span></span>
- <span data-ttu-id="65cf7-113">提供者系統可讓您變更 支援的資料存放區，但系統針對假設適用於關聯式資料庫設計。</span><span class="sxs-lookup"><span data-stu-id="65cf7-113">The provider system enables you to change the backing data store, but the system is designed around assumptions appropriate for a relational database.</span></span> <span data-ttu-id="65cf7-114">您可以撰寫的提供者，將成員資格資訊儲存在非關聯式儲存體機制，例如 Azure 儲存體資料表，但是，您必須解決關聯式的設計，撰寫太多程式碼和許多`System.NotImplementedException`不的方法的例外狀況適用於 NoSQL 資料庫。</span><span class="sxs-lookup"><span data-stu-id="65cf7-114">You can write a provider to store membership information in a non-relational storage mechanism, such as Azure Storage Tables, but then you have to work around the relational design by writing much code and a lot of `System.NotImplementedException` exceptions for methods that don't apply to NoSQL databases.</span></span>
- <span data-ttu-id="65cf7-115">由於記錄輸入/記錄檔外的功能根據表單驗證，不能使用成員資格系統[OWIN](../../../aspnet/overview/owin-and-katana/an-overview-of-project-katana.md)。</span><span class="sxs-lookup"><span data-stu-id="65cf7-115">Since the log-in/log-out functionality is based on Forms Authentication, the membership system can't use [OWIN](../../../aspnet/overview/owin-and-katana/an-overview-of-project-katana.md).</span></span> <span data-ttu-id="65cf7-116">OWIN 包含中介軟體元件進行驗證，包括支援登入使用外部識別提供者 （例如 Microsoft 帳戶、 Facebook、 Google、 Twitter)，並登入使用組織帳戶，從內部部署 Active Directory 或Azure Active Directory。</span><span class="sxs-lookup"><span data-stu-id="65cf7-116">OWIN includes middleware components for authentication, including support for log-ins using external identity providers (like Microsoft Accounts, Facebook, Google, Twitter), and log-ins using organizational accounts from on-premises Active Directory or Azure Active Directory.</span></span> <span data-ttu-id="65cf7-117">OWIN 也包含對 OAuth 2.0 JWT，CORS 支援。</span><span class="sxs-lookup"><span data-stu-id="65cf7-117">OWIN also includes support for OAuth 2.0, JWT and CORS.</span></span>

### <a name="aspnet-simple-membership"></a><span data-ttu-id="65cf7-118">ASP.NET 簡易成員資格</span><span class="sxs-lookup"><span data-stu-id="65cf7-118">ASP.NET Simple Membership</span></span>

<span data-ttu-id="65cf7-119">[ASP.NET 簡易成員資格](../../../web-pages/overview/security/16-adding-security-and-membership.md)ASP.NET Web Pages 做為成員資格系統所開發。</span><span class="sxs-lookup"><span data-stu-id="65cf7-119">[ASP.NET simple membership](../../../web-pages/overview/security/16-adding-security-and-membership.md) was developed as a membership system for ASP.NET Web Pages.</span></span> <span data-ttu-id="65cf7-120">使用 WebMatrix 和 Visual Studio 2010 SP1 釋出。</span><span class="sxs-lookup"><span data-stu-id="65cf7-120">It was released with WebMatrix and Visual Studio 2010 SP1.</span></span> <span data-ttu-id="65cf7-121">簡單成員資格的目標是要讓您輕鬆將成員資格功能加入網頁應用程式。</span><span class="sxs-lookup"><span data-stu-id="65cf7-121">The goal of Simple Membership was to make it easy to add membership functionality to a Web Pages application.</span></span>

<span data-ttu-id="65cf7-122">簡單成員資格未讓您更輕鬆地自訂使用者設定檔資訊，但它仍共用其他問題與 ASP.NET 成員資格，而且具有一些限制：</span><span class="sxs-lookup"><span data-stu-id="65cf7-122">Simple Membership did make it easier to customize user profile information, but it still shares the other problems with ASP.NET Membership, and it has some limitations:</span></span>

- <span data-ttu-id="65cf7-123">真的很難保存非關聯式存放區中的成員資格系統資料。</span><span class="sxs-lookup"><span data-stu-id="65cf7-123">It was hard to persist membership system data in a non-relational store.</span></span>
- <span data-ttu-id="65cf7-124">您無法搭配 OWIN 使用它。</span><span class="sxs-lookup"><span data-stu-id="65cf7-124">You can't use it with OWIN.</span></span>
- <span data-ttu-id="65cf7-125">它不適用於現有的 ASP.NET 成員資格提供者，而且無法擴充。</span><span class="sxs-lookup"><span data-stu-id="65cf7-125">It doesn't work well with existing ASP.NET Membership providers, and it's not extensible.</span></span>

### <a name="aspnet-universal-providers"></a><span data-ttu-id="65cf7-126">ASP.NET Universal Providers</span><span class="sxs-lookup"><span data-stu-id="65cf7-126">ASP.NET Universal Providers</span></span>

<span data-ttu-id="65cf7-127">[ASP.NET Universal Providers](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx)所開發，讓保存 Azure SQL Database，而且它們也適用於 SQL Server Compact 在 Microsoft 中的成員資格資訊。</span><span class="sxs-lookup"><span data-stu-id="65cf7-127">[ASP.NET Universal Providers](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx) were developed to make it possible to persist membership information in Microsoft Azure SQL Database, and they also work with SQL Server Compact.</span></span> <span data-ttu-id="65cf7-128">通用的提供者已根據 Entity Framework Code First，這表示通用提供者可用來保存任何 EF 所支援的存放區中的資料。</span><span class="sxs-lookup"><span data-stu-id="65cf7-128">The Universal Providers were built on Entity Framework Code First, which means that the Universal Providers can be used to persist data in any store supported by EF.</span></span> <span data-ttu-id="65cf7-129">通用提供者中，資料庫結構描述已清除也頗大的數目。</span><span class="sxs-lookup"><span data-stu-id="65cf7-129">With the Universal Providers, the database schema was cleaned up quite a lot as well.</span></span>

<span data-ttu-id="65cf7-130">Universal Providers ASP.NET 成員資格基礎結構之上，因此它們仍會帶 SqlMembership 提供者相同的限制。</span><span class="sxs-lookup"><span data-stu-id="65cf7-130">The Universal Providers are built on the ASP.NET Membership infrastructure, so they still carry the same limitations as the SqlMembership Provider.</span></span> <span data-ttu-id="65cf7-131">也就是說，會依照針對關聯式資料庫設計，而且很難自訂設定檔和使用者的資訊。</span><span class="sxs-lookup"><span data-stu-id="65cf7-131">That is, they were designed for relational databases and it's hard to customize profile and user information.</span></span> <span data-ttu-id="65cf7-132">這些提供者也依然使用表單驗證登入和登出的功能。</span><span class="sxs-lookup"><span data-stu-id="65cf7-132">These providers also still use Forms Authentication for sign-in and sign-out functionality.</span></span>

## <a name="aspnet-identity"></a><span data-ttu-id="65cf7-133">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="65cf7-133">ASP.NET Identity</span></span>

<span data-ttu-id="65cf7-134">成員資格的方式在 ASP.NET 中的劇本已發展多年來，來自客戶的意見回應的 「 ASP.NET 團隊有獲益良多。</span><span class="sxs-lookup"><span data-stu-id="65cf7-134">As the membership story in ASP.NET has evolved over the years, the ASP.NET team has learned a lot from feedback from customers.</span></span>

<span data-ttu-id="65cf7-135">前提是使用者會輸入登入的使用者名稱和已註冊您自己的應用程式中的密碼不再有效。</span><span class="sxs-lookup"><span data-stu-id="65cf7-135">The assumption that users will sign in by entering a user name and password that they have registered in your own application is no longer valid.</span></span> <span data-ttu-id="65cf7-136">Web 已經成為其他社交。</span><span class="sxs-lookup"><span data-stu-id="65cf7-136">The web has become more social.</span></span> <span data-ttu-id="65cf7-137">使用者透過社交管道，例如 Facebook、 Twitter 和其他社交網站的即時與彼此互動。</span><span class="sxs-lookup"><span data-stu-id="65cf7-137">Users are interacting with each other in real time through social channels such as Facebook, Twitter, and other social web sites.</span></span> <span data-ttu-id="65cf7-138">開發人員想要讓使用者能夠使用其社交身分識別登入，以便它們可以在其於網站上有豐富的體驗。</span><span class="sxs-lookup"><span data-stu-id="65cf7-138">Developers want users to be able to sign in with their social identities so that they can have a rich experience on their web sites.</span></span> <span data-ttu-id="65cf7-139">現代的成員資格系統必須啟用重新導向以登入來驗證提供者，例如 Facebook、 Twitter 和其他項目。</span><span class="sxs-lookup"><span data-stu-id="65cf7-139">A modern membership system must enable redirection-based log-ins to authentication providers such as Facebook, Twitter, and others.</span></span>

<span data-ttu-id="65cf7-140">為 web 開發演變，因此未 web 開發的模式。</span><span class="sxs-lookup"><span data-stu-id="65cf7-140">As web development evolved, so did the patterns of web development.</span></span> <span data-ttu-id="65cf7-141">單元測試的應用程式程式碼成為應用程式開發人員的核心考量。</span><span class="sxs-lookup"><span data-stu-id="65cf7-141">Unit testing of application code became a core concern for application developers.</span></span> <span data-ttu-id="65cf7-142">在 2008 ASP.NET 會新增模型-檢視-控制器 (MVC) 模式，部分可協助開發人員建置單元測試的 ASP.NET 應用程式為基礎的新架構。</span><span class="sxs-lookup"><span data-stu-id="65cf7-142">In 2008 ASP.NET added a new framework based on the Model-View-Controller (MVC) pattern, in part to help developers build unit testable ASP.NET applications.</span></span> <span data-ttu-id="65cf7-143">開發人員需要單元測試應用程式邏輯也希望能利用成員資格系統。</span><span class="sxs-lookup"><span data-stu-id="65cf7-143">Developers who wanted to unit test their application logic also wanted to be able to do that with the membership system.</span></span>

<span data-ttu-id="65cf7-144">考慮這些變更的 web 應用程式開發中，ASP.NET 身分識別開發人員在開發下列目標：</span><span class="sxs-lookup"><span data-stu-id="65cf7-144">Considering these changes in web application development, ASP.NET Identity was developed with the following goals:</span></span>

- <span data-ttu-id="65cf7-145">**一個 ASP.NET 身分識別系統**</span><span class="sxs-lookup"><span data-stu-id="65cf7-145">**One ASP.NET Identity system**</span></span>

    - <span data-ttu-id="65cf7-146">可以與所有的 ASP.NET 架構，例如 ASP.NET MVC、 Web Form、 Web 頁面、 Web API，以及 SignalR 使用 ASP.NET 身分識別。</span><span class="sxs-lookup"><span data-stu-id="65cf7-146">ASP.NET Identity can be used with all of the ASP.NET frameworks, such as ASP.NET MVC, Web Forms, Web Pages, Web API, and SignalR.</span></span>
    - <span data-ttu-id="65cf7-147">當您在建立 web、 電話、 存放區或混合式應用程式，可以使用 ASP.NET 身分識別。</span><span class="sxs-lookup"><span data-stu-id="65cf7-147">ASP.NET Identity can be used when you are building web, phone, store, or hybrid applications.</span></span>
- <span data-ttu-id="65cf7-148">**簡易的插入使用者相關的設定檔資料**</span><span class="sxs-lookup"><span data-stu-id="65cf7-148">**Ease of plugging in profile data about the user**</span></span>

    - <span data-ttu-id="65cf7-149">您可以控制使用者與設定檔資訊的結構描述。</span><span class="sxs-lookup"><span data-stu-id="65cf7-149">You have control over the schema of user and profile information.</span></span> <span data-ttu-id="65cf7-150">比方說，您可以輕鬆地啟用系統所儲存的應用程式中註冊帳戶時，輸入使用者的出生日期。</span><span class="sxs-lookup"><span data-stu-id="65cf7-150">For example, you can easily enable the system to store birth dates entered by users when they register an account in your application.</span></span>

- <span data-ttu-id="65cf7-151">**持續性控制項**</span><span class="sxs-lookup"><span data-stu-id="65cf7-151">**Persistence control**</span></span>

    - <span data-ttu-id="65cf7-152">根據預設，ASP.NET 身分識別系統會將所有的使用者資訊儲存在資料庫中。</span><span class="sxs-lookup"><span data-stu-id="65cf7-152">By default, the ASP.NET Identity system stores all the user information in a database.</span></span> <span data-ttu-id="65cf7-153">ASP.NET 身分識別會使用 Entity Framework Code First 來實作所有持續性機制。</span><span class="sxs-lookup"><span data-stu-id="65cf7-153">ASP.NET Identity uses Entity Framework Code First to implement all of its persistence mechanism.</span></span>
    - <span data-ttu-id="65cf7-154">由於您控制的資料庫結構描述、 常見的工作，例如變更資料表名稱或變更主索引鍵的資料型別很容易做到。</span><span class="sxs-lookup"><span data-stu-id="65cf7-154">Since you control the database schema, common tasks such as changing table names or changing the data type of primary keys is simple to do.</span></span>
    - <span data-ttu-id="65cf7-155">很容易插入不同的儲存機制，例如 SharePoint、 Azure 儲存體表格服務、 NoSQL 資料庫 」 等，而不需擲回`System.NotImplementedExceptions`例外狀況。</span><span class="sxs-lookup"><span data-stu-id="65cf7-155">It's easy to plug in different storage mechanisms such as SharePoint, Azure Storage Table Service, NoSQL databases, etc., without having to throw `System.NotImplementedExceptions` exceptions.</span></span>
- <span data-ttu-id="65cf7-156">**單元測試**</span><span class="sxs-lookup"><span data-stu-id="65cf7-156">**Unit testability**</span></span>

    - <span data-ttu-id="65cf7-157">ASP.NET 身分識別可讓 web 應用程式更多單元測試。</span><span class="sxs-lookup"><span data-stu-id="65cf7-157">ASP.NET Identity makes the web application more unit testable.</span></span> <span data-ttu-id="65cf7-158">您可以撰寫單元測試，您的應用程式使用 ASP.NET 身分識別的組件。</span><span class="sxs-lookup"><span data-stu-id="65cf7-158">You can write unit tests for the parts of your application that use ASP.NET Identity.</span></span>
- <span data-ttu-id="65cf7-159">**角色提供者**</span><span class="sxs-lookup"><span data-stu-id="65cf7-159">**Role provider**</span></span>

    - <span data-ttu-id="65cf7-160">沒有角色提供者可讓您限制對您的應用程式的組件的角色存取。</span><span class="sxs-lookup"><span data-stu-id="65cf7-160">There is a role provider which lets you restrict access to parts of your application by roles.</span></span> <span data-ttu-id="65cf7-161">您可以輕鬆地建立角色，例如"Admin"，並將使用者新增至角色。</span><span class="sxs-lookup"><span data-stu-id="65cf7-161">You can easily create roles such as "Admin" and add users to roles.</span></span>
- <span data-ttu-id="65cf7-162">**宣告式**</span><span class="sxs-lookup"><span data-stu-id="65cf7-162">**Claims Based**</span></span>

    - <span data-ttu-id="65cf7-163">ASP.NET 身分識別支援宣告式的驗證，而使用者的身分識別都代表一組宣告。</span><span class="sxs-lookup"><span data-stu-id="65cf7-163">ASP.NET Identity supports claims-based authentication, where the user's identity is represented as a set of claims.</span></span> <span data-ttu-id="65cf7-164">宣告讓開發人員可在描述使用者的身分識別，比角色，可讓更多易懂。</span><span class="sxs-lookup"><span data-stu-id="65cf7-164">Claims allow developers to be a lot more expressive in describing a user's identity than roles allow.</span></span> <span data-ttu-id="65cf7-165">角色成員資格是只是布林值 （成員或非成員），而宣告可以包含使用者的身分識別與成員資格的豐富資訊。</span><span class="sxs-lookup"><span data-stu-id="65cf7-165">Whereas role membership is just a boolean (member or non-member), a claim can include rich information about the user's identity and membership.</span></span>
- <span data-ttu-id="65cf7-166">**社交登入提供者**</span><span class="sxs-lookup"><span data-stu-id="65cf7-166">**Social Login Providers**</span></span>

    - <span data-ttu-id="65cf7-167">可以輕鬆地將社交登入等的 Microsoft 帳戶、 Facebook、 Twitter、 Google 和其他人新增至您的應用程式，並將使用者專屬資料儲存在您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="65cf7-167">You can easily add social log-ins such as Microsoft Account, Facebook, Twitter, Google, and others to your application, and store the user-specific data in your application.</span></span>

- <span data-ttu-id="65cf7-168">**OWIN 整合**</span><span class="sxs-lookup"><span data-stu-id="65cf7-168">**OWIN Integration**</span></span>

    - <span data-ttu-id="65cf7-169">ASP.NET 驗證現在根據可用在以 OWIN 為基礎的任何主機的 OWIN 中介軟體。</span><span class="sxs-lookup"><span data-stu-id="65cf7-169">ASP.NET authentication is now based on OWIN middleware that can be used on any OWIN-based host.</span></span> <span data-ttu-id="65cf7-170">在 System.Web，ASP.NET 身分識別並沒有任何相依性。</span><span class="sxs-lookup"><span data-stu-id="65cf7-170">ASP.NET Identity does not have any dependency on System.Web.</span></span> <span data-ttu-id="65cf7-171">它是完全相容的 OWIN 架構，並可以用於任何裝載的 OWIN 應用程式。</span><span class="sxs-lookup"><span data-stu-id="65cf7-171">It is a fully compliant OWIN framework and can be used in any OWIN hosted application.</span></span>
    - <span data-ttu-id="65cf7-172">ASP.NET Identity 中/記錄檔-登出的使用者在網站上使用 OWIN 驗證。</span><span class="sxs-lookup"><span data-stu-id="65cf7-172">ASP.NET Identity uses OWIN Authentication for log-in/log-out of users in the web site.</span></span> <span data-ttu-id="65cf7-173">這表示，而不是使用 FormsAuthentication 產生 cookie，應用程式使用 OWIN CookieAuthentication 若要這麼做。</span><span class="sxs-lookup"><span data-stu-id="65cf7-173">This means that instead of using FormsAuthentication to generate the cookie, the application uses OWIN CookieAuthentication to do that.</span></span>
- <span data-ttu-id="65cf7-174">**NuGet 套件**</span><span class="sxs-lookup"><span data-stu-id="65cf7-174">**NuGet package**</span></span>

    - <span data-ttu-id="65cf7-175">ASP.NET 身分識別，則會重新分配以 NuGet 套件安裝隨附於 Visual Studio 2017 的 ASP.NET MVC、 Web Form 和 Web API 範本中。</span><span class="sxs-lookup"><span data-stu-id="65cf7-175">ASP.NET Identity is redistributed as a NuGet package which is installed in the ASP.NET MVC, Web Forms and Web API templates that ship with Visual Studio 2017.</span></span> <span data-ttu-id="65cf7-176">您可以從 NuGet 資源庫下載這個 NuGet 封裝。</span><span class="sxs-lookup"><span data-stu-id="65cf7-176">You can download this NuGet package from the NuGet gallery.</span></span>
    - <span data-ttu-id="65cf7-177">釋出 ASP.NET 身分識別為 NuGet 套件可讓 ASP.NET 小組的新功能及 bug 修正，逐一查看，並以敏捷的方式提供這些開發人員更輕鬆。</span><span class="sxs-lookup"><span data-stu-id="65cf7-177">Releasing ASP.NET Identity as a NuGet package makes it easier for the ASP.NET team to iterate on new features and bug fixes, and deliver these to developers in an agile manner.</span></span>

## <a name="get-started-with-aspnet-identity"></a><span data-ttu-id="65cf7-178">開始使用 ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="65cf7-178">Get started with ASP.NET Identity</span></span>

<span data-ttu-id="65cf7-179">ASP.NET 身分識別可在 Visual Studio 2017 專案範本的 ASP.NET MVC、 Web Form、 Web API 和 SPA 之間。</span><span class="sxs-lookup"><span data-stu-id="65cf7-179">ASP.NET Identity is used in the Visual Studio 2017 project templates for ASP.NET MVC, Web Forms, Web API and SPA.</span></span> <span data-ttu-id="65cf7-180">在本逐步解說中，我們將說明的專案範本如何使用 ASP.NET 身分識別來將功能新增至註冊、 登入和登出使用者。</span><span class="sxs-lookup"><span data-stu-id="65cf7-180">In this walkthrough, we'll illustrate how the project templates use ASP.NET Identity to add functionality to register, sign in and sign out a user.</span></span>

<span data-ttu-id="65cf7-181">使用下列程序來實作 ASP.NET 身分識別。</span><span class="sxs-lookup"><span data-stu-id="65cf7-181">ASP.NET Identity is implemented using the following procedure.</span></span> <span data-ttu-id="65cf7-182">本文的目的是讓您的 ASP.NET 身分識別; 的高階概觀您可以遵循逐步或只是讀取的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="65cf7-182">The purpose of this article is to give you a high level overview of ASP.NET Identity; you can follow it step by step or just read the details.</span></span> <span data-ttu-id="65cf7-183">如需建立使用 ASP.NET 身分識別，包括新增使用者、 角色和設定檔資訊，請使用新的 API 應用程式的詳細指示，請參閱本文結尾 「 後續步驟 」 一節。</span><span class="sxs-lookup"><span data-stu-id="65cf7-183">For more detailed instructions on creating apps using ASP.NET Identity, including using the new API to add users, roles and profile information, see the Next Steps section at the end of this article.</span></span>

1. <span data-ttu-id="65cf7-184">建立 ASP.NET MVC 應用程式使用個別的帳戶。</span><span class="sxs-lookup"><span data-stu-id="65cf7-184">Create an ASP.NET MVC application with Individual Accounts.</span></span> <span data-ttu-id="65cf7-185">您可以使用 ASP.NET MVC、 Web Form、 Web API 等等 SignalR 的 ASP.NET 身分識別。在本文中，我們將開始使用 ASP.NET MVC 應用程式。</span><span class="sxs-lookup"><span data-stu-id="65cf7-185">You can use ASP.NET Identity in ASP.NET MVC, Web Forms, Web API, SignalR etc. In this article we will start with an ASP.NET MVC application.</span></span>  
  
    ![](introduction-to-aspnet-identity/_static/image1.png)
2. <span data-ttu-id="65cf7-186">建立的專案會包含下列三個封裝，ASP.NET 身分識別。</span><span class="sxs-lookup"><span data-stu-id="65cf7-186">The created project contains the following three packages for ASP.NET Identity.</span></span>

    - [`Microsoft.AspNet.Identity.EntityFramework`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.EntityFramework/)  
   <span data-ttu-id="65cf7-187">此套件有 Entity Framework 實作會將 ASP.NET Identity 的資料和 SQL server 的結構描述保存 ASP.NET 身分識別。</span><span class="sxs-lookup"><span data-stu-id="65cf7-187">This package has the Entity Framework implementation of ASP.NET Identity which will persist the ASP.NET Identity data and schema to SQL Server.</span></span>
    - [`Microsoft.AspNet.Identity.Core`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.Core/)  
   <span data-ttu-id="65cf7-188">此套件有 ASP.NET Identity 的核心介面。</span><span class="sxs-lookup"><span data-stu-id="65cf7-188">This package has the core interfaces for ASP.NET Identity.</span></span> <span data-ttu-id="65cf7-189">此套件可用來撰寫 ASP.NET 身分識別的目標不同的持續性儲存例如 Azure 資料表儲存體，NoSQL 資料庫等實作。</span><span class="sxs-lookup"><span data-stu-id="65cf7-189">This package can be used to write an implementation for ASP.NET Identity that targets different persistence stores such as Azure Table Storage, NoSQL databases etc.</span></span>
    - [`Microsoft.AspNet.Identity.OWIN`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.Owin/)  
   <span data-ttu-id="65cf7-190">此套件包含用來在 ASP.NET 應用程式中插入 OWIN 驗證中使用 ASP.NET Identity 的功能。</span><span class="sxs-lookup"><span data-stu-id="65cf7-190">This package contains functionality that is used to plug in OWIN authentication with ASP.NET Identity in ASP.NET applications.</span></span> <span data-ttu-id="65cf7-191">您將登功能新增至您的應用程式和呼叫 OWIN 的 Cookie 驗證中介軟體以產生 cookie 時，會使用這項目。</span><span class="sxs-lookup"><span data-stu-id="65cf7-191">This is used when you add sign in functionality to your application and call into OWIN Cookie Authentication middleware to generate a cookie.</span></span>
3. <span data-ttu-id="65cf7-192">建立使用者。</span><span class="sxs-lookup"><span data-stu-id="65cf7-192">Creating a user.</span></span>  
   <span data-ttu-id="65cf7-193">啟動應用程式，然後按一下**註冊**連結，以建立使用者。</span><span class="sxs-lookup"><span data-stu-id="65cf7-193">Launch the application and then click on the **Register** link to create a user.</span></span> <span data-ttu-id="65cf7-194">下圖顯示 [註冊] 頁面所收集的使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="65cf7-194">The following image shows the Register page that collects the user name and password.</span></span>  
  
    ![](introduction-to-aspnet-identity/_static/image2.png)  
  
   <span data-ttu-id="65cf7-195">當使用者選取**註冊** 按鈕，`Register`帳戶控制器的動作會建立使用者，方法是呼叫 ASP.NET 身分識別 API，以反白顯示如下：</span><span class="sxs-lookup"><span data-stu-id="65cf7-195">When the user selects the **Register** button, the `Register` action of the Account controller creates the user by calling the ASP.NET Identity API, as highlighted below:</span></span>

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample1.cs?highlight=8-9)]
4. <span data-ttu-id="65cf7-196">登入。</span><span class="sxs-lookup"><span data-stu-id="65cf7-196">Sign in.</span></span>  
   <span data-ttu-id="65cf7-197">如果已成功建立使用者，她會登入`SignInAsync`方法。</span><span class="sxs-lookup"><span data-stu-id="65cf7-197">If the user was successfully created, she is signed in by the `SignInAsync` method.</span></span>  

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample6.cs?highlight=12)]


   <span data-ttu-id="65cf7-198">`SignInManager.SignInAsync`方法會產生[ClaimsIdentity](https://msdn.microsoft.com/library/system.security.claims.claimsidentity.aspx)。</span><span class="sxs-lookup"><span data-stu-id="65cf7-198">The `SignInManager.SignInAsync` method generates a [ClaimsIdentity](https://msdn.microsoft.com/library/system.security.claims.claimsidentity.aspx).</span></span> <span data-ttu-id="65cf7-199">由於 ASP.NET 身分識別和 OWIN Cookie 驗證以宣告為基礎的系統，framework 就會需要應用程式來產生使用者的 ClaimsIdentity。</span><span class="sxs-lookup"><span data-stu-id="65cf7-199">Since ASP.NET Identity and OWIN Cookie Authentication are claims-based system, the framework requires the app to generate a ClaimsIdentity for the user.</span></span> <span data-ttu-id="65cf7-200">ClaimsIdentity 有使用者，例如使用者屬於何種角色的所有宣告的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="65cf7-200">ClaimsIdentity has information about all the claims for the user, such as what roles the user belongs to.</span></span>   
 
5. <span data-ttu-id="65cf7-201">登出。</span><span class="sxs-lookup"><span data-stu-id="65cf7-201">Log off.</span></span>  
   <span data-ttu-id="65cf7-202">選取 **登出**呼叫登出動作帳戶控制器中的連結。</span><span class="sxs-lookup"><span data-stu-id="65cf7-202">Select the **Log off** link to call the LogOff action in the account controller.</span></span> 

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample5.cs?highlight=6)]

   <span data-ttu-id="65cf7-203">反白顯示上述的程式碼顯示 OWIN`AuthenticationManager.SignOut`方法。</span><span class="sxs-lookup"><span data-stu-id="65cf7-203">The highlighted code above shows the OWIN `AuthenticationManager.SignOut` method.</span></span> <span data-ttu-id="65cf7-204">這相當於[FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx)所使用的方法[FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx)在 Web Form 中的模組。</span><span class="sxs-lookup"><span data-stu-id="65cf7-204">This is analogous to [FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) method used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module in Web Forms.</span></span>

## <a name="components-of-aspnet-identity"></a><span data-ttu-id="65cf7-205">ASP.NET 身分識別的元件</span><span class="sxs-lookup"><span data-stu-id="65cf7-205">Components of ASP.NET Identity</span></span>

<span data-ttu-id="65cf7-206">下圖顯示 ASP.NET 身分識別系統的元件 (上，選取[這](introduction-to-aspnet-identity/_static/image3.png)或將它放大圖表上)。</span><span class="sxs-lookup"><span data-stu-id="65cf7-206">The diagram below shows the components of the ASP.NET Identity system (select on [this](introduction-to-aspnet-identity/_static/image3.png) or on the diagram to enlarge it).</span></span> <span data-ttu-id="65cf7-207">以綠色的封裝是由 ASP.NET 身分識別系統所組成。</span><span class="sxs-lookup"><span data-stu-id="65cf7-207">The packages in green make up the ASP.NET Identity system.</span></span> <span data-ttu-id="65cf7-208">所有其他套件是使用 ASP.NET 身分識別系統在 ASP.NET 應用程式時所需的相依性。</span><span class="sxs-lookup"><span data-stu-id="65cf7-208">All the other packages are dependencies which are needed to use the ASP.NET Identity system in ASP.NET applications.</span></span>

[![](introduction-to-aspnet-identity/_static/image5.png)](introduction-to-aspnet-identity/_static/image4.png)

<span data-ttu-id="65cf7-209">以下是先前未提及的 NuGet 套件的簡短描述：</span><span class="sxs-lookup"><span data-stu-id="65cf7-209">The following is a brief description of the NuGet packages not mentioned previously:</span></span>

- [<span data-ttu-id="65cf7-210">Microsoft.Owin.Security.Cookies</span><span class="sxs-lookup"><span data-stu-id="65cf7-210">Microsoft.Owin.Security.Cookies</span></span>](http://www.nuget.org/packages/Microsoft.Owin.Security.Cookies/)  
 <span data-ttu-id="65cf7-211">中介軟體，可讓應用程式使用 cookie 型驗證，類似於 ASP。NET 的表單驗證。</span><span class="sxs-lookup"><span data-stu-id="65cf7-211">Middleware that enables an application to use cookie based authentication, similar to ASP.NET's Forms Authentication.</span></span>
- [<span data-ttu-id="65cf7-212">EntityFramework</span><span class="sxs-lookup"><span data-stu-id="65cf7-212">EntityFramework</span></span>](http://www.nuget.org/packages/EntityFramework/)  
 <span data-ttu-id="65cf7-213">Entity Framework 是 Microsoft 的關聯式資料庫的建議的資料存取技術。</span><span class="sxs-lookup"><span data-stu-id="65cf7-213">Entity Framework is Microsoft's recommended data access technology for relational databases.</span></span>

## <a name="migrating-from-membership-to-aspnet-identity"></a><span data-ttu-id="65cf7-214">從成員資格移轉至 ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="65cf7-214">Migrating from Membership to ASP.NET Identity</span></span>

<span data-ttu-id="65cf7-215">我們希望能很快就提供移轉您現有的應用程式到新的 ASP.NET 身分識別系統中使用 ASP.NET 成員資格或簡單的成員資格的指引。</span><span class="sxs-lookup"><span data-stu-id="65cf7-215">We hope to soon provide guidance on migrating your existing apps that use ASP.NET Membership or Simple Membership to the new ASP.NET Identity system.</span></span>

## <a name="next-steps"></a><span data-ttu-id="65cf7-216">後續步驟</span><span class="sxs-lookup"><span data-stu-id="65cf7-216">Next Steps</span></span>

- [<span data-ttu-id="65cf7-217">使用 Facebook 和 Google OAuth2 和 OpenID 登入建立 ASP.NET MVC 5 應用程式</span><span class="sxs-lookup"><span data-stu-id="65cf7-217">Create an ASP.NET MVC 5 App with Facebook and Google OAuth2 and OpenID Sign-on</span></span>](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md)  
 <span data-ttu-id="65cf7-218">教學課程會使用 ASP.NET 身分識別 API，以新增至使用者資料庫中，設定檔資訊及如何使用 Google 和 Facebook 進行驗證。</span><span class="sxs-lookup"><span data-stu-id="65cf7-218">The tutorial uses the ASP.NET Identity API to add profile information to the user database, and how to authenticate with Google and Facebook.</span></span>
- [<span data-ttu-id="65cf7-219">使用驗證和 SQL DB 建立 ASP.NET MVC 應用程式並部署至 Azure App Service</span><span class="sxs-lookup"><span data-stu-id="65cf7-219">Create an ASP.NET MVC app with auth and SQL DB and deploy to Azure App Service</span></span>](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data)  
 <span data-ttu-id="65cf7-220">本教學課程會示範如何使用身分識別 API 來新增使用者和角色。</span><span class="sxs-lookup"><span data-stu-id="65cf7-220">This tutorial shows how to use the Identity API to add users and roles.</span></span>
- [https://github.com/rustd/AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample)  
 <span data-ttu-id="65cf7-221">示範如何新增基本的角色和使用者支援，以及如何進行角色和使用者管理的範例應用程式。</span><span class="sxs-lookup"><span data-stu-id="65cf7-221">Sample application that shows how to add basic roles and user support and how to do roles and user management.</span></span>
