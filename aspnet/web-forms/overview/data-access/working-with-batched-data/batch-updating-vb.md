---
uid: web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
title: 批次更新 (VB) |Microsoft Docs
author: rick-anderson
description: 了解如何更新單一作業中的多個資料庫記錄。 在使用者介面層，我們會建置的 GridView，其中每個資料列都可以讓您編輯。 在資料...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: d191a204-d7ea-458d-b81c-0b9049ecb55f
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
msc.type: authoredcontent
ms.openlocfilehash: 76c475b67943b77d99630e087ed46fe6d5f11a03
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/16/2018
ms.locfileid: "41833199"
---
<a name="batch-updating-vb"></a><span data-ttu-id="94823-105">批次更新 (VB)</span><span class="sxs-lookup"><span data-stu-id="94823-105">Batch Updating (VB)</span></span>
====================
<span data-ttu-id="94823-106">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="94823-106">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="94823-107">[下載程式碼](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip)或[下載 PDF](batch-updating-vb/_static/datatutorial64vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="94823-107">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip) or [Download PDF](batch-updating-vb/_static/datatutorial64vb1.pdf)</span></span>

> <span data-ttu-id="94823-108">了解如何更新單一作業中的多個資料庫記錄。</span><span class="sxs-lookup"><span data-stu-id="94823-108">Learn how to update multiple database records in a single operation.</span></span> <span data-ttu-id="94823-109">在使用者介面層，我們會建置的 GridView，其中每個資料列都可以讓您編輯。</span><span class="sxs-lookup"><span data-stu-id="94823-109">In the User Interface Layer we build a GridView where each row is editable.</span></span> <span data-ttu-id="94823-110">資料存取層中，我們換行以確保所有的更新成功，或所有更新會都回復在交易內的多個更新作業的內容。</span><span class="sxs-lookup"><span data-stu-id="94823-110">In the Data Access Layer we wrap the multiple Update operations within a transaction to ensure that all updates succeed or all updates are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="94823-111">簡介</span><span class="sxs-lookup"><span data-stu-id="94823-111">Introduction</span></span>

<span data-ttu-id="94823-112">在 [前述教學課程](wrapping-database-modifications-within-a-transaction-vb.md)我們了解如何擴充資料的存取層，來新增的資料庫交易支援。</span><span class="sxs-lookup"><span data-stu-id="94823-112">In the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md) we saw how to extend the Data Access Layer to add support for database transactions.</span></span> <span data-ttu-id="94823-113">資料庫交易保證一系列的資料修改陳述式會被視為一個不可部分完成的作業，可確保所有修改將會都失敗，或所有將會成功。</span><span class="sxs-lookup"><span data-stu-id="94823-113">Database transactions guarantee that a series of data modification statements will be treated as one atomic operation, which ensures that all modifications will fail or all will succeed.</span></span> <span data-ttu-id="94823-114">有了這個低階 DAL 功能的方式，我們重新已準備好把焦點轉到建立批次資料修改介面。</span><span class="sxs-lookup"><span data-stu-id="94823-114">With this low-level DAL functionality out of the way, we re ready to turn our attention to creating batch data modification interfaces.</span></span>

<span data-ttu-id="94823-115">在本教學課程中，我們將建置的 GridView，其中每個資料列是可編輯 （請參閱 圖 1）。</span><span class="sxs-lookup"><span data-stu-id="94823-115">In this tutorial we'll build a GridView where each row is editable (see Figure 1).</span></span> <span data-ttu-id="94823-116">由於不需要編輯的資料行時，會在其編輯介面上，該處 s 呈現每個資料列，更新和 [取消] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="94823-116">Since each row is rendered in its editing interface, there s no need for a column of Edit, Update, and Cancel buttons.</span></span> <span data-ttu-id="94823-117">相反地，有兩個更新的產品按鈕在頁面上，按一下時，列舉的 GridView 資料列，並更新資料庫。</span><span class="sxs-lookup"><span data-stu-id="94823-117">Instead, there are two Update Products buttons on the page that, when clicked, enumerate the GridView rows and update the database.</span></span>


<span data-ttu-id="94823-118">[![在 gridview 裡的每個資料列是可編輯](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="94823-118">[![Each Row in the GridView is Editable](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span></span>

<span data-ttu-id="94823-119">**圖 1**： 在 gridview 裡的每個資料列是可編輯 ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="94823-119">**Figure 1**: Each Row in the GridView is Editable ([Click to view full-size image](batch-updating-vb/_static/image2.png))</span></span>


<span data-ttu-id="94823-120">讓 s 開始 ！</span><span class="sxs-lookup"><span data-stu-id="94823-120">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="94823-121">在 [執行批次更新](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md)教學課程中我們建立批次的編輯介面使用 DataList 控制項。</span><span class="sxs-lookup"><span data-stu-id="94823-121">In the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we created a batch editing interface using the DataList control.</span></span> <span data-ttu-id="94823-122">不同於先前的其中一個，會使用 GridView 的本教學課程中，批次執行更新時的交易範圍內。</span><span class="sxs-lookup"><span data-stu-id="94823-122">This tutorial differs from the previous one in that is uses a GridView and the batch update is performed within the scope of a transaction.</span></span> <span data-ttu-id="94823-123">完成本教學課程之後我鼓勵您返回先前的教學課程，並加以更新才能使用資料庫交易相關功能加入在先前的教學課程。</span><span class="sxs-lookup"><span data-stu-id="94823-123">After completing this tutorial I encourage you to return to the earlier tutorial and update it to use the database transaction-related functionality added in the preceding tutorial.</span></span>


## <a name="examining-the-steps-for-making-all-gridview-rows-editable"></a><span data-ttu-id="94823-124">檢查進行所有的 GridView 資料列的可編輯的步驟</span><span class="sxs-lookup"><span data-stu-id="94823-124">Examining the Steps for Making All GridView Rows Editable</span></span>

<span data-ttu-id="94823-125">中所述[概觀的插入、 更新和刪除資料](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)教學課程中，GridView 提供編輯每個資料列依其基礎資料的內建支援。</span><span class="sxs-lookup"><span data-stu-id="94823-125">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView offers built-in support for editing its underlying data on a per-row basis.</span></span> <span data-ttu-id="94823-126">就內部而言，GridView 資訊是透過可編輯的哪些資料列及其[`EditIndex`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx)。</span><span class="sxs-lookup"><span data-stu-id="94823-126">Internally, the GridView notes what row is editable through its [`EditIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span></span> <span data-ttu-id="94823-127">GridView 繫結至其資料來源，因為它會檢查每個資料列，以查看資料列的索引若等於值`EditIndex`。</span><span class="sxs-lookup"><span data-stu-id="94823-127">As the GridView is being bound to its data source, it checks each row to see if the index of the row equals the value of `EditIndex`.</span></span> <span data-ttu-id="94823-128">如果是的話，該資料列的欄位經轉譯之後使用其編輯介面。</span><span class="sxs-lookup"><span data-stu-id="94823-128">If so, that row s fields are rendered using their editing interfaces.</span></span> <span data-ttu-id="94823-129">編輯介面是文字方塊 BoundFields，其`Text`BoundField s 所指定的資料欄位的值指派給屬性`DataField`屬性。</span><span class="sxs-lookup"><span data-stu-id="94823-129">For BoundFields, the editing interface is a TextBox whose `Text` property is assigned the value of the data field specified by the BoundField s `DataField` property.</span></span> <span data-ttu-id="94823-130">TemplateFields，如`EditItemTemplate`用來取代`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="94823-130">For TemplateFields, the `EditItemTemplate` is used in place of the `ItemTemplate`.</span></span>

<span data-ttu-id="94823-131">您應該記得編輯工作流程會啟動，當使用者按一下資料列 s [編輯] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="94823-131">Recall that the editing workflow starts when a user clicks a row s Edit button.</span></span> <span data-ttu-id="94823-132">這會導致回傳，設定 GridView 的`EditIndex`屬性設為 s 的已按下 資料列索引，並重新繫結至方格的資料。</span><span class="sxs-lookup"><span data-stu-id="94823-132">This causes a postback, sets the GridView s `EditIndex` property to the clicked row s index, and rebinds the data to the grid.</span></span> <span data-ttu-id="94823-133">按一下資料列 s [取消] 按鈕的時，可在回傳`EditIndex`設定的值為`-1`重新繫結至方格的資料。</span><span class="sxs-lookup"><span data-stu-id="94823-133">When a row s Cancel button is clicked, on postback the `EditIndex` is set to a value of `-1` before rebinding the data to the grid.</span></span> <span data-ttu-id="94823-134">GridView s 資料列開始編製索引為零，因為設定`EditIndex`至`-1`以唯讀模式顯示 GridView 的效果。</span><span class="sxs-lookup"><span data-stu-id="94823-134">Since the GridView s rows start indexing at zero, setting `EditIndex` to `-1` has the effect of displaying the GridView in read-only mode.</span></span>

<span data-ttu-id="94823-135">`EditIndex`屬性適用於每個資料列編輯，但不是針對批次的編輯。</span><span class="sxs-lookup"><span data-stu-id="94823-135">The `EditIndex` property works well for per-row editing, but is not designed for batch editing.</span></span> <span data-ttu-id="94823-136">若要讓整個 GridView 可進行編輯，我們需要能夠使用其編輯介面呈現每個資料列。</span><span class="sxs-lookup"><span data-stu-id="94823-136">To make the entire GridView editable, we need to have each row render using its editing interface.</span></span> <span data-ttu-id="94823-137">若要這麼做最簡單的方式是建立其中每個可編輯的欄位會實作為具有其編輯介面為 TemplateField 中定義`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="94823-137">The easiest way to accomplish this is to create where each editable field is implemented as a TemplateField with its editing interface defined in the `ItemTemplate`.</span></span>

<span data-ttu-id="94823-138">接下來幾個步驟我們將建立完全可編輯的 GridView。</span><span class="sxs-lookup"><span data-stu-id="94823-138">Over the next several steps we'll create a completely editable GridView.</span></span> <span data-ttu-id="94823-139">在步驟 1 中我們將開始建立 GridView 和其 ObjectDataSource，並將其 BoundFields 及其轉換成 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="94823-139">In Step 1 we'll start by creating the GridView and its ObjectDataSource and convert its BoundFields and CheckBoxField into TemplateFields.</span></span> <span data-ttu-id="94823-140">步驟 2 和 3 中，我們會說明的編輯介面從 TemplateFields`EditItemTemplate`至其`ItemTemplate`s。</span><span class="sxs-lookup"><span data-stu-id="94823-140">In Steps 2 and 3 we'll move the editing interfaces from the TemplateFields `EditItemTemplate` s to their `ItemTemplate` s.</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="94823-141">步驟 1︰ 顯示產品資訊</span><span class="sxs-lookup"><span data-stu-id="94823-141">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="94823-142">我們會擔心建立 GridView 之前所在的資料列都可以編輯，讓 s 首先會只顯示產品資訊。</span><span class="sxs-lookup"><span data-stu-id="94823-142">Before we worry about creating a GridView where are rows are editable, let s start by simply displaying the product information.</span></span> <span data-ttu-id="94823-143">開啟`BatchUpdate.aspx`頁面中`BatchData`資料夾，然後從 [工具箱] 拖曳至設計工具拖曳的 GridView。</span><span class="sxs-lookup"><span data-stu-id="94823-143">Open the `BatchUpdate.aspx` page in the `BatchData` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="94823-144">設定 GridView s`ID`要`ProductsGrid`，並從它的智慧標籤，選擇 繫結至名為新 ObjectDataSource `ProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="94823-144">Set the GridView s `ID` to `ProductsGrid` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="94823-145">設定要擷取其資料從 ObjectDataSource`ProductsBLL`類別的`GetProducts`方法。</span><span class="sxs-lookup"><span data-stu-id="94823-145">Configure the ObjectDataSource to retrieve its data from the `ProductsBLL` class s `GetProducts` method.</span></span>


<span data-ttu-id="94823-146">[![設定使用 ProductsBLL 類別 ObjectDataSource](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="94823-146">[![Configure the ObjectDataSource to Use the ProductsBLL Class](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span></span>

<span data-ttu-id="94823-147">**圖 2**： 設定要使用 ObjectDataSource`ProductsBLL`類別 ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="94823-147">**Figure 2**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image4.png))</span></span>


<span data-ttu-id="94823-148">[![擷取產品的資料使用 GetProducts 方法](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="94823-148">[![Retrieve the Product Data Using the GetProducts Method](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span></span>

<span data-ttu-id="94823-149">**圖 3**： 擷取產品資料使用`GetProducts`方法 ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="94823-149">**Figure 3**: Retrieve the Product Data Using the `GetProducts` Method ([Click to view full-size image](batch-updating-vb/_static/image6.png))</span></span>


<span data-ttu-id="94823-150">GridView，之類的 ObjectDataSource 的修改功能專為是每個資料列的基礎。</span><span class="sxs-lookup"><span data-stu-id="94823-150">Like the GridView, the ObjectDataSource s modification features are designed to work on a per-row basis.</span></span> <span data-ttu-id="94823-151">若要更新的一組記錄，我們必須撰寫的程式碼的批次資料，並將它傳遞給 BLL，ASP.NET 頁面 s 程式碼後置類別中。</span><span class="sxs-lookup"><span data-stu-id="94823-151">In order to update a set of records, we'll need to write a bit of code in the ASP.NET page s code-behind class that batches the data and passes it to the BLL.</span></span> <span data-ttu-id="94823-152">因此，設定下拉式清單中之 ObjectDataSource 更新、 插入和刪除的索引標籤，為 （無）。</span><span class="sxs-lookup"><span data-stu-id="94823-152">Therefore, set the drop-down lists in the ObjectDataSource s UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="94823-153">按一下 完成 以完成精靈。</span><span class="sxs-lookup"><span data-stu-id="94823-153">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="94823-154">[![設定下拉式清單中更新、 插入和刪除 （無） 索引標籤](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="94823-154">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span></span>

<span data-ttu-id="94823-155">**圖 4**： 設定下拉式清單中更新、 插入和刪除索引標籤為 （無） ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="94823-155">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image8.png))</span></span>


<span data-ttu-id="94823-156">完成設定資料來源精靈之後，ObjectDataSource s 宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="94823-156">After completing the Configure Data Source wizard, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample1.aspx)]

<span data-ttu-id="94823-157">完成設定資料來源精靈 時，也會讓 Visual Studio 在 gridview 裡建立 BoundFields 及其產品資料欄位。</span><span class="sxs-lookup"><span data-stu-id="94823-157">Completing the Configure Data Source wizard also causes Visual Studio to create BoundFields and a CheckBoxField for the product data fields in the GridView.</span></span> <span data-ttu-id="94823-158">本教學課程中，可讓 s 只允許使用者檢視及編輯產品的名稱、 類別、 價格和已停止的狀態。</span><span class="sxs-lookup"><span data-stu-id="94823-158">For this tutorial, let s only allow the user to view and edit the product s name, category, price, and discontinued status.</span></span> <span data-ttu-id="94823-159">移除以外的所有`ProductName`， `CategoryName`， `UnitPrice`，以及`Discontinued`欄位和重新命名`HeaderText`的前三個屬性分別欄位加入產品 」、 「 類別目錄和 「 價格 」。</span><span class="sxs-lookup"><span data-stu-id="94823-159">Remove all but the `ProductName`, `CategoryName`, `UnitPrice`, and `Discontinued` fields and rename the `HeaderText` properties of the first three fields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="94823-160">最後，核取方塊啟用分頁，並啟用排序 GridView s 智慧標籤中。</span><span class="sxs-lookup"><span data-stu-id="94823-160">Lastly, check the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="94823-161">此時 GridView 有三個 BoundFields (`ProductName`， `CategoryName`，並`UnitPrice`) 及其 (`Discontinued`)。</span><span class="sxs-lookup"><span data-stu-id="94823-161">At this point the GridView has three BoundFields (`ProductName`, `CategoryName`, and `UnitPrice`) and a CheckBoxField (`Discontinued`).</span></span> <span data-ttu-id="94823-162">我們要將這四個欄位轉換成 TemplateFields，然後再將編輯介面移 s 中的 TemplateField`EditItemTemplate`至其`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="94823-162">We need to convert these four fields into TemplateFields and then move the editing interface from the TemplateField s `EditItemTemplate` to its `ItemTemplate`.</span></span>

> [!NOTE]
> <span data-ttu-id="94823-163">我們已探索的建立和自訂中的 TemplateFields[自訂資料修改介面](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="94823-163">We explored creating and customizing TemplateFields in the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span> <span data-ttu-id="94823-164">我們將逐步解說的步驟，將 BoundFields 及其轉換成 TemplateFields 和定義其編輯介面中其`ItemTemplate`s，但如果卡住或需要重新整理程式，不要遲疑，立即以回頭參考此先前的教學課程。</span><span class="sxs-lookup"><span data-stu-id="94823-164">We'll walk through the steps of converting the BoundFields and CheckBoxField into TemplateFields and defining their editing interfaces in their `ItemTemplate` s, but if you get stuck or need a refresher, don t hesitate to refer back to this earlier tutorial.</span></span>


<span data-ttu-id="94823-165">從 GridView s 智慧標籤，按一下 編輯資料行連結以開啟 欄位 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="94823-165">From the GridView s smart tag, click the Edit Columns link to open the Fields dialog box.</span></span> <span data-ttu-id="94823-166">接下來，選取每個欄位，並按一下 TemplateField 連結轉換此欄位。</span><span class="sxs-lookup"><span data-stu-id="94823-166">Next, select each field and click the Convert this field into a TemplateField link.</span></span>


![將現有的 BoundFields 及其轉換成 TemplateFields](batch-updating-vb/_static/image5.gif)

<span data-ttu-id="94823-168">**圖 5**： 將現有的 BoundFields 及其轉換成 TemplateFields</span><span class="sxs-lookup"><span data-stu-id="94823-168">**Figure 5**: Convert the Existing BoundFields and CheckBoxField Into TemplateFields</span></span>


<span data-ttu-id="94823-169">現在，每個欄位都為 TemplateField，我們準備好要移動的編輯介面從`EditItemTemplate`s `ItemTemplate` s。</span><span class="sxs-lookup"><span data-stu-id="94823-169">Now that each field is a TemplateField, we re ready to move the editing interface from the `EditItemTemplate` s to the `ItemTemplate` s.</span></span>

## <a name="step-2-creating-theproductnameunitprice-anddiscontinuedediting-interfaces"></a><span data-ttu-id="94823-170">步驟 2： 建立`ProductName`，`UnitPrice`，和`Discontinued`編輯介面</span><span class="sxs-lookup"><span data-stu-id="94823-170">Step 2: Creating the`ProductName`,`UnitPrice`, and`Discontinued`Editing Interfaces</span></span>

<span data-ttu-id="94823-171">建立`ProductName`， `UnitPrice`，並`Discontinued`編輯介面是此步驟的主題和 TemplateField s 中已定義的每個介面都非常簡單， `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="94823-171">Creating the `ProductName`, `UnitPrice`, and `Discontinued` editing interfaces are the topic of this step and are pretty straightforward, as each interface is already defined in the TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="94823-172">建立`CategoryName`編輯介面是稍微複雜一點，因為我們需要建立一個適用的類別目錄的 DropDownList。</span><span class="sxs-lookup"><span data-stu-id="94823-172">Creating the `CategoryName` editing interface is a bit more involved since we need to create a DropDownList of the applicable categories.</span></span> <span data-ttu-id="94823-173">這`CategoryName`編輯介面在步驟 3 中的方式來處理。</span><span class="sxs-lookup"><span data-stu-id="94823-173">This `CategoryName` editing interface is tackled in Step 3.</span></span>

<span data-ttu-id="94823-174">將開頭的 s `ProductName` TemplateField。</span><span class="sxs-lookup"><span data-stu-id="94823-174">Let s start with the `ProductName` TemplateField.</span></span> <span data-ttu-id="94823-175">按一下 [GridView] s 智慧標籤中的 [編輯範本] 連結，然後向下切入至`ProductName`TemplateField 的`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="94823-175">Click on the Edit Templates link from the GridView s smart tag and drill down to the `ProductName` TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="94823-176">選取文字方塊中，將它複製到剪貼簿，然後貼到`ProductName`TemplateField 的`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="94823-176">Select the TextBox, copy it to the clipboard, and then paste it to the `ProductName` TemplateField s `ItemTemplate`.</span></span> <span data-ttu-id="94823-177">變更文字方塊 s`ID`屬性設`ProductName`。</span><span class="sxs-lookup"><span data-stu-id="94823-177">Change the TextBox s `ID` property to `ProductName`.</span></span>

<span data-ttu-id="94823-178">接下來，新增至 RequiredFieldValidator`ItemTemplate`以確保使用者提供的值，針對每個產品 s 的名稱。</span><span class="sxs-lookup"><span data-stu-id="94823-178">Next, add a RequiredFieldValidator to the `ItemTemplate` to ensure that the user provides a value for each product s name.</span></span> <span data-ttu-id="94823-179">設定`ControlToValidate`ProductName，屬性`ErrorMessage`屬性，您必須提供產品的名稱。</span><span class="sxs-lookup"><span data-stu-id="94823-179">Set the `ControlToValidate` property to ProductName, the `ErrorMessage` property to You must provide the product's name.</span></span> <span data-ttu-id="94823-180">而`Text`屬性設\*。</span><span class="sxs-lookup"><span data-stu-id="94823-180">and the `Text` property to \*.</span></span> <span data-ttu-id="94823-181">進行這些新增項目後`ItemTemplate`，您的畫面應該看起來會類似 圖 6。</span><span class="sxs-lookup"><span data-stu-id="94823-181">After making these additions to the `ItemTemplate`, your screen should look similar to Figure 6.</span></span>


<span data-ttu-id="94823-182">[![ProductName TemplateField 現在包含文字方塊和 RequiredFieldValidator](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="94823-182">[![The ProductName TemplateField Now Includes a TextBox and a RequiredFieldValidator](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span></span>

<span data-ttu-id="94823-183">**圖 6**: `ProductName` TemplateField 現在包含一個文字方塊和 RequiredFieldValidator ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="94823-183">**Figure 6**: The `ProductName` TemplateField Now Includes a TextBox and a RequiredFieldValidator ([Click to view full-size image](batch-updating-vb/_static/image10.png))</span></span>


<span data-ttu-id="94823-184">針對`UnitPrice`編輯介面，開始藉由複製文字方塊中的，從`EditItemTemplate`至`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="94823-184">For the `UnitPrice` editing interface, start by copying the TextBox from the `EditItemTemplate` to the `ItemTemplate`.</span></span> <span data-ttu-id="94823-185">接下來，將 $ 前面的文字方塊和設定其`ID`UnitPrice 屬性並將其`Columns`8 的屬性。</span><span class="sxs-lookup"><span data-stu-id="94823-185">Next, place a $ in front of the TextBox and set its `ID` property to UnitPrice and its `Columns` property to 8 .</span></span>

<span data-ttu-id="94823-186">也將新增至 CompareValidator `UnitPrice` s`ItemTemplate`以確保使用者輸入的值是有效的貨幣值大於或等於到美金 $0.00 元。</span><span class="sxs-lookup"><span data-stu-id="94823-186">Also add a CompareValidator to the `UnitPrice` s `ItemTemplate` to ensure that the value entered by the user is a valid currency value greater than or equal to $0.00.</span></span> <span data-ttu-id="94823-187">設定驗證程式 s `ControlToValidate` UnitPrice 屬性其`ErrorMessage`屬性，您必須輸入有效的貨幣值。</span><span class="sxs-lookup"><span data-stu-id="94823-187">Set the validator s `ControlToValidate` property to UnitPrice, its `ErrorMessage` property to You must enter a valid currency value.</span></span> <span data-ttu-id="94823-188">請省略任何貨幣符號。，其`Text`屬性，以\*、 其`Type`屬性設`Currency`、 其`Operator`屬性設`GreaterThanEqual`，並將其`ValueToCompare`屬性設為 0。</span><span class="sxs-lookup"><span data-stu-id="94823-188">Please omit any currency symbols., its `Text` property to \*, its `Type` property to `Currency`, its `Operator` property to `GreaterThanEqual`, and its `ValueToCompare` property to 0 .</span></span>


<span data-ttu-id="94823-189">[![新增 CompareValidator，以確保價格輸入為非負數貨幣值](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="94823-189">[![Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span></span>

<span data-ttu-id="94823-190">**圖 7**： 新增 CompareValidator，以確保價格輸入為非負數貨幣值 ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="94823-190">**Figure 7**: Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value ([Click to view full-size image](batch-updating-vb/_static/image12.png))</span></span>


<span data-ttu-id="94823-191">針對`Discontinued`TemplateField，您可以使用已經定義中的核取方塊`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="94823-191">For the `Discontinued` TemplateField you can use the CheckBox already defined in the `ItemTemplate`.</span></span> <span data-ttu-id="94823-192">只要將設定其`ID`Discontinued 至及其`Enabled`屬性設`True`。</span><span class="sxs-lookup"><span data-stu-id="94823-192">Simply set its `ID` to Discontinued and its `Enabled` property to `True`.</span></span>

## <a name="step-3-creating-thecategorynameediting-interface"></a><span data-ttu-id="94823-193">步驟 3： 建立`CategoryName`編輯介面</span><span class="sxs-lookup"><span data-stu-id="94823-193">Step 3: Creating the`CategoryName`Editing Interface</span></span>

<span data-ttu-id="94823-194">中的編輯介面`CategoryName`TemplateField s`EditItemTemplate`包含文字方塊中顯示的值`CategoryName`資料欄位。</span><span class="sxs-lookup"><span data-stu-id="94823-194">The editing interface in the `CategoryName` TemplateField s `EditItemTemplate` contains a TextBox that displays the value of the `CategoryName` data field.</span></span> <span data-ttu-id="94823-195">我們要取代此項使用 dropdownlist 進行列出可能的類別。</span><span class="sxs-lookup"><span data-stu-id="94823-195">We need to replace this with a DropDownList that lists the possible categories.</span></span>

> [!NOTE]
> <span data-ttu-id="94823-196">[自訂資料修改介面](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)教學課程包含自訂範本以包含相對於文字方塊 dropdownlist 進行更徹底且更完整討論。</span><span class="sxs-lookup"><span data-stu-id="94823-196">The [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial contains a more thorough and complete discussion on customizing a template to include a DropDownList as opposed to a TextBox.</span></span> <span data-ttu-id="94823-197">這裡的步驟完成時，他們會看到 tersely。</span><span class="sxs-lookup"><span data-stu-id="94823-197">While the steps here are complete, they are presented tersely.</span></span> <span data-ttu-id="94823-198">如建立和設定的分類 DropDownList 需深入了解，請參閱上一步[自訂資料修改介面](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="94823-198">For a more in-depth look at creating and configuring the categories DropDownList, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>


<span data-ttu-id="94823-199">從工具箱拖曳 DropDownList `CategoryName` TemplateField s `ItemTemplate`，將其`ID`至`Categories`。</span><span class="sxs-lookup"><span data-stu-id="94823-199">Drag a DropDownList from the Toolbox onto the `CategoryName` TemplateField s `ItemTemplate`, setting its `ID` to `Categories`.</span></span> <span data-ttu-id="94823-200">此時我們會通常定義 dropdownlist 進行的資料來源，透過它的智慧標籤，建立新的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="94823-200">At this point we would usually define the DropDownLists s data source through its smart tag, creating a new ObjectDataSource.</span></span> <span data-ttu-id="94823-201">不過，這會將新增內的 ObjectDataSource `ItemTemplate`，從而導致每個 GridView 資料列所建立的 ObjectDataSource 執行個體。</span><span class="sxs-lookup"><span data-stu-id="94823-201">However, this will add the ObjectDataSource within the `ItemTemplate`, which will result in an ObjectDataSource instance created for each GridView row.</span></span> <span data-ttu-id="94823-202">相反地，讓建立 ObjectDataSource GridView 的 TemplateFields 之外。</span><span class="sxs-lookup"><span data-stu-id="94823-202">Instead, let s create the ObjectDataSource outside of the GridView s TemplateFields.</span></span> <span data-ttu-id="94823-203">結束範本編輯，並從 [工具箱] 拖曳至設計工具下方拖曳 ObjectDataSource `ProductsDataSource` ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="94823-203">End the template editing and drag an ObjectDataSource from the Toolbox onto the Designer beneath the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="94823-204">名稱的新 ObjectDataSource`CategoriesDataSource`並將它設定為使用`CategoriesBLL`類別的`GetCategories`方法。</span><span class="sxs-lookup"><span data-stu-id="94823-204">Name the new ObjectDataSource `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories` method.</span></span>


<span data-ttu-id="94823-205">[![設定使用 CategoriesBLL 類別 ObjectDataSource](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="94823-205">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span></span>

<span data-ttu-id="94823-206">**圖 8**： 設定要使用 ObjectDataSource`CategoriesBLL`類別 ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="94823-206">**Figure 8**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image14.png))</span></span>


<span data-ttu-id="94823-207">[![擷取使用 GetCategories 方法的類別目錄資料](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="94823-207">[![Retrieve the Category Data Using the GetCategories Method](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span></span>

<span data-ttu-id="94823-208">**圖 9**： 擷取類別目錄資料使用`GetCategories`方法 ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="94823-208">**Figure 9**: Retrieve the Category Data Using the `GetCategories` Method ([Click to view full-size image](batch-updating-vb/_static/image16.png))</span></span>


<span data-ttu-id="94823-209">由於這個 ObjectDataSource 只是用以擷取資料，設定下拉式清單中的 UPDATE 和 DELETE 的索引標籤為 （無）。</span><span class="sxs-lookup"><span data-stu-id="94823-209">Since this ObjectDataSource is used merely to retrieve data, set the drop-down lists in the UPDATE and DELETE tabs to (None).</span></span> <span data-ttu-id="94823-210">按一下 完成 以完成精靈。</span><span class="sxs-lookup"><span data-stu-id="94823-210">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="94823-211">[![設定下拉式清單中的更新和刪除索引標籤，為 （無）](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="94823-211">[![Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None)](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span></span>

<span data-ttu-id="94823-212">**圖 10**： 設定下拉式清單中的更新和刪除索引標籤為 （無） ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="94823-212">**Figure 10**: Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image18.png))</span></span>


<span data-ttu-id="94823-213">在精靈中，完成後`CategoriesDataSource`s 宣告式標記應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="94823-213">After completing the wizard, the `CategoriesDataSource` s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample2.aspx)]

<span data-ttu-id="94823-214">具有`CategoriesDataSource`建立並設定，回到`CategoryName`TemplateField 的`ItemTemplate`並從 DropDownList s 智慧標籤，按一下 選擇資料來源連結。</span><span class="sxs-lookup"><span data-stu-id="94823-214">With the `CategoriesDataSource` created and configured, return to the `CategoryName` TemplateField s `ItemTemplate` and, from the DropDownList s smart tag, click on the Choose Data Source link.</span></span> <span data-ttu-id="94823-215">在 [資料來源組態精靈] 中，選取`CategoriesDataSource`從第一個下拉式清單選項，然後選擇`CategoryName`用於顯示和`CategoryID`做為值。</span><span class="sxs-lookup"><span data-stu-id="94823-215">In the Data Source Configuration wizard, select the `CategoriesDataSource` option from the first drop-down list and choose to have `CategoryName` used for the display and `CategoryID` as the value.</span></span>


<span data-ttu-id="94823-216">[![繫結至 CategoriesDataSource 的 DropDownList](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="94823-216">[![Bind the DropDownList to the CategoriesDataSource](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span></span>

<span data-ttu-id="94823-217">**圖 11**： 繫結至 DropDownList `CategoriesDataSource` ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="94823-217">**Figure 11**: Bind the DropDownList to the `CategoriesDataSource` ([Click to view full-size image](batch-updating-vb/_static/image20.png))</span></span>


<span data-ttu-id="94823-218">此時`Categories`DropDownList 列出所有類別，但它不會還會自動選取適當的類別，繫結至 GridView 資料列的產品。</span><span class="sxs-lookup"><span data-stu-id="94823-218">At this point the `Categories` DropDownList lists all of the categories, but it does not yet automatically select the appropriate category for the product bound to the GridView row.</span></span> <span data-ttu-id="94823-219">若要這麼做我們需要設定`Categories`DropDownList s`SelectedValue`產品 s`CategoryID`值。</span><span class="sxs-lookup"><span data-stu-id="94823-219">To accomplish this we need to set the `Categories` DropDownList s `SelectedValue` to the product s `CategoryID` value.</span></span> <span data-ttu-id="94823-220">按一下 從 DropDownList s 智慧標籤的 編輯資料繫結 連結，並將產生關聯`SelectedValue`屬性與`CategoryID`資料欄位，如 圖 12 所示。</span><span class="sxs-lookup"><span data-stu-id="94823-220">Click on the Edit DataBindings link from the DropDownList s smart tag and associate the `SelectedValue` property with the `CategoryID` data field as shown in Figure 12.</span></span>


![將產品的 CategoryID 值繫結 DropDownList 的 SelectedValue 屬性](batch-updating-vb/_static/image12.gif)

<span data-ttu-id="94823-222">**圖 12**： 繫結產品 s `CategoryID` DropDownList s 值`SelectedValue`屬性</span><span class="sxs-lookup"><span data-stu-id="94823-222">**Figure 12**: Bind the Product s `CategoryID` Value to the DropDownList s `SelectedValue` Property</span></span>


<span data-ttu-id="94823-223">一個過去的問題會維持： 有的產品不 t`CategoryID`值，然後在資料繫結陳述式上指定`SelectedValue`會導致例外狀況。</span><span class="sxs-lookup"><span data-stu-id="94823-223">One last problem remains: if the product doesn t have a `CategoryID` value specified then the databinding statement on `SelectedValue` will result in an exception.</span></span> <span data-ttu-id="94823-224">這是因為 DropDownList 包含類別的項目，而且不提供這些產品的選項`NULL`資料庫值`CategoryID`。</span><span class="sxs-lookup"><span data-stu-id="94823-224">This is because the DropDownList contains only items for the categories and does not offer an option for those products that have a `NULL` database value for `CategoryID`.</span></span> <span data-ttu-id="94823-225">若要解決此問題，將設定 DropDownList s`AppendDataBoundItems`屬性，以`True`並將新的項目新增至下拉式清單中，省略`Value`從宣告式語法的屬性。</span><span class="sxs-lookup"><span data-stu-id="94823-225">To remedy this, set the DropDownList s `AppendDataBoundItems` property to `True` and add a new item to the DropDownList, omitting the `Value` property from the declarative syntax.</span></span> <span data-ttu-id="94823-226">也就是確定`Categories`DropDownList s 宣告式語法看起來如下：</span><span class="sxs-lookup"><span data-stu-id="94823-226">That is, make sure that the `Categories` DropDownList s declarative syntax looks like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample3.aspx)]

<span data-ttu-id="94823-227">請注意如何`<asp:ListItem Value="">`-選取一個-具有其`Value`屬性明確設為空字串。</span><span class="sxs-lookup"><span data-stu-id="94823-227">Note how the `<asp:ListItem Value="">` -- Select One -- has its `Value` attribute explicitly set to an empty string.</span></span> <span data-ttu-id="94823-228">回頭[自訂資料修改介面](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)如需為何需要這個額外的 DropDownList 項目用來處理的更完整討論教學課程`NULL`案例和原因指派`Value`屬性設為空字串是不可或缺的。</span><span class="sxs-lookup"><span data-stu-id="94823-228">Refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial for a more thorough discussion on why this additional DropDownList item is needed to handle the `NULL` case and why assignment of the `Value` property to an empty string is essential.</span></span>

> [!NOTE]
> <span data-ttu-id="94823-229">還有潛在的效能和延展性問題這裡值得一提的。</span><span class="sxs-lookup"><span data-stu-id="94823-229">There is a potential performance and scalability issue here that is worth mentioning.</span></span> <span data-ttu-id="94823-230">因為每個資料列有使用 DropDownList`CategoriesDataSource`當做其資料來源，`CategoriesBLL`類別 s`GetCategories`方法將會呼叫*n*瀏覽每個頁面的時間，其中*n*是數目在 gridview 裡的資料列。</span><span class="sxs-lookup"><span data-stu-id="94823-230">Since each row has a DropDownList that uses the `CategoriesDataSource` as its data source, the `CategoriesBLL` class s `GetCategories` method will be called *n* times per page visit, where *n* is the number of rows in the GridView.</span></span> <span data-ttu-id="94823-231">這些*n*呼叫`GetCategories`導致*n*向資料庫查詢。</span><span class="sxs-lookup"><span data-stu-id="94823-231">These *n* calls to `GetCategories` result in *n* queries to the database.</span></span> <span data-ttu-id="94823-232">無法減少這種影響的資料庫，藉由快取傳回的類別目錄的每個要求快取中或透過使用 SQL 快取相依性或極短時間為基礎的過期快取層級。</span><span class="sxs-lookup"><span data-stu-id="94823-232">This impact on the database could be lessened by caching the returned categories either in a per-request cache or through the Caching Layer using a SQL caching dependency or a very short time-based expiry.</span></span> <span data-ttu-id="94823-233">如需有關每個要求快取選項，請參閱[`HttpContext.Items`每個要求的快取存放區](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="94823-233">For more information on the per-request caching option, see [`HttpContext.Items` a Per-Request Cache Store](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span></span>


## <a name="step-4-completing-the-editing-interface"></a><span data-ttu-id="94823-234">步驟 4： 完成編輯介面</span><span class="sxs-lookup"><span data-stu-id="94823-234">Step 4: Completing the Editing Interface</span></span>

<span data-ttu-id="94823-235">我們 ve 範本所做的變更數目 GridView s 停頓檢視我們的進度。</span><span class="sxs-lookup"><span data-stu-id="94823-235">We ve made a number of changes to the GridView s templates without pausing to view our progress.</span></span> <span data-ttu-id="94823-236">請花一點時間檢閱我們透過瀏覽器的進度。</span><span class="sxs-lookup"><span data-stu-id="94823-236">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="94823-237">如 [圖 13] 所示，每個資料列使用呈現其`ItemTemplate`，其中包含儲存格 s 中的編輯介面。</span><span class="sxs-lookup"><span data-stu-id="94823-237">As Figure 13 shows, each row is rendered using its `ItemTemplate`, which contains the cell s editing interface.</span></span>


<span data-ttu-id="94823-238">[![每個 GridView 資料列是可編輯](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="94823-238">[![Each GridView Row is Editable](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span></span>

<span data-ttu-id="94823-239">**圖 13**： 每個 GridView 資料列是可編輯 ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="94823-239">**Figure 13**: Each GridView Row is Editable ([Click to view full-size image](batch-updating-vb/_static/image22.png))</span></span>


<span data-ttu-id="94823-240">有一些次要的格式設定問題，我們會負責在此時。</span><span class="sxs-lookup"><span data-stu-id="94823-240">There are a few minor formatting issues that we should take care of at this point.</span></span> <span data-ttu-id="94823-241">首先，請注意，`UnitPrice`值包含四個小數位數。</span><span class="sxs-lookup"><span data-stu-id="94823-241">First, note that the `UnitPrice` value contains four decimal points.</span></span> <span data-ttu-id="94823-242">若要修正此問題，傳回到`UnitPrice`TemplateField 的`ItemTemplate`和從文字方塊 s 智慧標籤，按一下 [編輯資料繫結] 連結。</span><span class="sxs-lookup"><span data-stu-id="94823-242">To fix this, return to the `UnitPrice` TemplateField s `ItemTemplate` and, from the TextBox s smart tag, click on the Edit DataBindings link.</span></span> <span data-ttu-id="94823-243">接下來，指定`Text`屬性的格式應該是數字。</span><span class="sxs-lookup"><span data-stu-id="94823-243">Next, specify that the `Text` property should be formatted as a number.</span></span>


![表示為數字格式的文字屬性](batch-updating-vb/_static/image14.gif)

<span data-ttu-id="94823-245">**圖 14**： 格式`Text`屬性，表示為數字</span><span class="sxs-lookup"><span data-stu-id="94823-245">**Figure 14**: Format the `Text` Property as a Number</span></span>


<span data-ttu-id="94823-246">第二，可讓 s center 中的核取`Discontinued`資料行 （而非它靠左對齊）。</span><span class="sxs-lookup"><span data-stu-id="94823-246">Second, let s center the checkbox in the `Discontinued` column (rather than having it left-aligned).</span></span> <span data-ttu-id="94823-247">從 GridView s 智慧標籤中按一下 編輯資料行，然後選取`Discontinued`TemplateField 從左下角中的欄位清單。</span><span class="sxs-lookup"><span data-stu-id="94823-247">Click on Edit Columns from the GridView s smart tag and select the `Discontinued` TemplateField from the list of fields in the bottom left corner.</span></span> <span data-ttu-id="94823-248">向下鑽研`ItemStyle`並設定`HorizontalAlign`Center，如 圖 15 所示的屬性。</span><span class="sxs-lookup"><span data-stu-id="94823-248">Drill down into `ItemStyle` and set the `HorizontalAlign` property to Center as shown in Figure 15.</span></span>


![置中已停止的核取方塊](batch-updating-vb/_static/image15.gif)

<span data-ttu-id="94823-250">**圖 15**: Center`Discontinued`核取方塊</span><span class="sxs-lookup"><span data-stu-id="94823-250">**Figure 15**: Center the `Discontinued` CheckBox</span></span>


<span data-ttu-id="94823-251">接下來，ValidationSummary 控制項加入頁面，並設定其`ShowMessageBox`屬性，以`True`及其`ShowSummary`屬性設`False`。</span><span class="sxs-lookup"><span data-stu-id="94823-251">Next, add a ValidationSummary control to the page and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span> <span data-ttu-id="94823-252">也將新增按鈕 Web 控制項，按下時，將會更新使用者的變更。</span><span class="sxs-lookup"><span data-stu-id="94823-252">Also add the Button Web controls that, when clicked, will update the user s changes.</span></span> <span data-ttu-id="94823-253">具體來說，新增兩個按鈕 Web 控制項，一個以上的 GridView，另一個下方，設定兩個控制項`Text`更新產品的屬性。</span><span class="sxs-lookup"><span data-stu-id="94823-253">Specifically, add two Button Web controls, one above the GridView and one below it, setting both controls `Text` properties to Update Products .</span></span>

<span data-ttu-id="94823-254">GridView s 自編輯介面定義於其 TemplateFields `ItemTemplate` s， `EditItemTemplate` s 是多餘的而且會遭到刪除。</span><span class="sxs-lookup"><span data-stu-id="94823-254">Since the GridView s editing interface is defined in its TemplateFields `ItemTemplate` s, the `EditItemTemplate` s are superfluous and may be deleted.</span></span>

<span data-ttu-id="94823-255">進行上述提到的格式設定變更之後，新增按鈕控制項，並移除不必要`EditItemTemplate`s，您的頁面 s 宣告式語法看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="94823-255">After making the above mentioned formatting changes, adding the Button controls, and removing the unnecessary `EditItemTemplate` s, your page s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample4.aspx)]

<span data-ttu-id="94823-256">圖 16 顯示此頁面已加入 Button Web 控制項之後，透過瀏覽器檢視時，並格式化所做的變更。</span><span class="sxs-lookup"><span data-stu-id="94823-256">Figure 16 shows this page when viewed through a browser after the Button Web controls have been added and the formatting changes made.</span></span>


<span data-ttu-id="94823-257">[![頁面現在包含兩個更新的產品按鈕](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="94823-257">[![The Page Now Includes Two Update Products Buttons](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span></span>

<span data-ttu-id="94823-258">**圖 16**: 頁面現在包含兩個更新的產品按鈕 ([按一下以檢視完整大小的影像](batch-updating-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="94823-258">**Figure 16**: The Page Now Includes Two Update Products Buttons ([Click to view full-size image](batch-updating-vb/_static/image24.png))</span></span>


## <a name="step-5-updating-the-products"></a><span data-ttu-id="94823-259">步驟 5： 更新產品</span><span class="sxs-lookup"><span data-stu-id="94823-259">Step 5: Updating the Products</span></span>

<span data-ttu-id="94823-260">當使用者造訪此頁面他們進行修改，然後按一下其中一個的兩個更新產品按鈕。</span><span class="sxs-lookup"><span data-stu-id="94823-260">When a user visits this page they will make their modifications and then click one of the two Update Products buttons.</span></span> <span data-ttu-id="94823-261">此時，我們需要以某種方式儲存至每個資料列的使用者輸入值`ProductsDataTable`執行個體，並再將它傳遞至再經歷，BLL 方法`ProductsDataTable`DAL s 執行個體`UpdateWithTransaction`方法。</span><span class="sxs-lookup"><span data-stu-id="94823-261">At that point we need to somehow save the user-entered values for each row into a `ProductsDataTable` instance and then pass that to a BLL method that will then pass that `ProductsDataTable` instance to the DAL s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="94823-262">`UpdateWithTransaction`方法，我們在建立[前述教學課程](wrapping-database-modifications-within-a-transaction-vb.md)，可確保批次的變更將會更新以不可部分完成的作業。</span><span class="sxs-lookup"><span data-stu-id="94823-262">The `UpdateWithTransaction` method, which we created in the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md), ensures that the batch of changes will be updated as an atomic operation.</span></span>

<span data-ttu-id="94823-263">建立名為的方法`BatchUpdate`在`BatchUpdate.aspx.vb`並加入下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="94823-263">Create a method named `BatchUpdate` in `BatchUpdate.aspx.vb` and add the following code:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample5.vb)]

<span data-ttu-id="94823-264">這個方法一開始所取得的所有產品年代`ProductsDataTable`BLL 的呼叫透過`GetProducts`方法。</span><span class="sxs-lookup"><span data-stu-id="94823-264">This method starts out by getting all of the products back in a `ProductsDataTable` via a call to the BLL s `GetProducts` method.</span></span> <span data-ttu-id="94823-265">接著它會列舉`ProductGrid`GridView s [ `Rows`集合](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx)。</span><span class="sxs-lookup"><span data-stu-id="94823-265">It then enumerates the `ProductGrid` GridView s [`Rows` collection](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span></span> <span data-ttu-id="94823-266">`Rows`集合包含[`GridViewRow`執行個體](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx)GridView 中顯示每個資料列。</span><span class="sxs-lookup"><span data-stu-id="94823-266">The `Rows` collection contains a [`GridViewRow` instance](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx) for each row displayed in the GridView.</span></span> <span data-ttu-id="94823-267">因為我們會顯示最多 10 個資料列每一頁，GridView 的`Rows`集合中會有不超過十個項目。</span><span class="sxs-lookup"><span data-stu-id="94823-267">Since we are showing at most ten rows per page, the GridView s `Rows` collection will have no more than ten items.</span></span>

<span data-ttu-id="94823-268">每個資料列`ProductID`捕捉來自`DataKeys`收集和適當`ProductsRow`從選取`ProductsDataTable`。</span><span class="sxs-lookup"><span data-stu-id="94823-268">For each row the `ProductID` is grabbed from the `DataKeys` collection and the appropriate `ProductsRow` is selected from the `ProductsDataTable`.</span></span> <span data-ttu-id="94823-269">以程式設計方式所參考的四個的 TemplateField 輸入的控制項和其值指派給`ProductsRow`執行個體的內容。</span><span class="sxs-lookup"><span data-stu-id="94823-269">The four TemplateField input controls are programmatically referenced and their values assigned to the `ProductsRow` instance s properties.</span></span> <span data-ttu-id="94823-270">之後每個 GridView 資料列的值已用來更新`ProductsDataTable`，它 s 傳遞到 BLL`UpdateWithTransaction`方法，如我們所見在先前的教學課程中，只要呼叫向下到 DAL 的`UpdateWithTransaction`方法。</span><span class="sxs-lookup"><span data-stu-id="94823-270">After each GridView row s values have been used to update the `ProductsDataTable`, it s passed to the BLL s `UpdateWithTransaction` method which, as we saw in the preceding tutorial, simply calls down into the DAL s `UpdateWithTransaction` method.</span></span>

<span data-ttu-id="94823-271">本教學課程使用的批次更新演算法更新中的每個資料列`ProductsDataTable`對應至 GridView，不論是否已變更的產品的資訊中的資料列。</span><span class="sxs-lookup"><span data-stu-id="94823-271">The batch update algorithm used for this tutorial updates each row in the `ProductsDataTable` that corresponds to a row in the GridView, regardless of whether the product s information has been changed.</span></span> <span data-ttu-id="94823-272">而這類 blind 更新通常並不是效能問題，它們可能會導致過多記錄您稽核變更為資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="94823-272">While such blind updates aren t usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="94823-273">回到[執行批次更新](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md)教學課程中我們探討更新介面與批次，並新增程式碼，只會更新使用者實際修改這些記錄。</span><span class="sxs-lookup"><span data-stu-id="94823-273">Back in the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we explored a batch updating interface with the DataList and added code that would only update those records that were actually modified by the user.</span></span> <span data-ttu-id="94823-274">歡迎使用從技術[執行批次更新](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md)如有需要，在本教學課程中，更新程式碼。</span><span class="sxs-lookup"><span data-stu-id="94823-274">Feel free to use the techniques from [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) to update the code in this tutorial, if desired.</span></span>

> [!NOTE]
> <span data-ttu-id="94823-275">Visual Studio 時繫結到它的智慧標籤 GridView 資料來源，會自動指派到 GridView 資料來源 s 主要值`DataKeyNames`屬性。</span><span class="sxs-lookup"><span data-stu-id="94823-275">When binding the data source to the GridView through its smart tag, Visual Studio automatically assigns the data source s primary key value(s) to the GridView s `DataKeyNames` property.</span></span> <span data-ttu-id="94823-276">如果您未繫結 ObjectDataSource GridView 透過 GridView s 智慧標籤在步驟 1 中所述，則您必須手動設定 GridView s`DataKeyNames`若要存取的 ProductID 屬性`ProductID`透過每個資料列的值`DataKeys`集合。</span><span class="sxs-lookup"><span data-stu-id="94823-276">If you did not bind the ObjectDataSource to the GridView through the GridView s smart tag as outlined in Step 1, then you will need to manually set the GridView s `DataKeyNames` property to ProductID in order to access the `ProductID` value for each row through the `DataKeys` collection.</span></span>


<span data-ttu-id="94823-277">中所使用的程式碼`BatchUpdate`類似於用於 BLL s`UpdateProduct`方法，最主要的差異，在於中`UpdateProduct`方法只會有一個`ProductRow`擷取執行個體的架構。</span><span class="sxs-lookup"><span data-stu-id="94823-277">The code used in `BatchUpdate` is similar to that used in the BLL s `UpdateProduct` methods, the main difference being that in the `UpdateProduct` methods only a single `ProductRow` instance is retrieved from the architecture.</span></span> <span data-ttu-id="94823-278">指派的屬性的程式碼`ProductRow`之間相同`UpdateProducts`方法和中的程式碼`For Each`迴圈`BatchUpdate`，因為是整體模式。</span><span class="sxs-lookup"><span data-stu-id="94823-278">The code that assigns the properties of the `ProductRow` is the same between the `UpdateProducts` methods and the code within the `For Each` loop in `BatchUpdate`, as is the overall pattern.</span></span>

<span data-ttu-id="94823-279">若要完成本教學課程中，我們必須能夠`BatchUpdate`時叫用方法的更新產品按鈕按下。</span><span class="sxs-lookup"><span data-stu-id="94823-279">To complete this tutorial, we need to have the `BatchUpdate` method invoked when either of the Update Products buttons is clicked.</span></span> <span data-ttu-id="94823-280">建立事件處理常式`Click`事件，這兩個按鈕控制項，然後在 事件處理常式中新增下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="94823-280">Create event handlers for the `Click` events of these two Button controls and add the following code in the event handlers:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample6.vb)]

<span data-ttu-id="94823-281">第一次進行呼叫，以`BatchUpdate`。</span><span class="sxs-lookup"><span data-stu-id="94823-281">First a call is made to `BatchUpdate`.</span></span> <span data-ttu-id="94823-282">下一步 [ `ClientScript`屬性](https://msdn.microsoft.com/library/system.web.ui.page.clientscript(VS.80).aspx)可用來插入 JavaScript，其中會顯示 messagebox，以讀取已更新的產品。</span><span class="sxs-lookup"><span data-stu-id="94823-282">Next, the [`ClientScript` property](https://msdn.microsoft.com/library/system.web.ui.page.clientscript(VS.80).aspx) is used to inject JavaScript that will display a messagebox that reads The products have been updated.</span></span>

<span data-ttu-id="94823-283">花點時間試用此程式碼。</span><span class="sxs-lookup"><span data-stu-id="94823-283">Take a minute to test out this code.</span></span> <span data-ttu-id="94823-284">請瀏覽`BatchUpdate.aspx`透過瀏覽器中，編輯資料列數，再按一下其中一個更新產品按鈕。</span><span class="sxs-lookup"><span data-stu-id="94823-284">Visit `BatchUpdate.aspx` through a browser, edit a number of rows, and click one of the Update Products buttons.</span></span> <span data-ttu-id="94823-285">假設沒有任何輸入的驗證錯誤，您應該會看到 messagebox 讀取已更新的產品。</span><span class="sxs-lookup"><span data-stu-id="94823-285">Assuming there are no input validation errors, you should see a messagebox that reads The products have been updated.</span></span> <span data-ttu-id="94823-286">若要確認更新的不可部分完成性，請考慮新增的隨機`CHECK`條件約束，例如不允許`UnitPrice`1234.56 的值。</span><span class="sxs-lookup"><span data-stu-id="94823-286">To verify the atomicity of the update, consider adding a random `CHECK` constraint, like one that disallows `UnitPrice` values of 1234.56.</span></span> <span data-ttu-id="94823-287">接著從`BatchUpdate.aspx`，編輯的記錄數，並確認其設定其中一個產品的`UnitPrice`禁止的值 (1234.56) 的值。</span><span class="sxs-lookup"><span data-stu-id="94823-287">Then from `BatchUpdate.aspx`, edit a number of records, making sure to set one of the product s `UnitPrice` value to the forbidden value ( 1234.56 ).</span></span> <span data-ttu-id="94823-288">這應該導致發生錯誤時，批次作業時，按一下與其他變更的更新產品回復到其原始值。</span><span class="sxs-lookup"><span data-stu-id="94823-288">This should result in an error when clicking Update Products with the other changes during that batch operation rolled back to their original values.</span></span>

## <a name="an-alternativebatchupdatemethod"></a><span data-ttu-id="94823-289">替代`BatchUpdate`方法</span><span class="sxs-lookup"><span data-stu-id="94823-289">An Alternative`BatchUpdate`Method</span></span>

<span data-ttu-id="94823-290">`BatchUpdate`方法，我們只是檢查擷取*所有*的產品，從 BLL 的`GetProducts`方法，然後更新只會出現在 GridView 的記錄。</span><span class="sxs-lookup"><span data-stu-id="94823-290">The `BatchUpdate` method we just examined retrieves *all* of the products from the BLL s `GetProducts` method and then updates just those records that appear in the GridView.</span></span> <span data-ttu-id="94823-291">如果 GridView 不會使用分頁，但如果是這樣，可能有數百個、 幾千個或數以萬計的產品，但是在 gridview 裡的只有 10 個資料列，則這個方法會很理想。</span><span class="sxs-lookup"><span data-stu-id="94823-291">This approach is ideal if the GridView does not use paging, but if it does, there may be hundreds, thousands, or tens of thousands of products, but only ten rows in the GridView.</span></span> <span data-ttu-id="94823-292">在此情況下，從只是要修改 10 個的資料庫取得所有產品都是不盡理想。</span><span class="sxs-lookup"><span data-stu-id="94823-292">In such a case, getting all of the products from the database only to modify 10 of them is less than ideal.</span></span>

<span data-ttu-id="94823-293">對於這些類型的情況中，請考慮使用下列`BatchUpdateAlternate`方法改為：</span><span class="sxs-lookup"><span data-stu-id="94823-293">For those types of situations, consider using the following `BatchUpdateAlternate` method instead:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample7.vb)]

<span data-ttu-id="94823-294">`BatchMethodAlternate` 開始建立新的空`ProductsDataTable`名為`products`。</span><span class="sxs-lookup"><span data-stu-id="94823-294">`BatchMethodAlternate` starts by creating a new empty `ProductsDataTable` named `products`.</span></span> <span data-ttu-id="94823-295">然後 GridView 的逐步`Rows`集合，在每個資料列取得特定產品資訊使用 BLL 的`GetProductByProductID(productID)`方法。</span><span class="sxs-lookup"><span data-stu-id="94823-295">It then steps through the GridView s `Rows` collection and for each row gets the particular product information using the BLL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="94823-296">擷取`ProductsRow`執行個體有相同的方式，做為更新的屬性`BatchUpdate`，但在更新匯入的資料列之後`products``ProductsDataTable`經由 DataTable s [ `ImportRow(DataRow)`方法](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="94823-296">The retrieved `ProductsRow` instance has its properties updated in the same fashion as `BatchUpdate`, but after updating the row it is imported into the `products` `ProductsDataTable` via the DataTable s [`ImportRow(DataRow)` method](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span></span>

<span data-ttu-id="94823-297">在後`For Each`迴圈完成時，`products`包含一個`ProductsRow`GridView 裡的每個資料列的執行個體。</span><span class="sxs-lookup"><span data-stu-id="94823-297">After the `For Each` loop completes, `products` contains one `ProductsRow` instance for each row in the GridView.</span></span> <span data-ttu-id="94823-298">因為每個`ProductsRow`執行個體已新增至`products`（而不是更新），如果我們盲目地將它傳遞給`UpdateWithTransaction`方法`ProductsTableAdatper`會嘗試將每筆記錄插入資料庫。</span><span class="sxs-lookup"><span data-stu-id="94823-298">Since each of the `ProductsRow` instances have been added to the `products` (instead of updated), if we blindly pass it to the `UpdateWithTransaction` method the `ProductsTableAdatper` will try to insert each of the records into the database.</span></span> <span data-ttu-id="94823-299">相反地，我們需要指定，這些資料列的每個已修改 （未加入）。</span><span class="sxs-lookup"><span data-stu-id="94823-299">Instead, we need to specify that each of these rows has been modified (not added).</span></span>

<span data-ttu-id="94823-300">這可藉由將新方法新增至名為 BLL `UpdateProductsWithTransaction`。</span><span class="sxs-lookup"><span data-stu-id="94823-300">This can be accomplished by adding a new method to the BLL named `UpdateProductsWithTransaction`.</span></span> <span data-ttu-id="94823-301">`UpdateProductsWithTransaction`如下所示，設定`RowState`的每個`ProductsRow`中的執行個體`ProductsDataTable`來`Modified`，並接著傳遞`ProductsDataTable`DAL s`UpdateWithTransaction`方法。</span><span class="sxs-lookup"><span data-stu-id="94823-301">`UpdateProductsWithTransaction`, shown below, sets the `RowState` of each of the `ProductsRow` instances in the `ProductsDataTable` to `Modified` and then passes the `ProductsDataTable` to the DAL s `UpdateWithTransaction` method.</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample8.vb)]

## <a name="summary"></a><span data-ttu-id="94823-302">總結</span><span class="sxs-lookup"><span data-stu-id="94823-302">Summary</span></span>

<span data-ttu-id="94823-303">GridView 會提供內建的每列的編輯功能，但不支援建立完整的可編輯的介面。</span><span class="sxs-lookup"><span data-stu-id="94823-303">The GridView provides built-in per-row editing capabilities, but lacks support for creating fully editable interfaces.</span></span> <span data-ttu-id="94823-304">如我們所見本教學課程中，這類介面是可行的但需要一些工作。</span><span class="sxs-lookup"><span data-stu-id="94823-304">As we saw in this tutorial, such interfaces are possible, but require a bit of work.</span></span> <span data-ttu-id="94823-305">若要建立其中每個資料列是可編輯的 GridView，我們需要將 GridView 的欄位轉換成 TemplateFields 並定義內的編輯介面`ItemTemplate`s。</span><span class="sxs-lookup"><span data-stu-id="94823-305">To create a GridView where every row is editable, we need to convert the GridView s fields into TemplateFields and define the editing interface within the `ItemTemplate` s.</span></span> <span data-ttu-id="94823-306">此外，更新所有按鈕 Web 控制項的型別必須新增至頁面上，個別從 GridView。</span><span class="sxs-lookup"><span data-stu-id="94823-306">Additionally, Update All -type Button Web controls must be added to the page, separate from the GridView.</span></span> <span data-ttu-id="94823-307">這些按鈕`Click`事件處理常式需要列舉的 GridView s`Rows`集合中，存放區中的變更`ProductsDataTable`，並將更新的資訊傳遞至適當的 BLL 方法。</span><span class="sxs-lookup"><span data-stu-id="94823-307">These Buttons `Click` event handlers need to enumerate the GridView s `Rows` collection, store the changes in a `ProductsDataTable`, and pass the updated information into the appropriate BLL method.</span></span>

<span data-ttu-id="94823-308">在下一個教學課程中，我們將了解如何建立批次刪除介面。</span><span class="sxs-lookup"><span data-stu-id="94823-308">In the next tutorial we'll see how to create an interface for batch deleting.</span></span> <span data-ttu-id="94823-309">特別的是，每個 GridView 資料列會包含一個核取方塊並而不是全部更新-輸入按鈕，我們必須刪除選取的資料列按鈕。</span><span class="sxs-lookup"><span data-stu-id="94823-309">In particular, each GridView row will include a checkbox and instead of Update All -type buttons, we'll have Delete Selected Rows buttons.</span></span>

<span data-ttu-id="94823-310">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="94823-310">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="94823-311">關於作者</span><span class="sxs-lookup"><span data-stu-id="94823-311">About the Author</span></span>

<span data-ttu-id="94823-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="94823-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="94823-313">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="94823-313">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="94823-314">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="94823-314">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="94823-315">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="94823-315">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="94823-316">或透過他的部落格，這位於 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="94823-316">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="94823-317">特別感謝</span><span class="sxs-lookup"><span data-stu-id="94823-317">Special Thanks To</span></span>

<span data-ttu-id="94823-318">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="94823-318">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="94823-319">本教學課程中的潛在客戶檢閱者已 Teresa Murphy 和 David Suru。</span><span class="sxs-lookup"><span data-stu-id="94823-319">Lead reviewers for this tutorial were Teresa Murphy and David Suru.</span></span> <span data-ttu-id="94823-320">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="94823-320">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="94823-321">如果是這樣，psychic 在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="94823-321">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="94823-322">[上一頁](wrapping-database-modifications-within-a-transaction-vb.md)
> [下一頁](batch-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="94823-322">[Previous](wrapping-database-modifications-within-a-transaction-vb.md)
[Next](batch-deleting-vb.md)</span></span>
