---
uid: web-forms/overview/data-access/custom-formatting/using-templatefields-in-the-gridview-control-vb
title: GridView 控制項 (VB) 中使用 TemplateFields |Microsoft Docs
author: rick-anderson
description: 為了提供彈性，GridView 會提供 TemplateField，會呈現使用範本。 範本可以包含混合的靜態 HTML Web 控制項和...
ms.author: aspnetcontent
ms.date: 03/31/2010
ms.assetid: a92cd6ed-609a-4e40-ad23-004b54afd436
msc.legacyurl: /web-forms/overview/data-access/custom-formatting/using-templatefields-in-the-gridview-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 411a3a2e4067d0e9b41143d85ddfb9b1031fd684
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/05/2018
ms.locfileid: "37829161"
---
<a name="using-templatefields-in-the-gridview-control-vb"></a><span data-ttu-id="515cb-104">GridView 控制項 (VB) 中使用 TemplateFields</span><span class="sxs-lookup"><span data-stu-id="515cb-104">Using TemplateFields in the GridView Control (VB)</span></span>
====================
<span data-ttu-id="515cb-105">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="515cb-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="515cb-106">[下載範例應用程式](http://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_12_VB.exe)或[下載 PDF](using-templatefields-in-the-gridview-control-vb/_static/datatutorial12vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="515cb-106">[Download Sample App](http://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_12_VB.exe) or [Download PDF](using-templatefields-in-the-gridview-control-vb/_static/datatutorial12vb1.pdf)</span></span>

> <span data-ttu-id="515cb-107">為了提供彈性，GridView 會提供 TemplateField，會呈現使用範本。</span><span class="sxs-lookup"><span data-stu-id="515cb-107">To provide flexibility, the GridView offers the TemplateField, which renders using a template.</span></span> <span data-ttu-id="515cb-108">範本可以包含混合的靜態 HTML Web 控制項及資料繫結語法。</span><span class="sxs-lookup"><span data-stu-id="515cb-108">A template can include a mix of static HTML, Web controls, and databinding syntax.</span></span> <span data-ttu-id="515cb-109">在本教學課程中，我們將檢驗如何使用 TemplateField 達到更高的自訂與 GridView 控制項。</span><span class="sxs-lookup"><span data-stu-id="515cb-109">In this tutorial we'll examine how to use the TemplateField to achieve a greater degree of customization with the GridView control.</span></span>


## <a name="introduction"></a><span data-ttu-id="515cb-110">簡介</span><span class="sxs-lookup"><span data-stu-id="515cb-110">Introduction</span></span>

<span data-ttu-id="515cb-111">GridView 組成一組欄位，指出來自哪些屬性`DataSource`要包含在轉譯的輸出，以及資料顯示方式。</span><span class="sxs-lookup"><span data-stu-id="515cb-111">The GridView is composed of a set of fields that indicate what properties from the `DataSource` are to be included in the rendered output along with how the data will be displayed.</span></span> <span data-ttu-id="515cb-112">資料值顯示為文字 BoundField 最簡單的欄位類型。</span><span class="sxs-lookup"><span data-stu-id="515cb-112">The simplest field type is the BoundField, which displays a data value as text.</span></span> <span data-ttu-id="515cb-113">其他欄位型別顯示使用替代的 HTML 項目資料。</span><span class="sxs-lookup"><span data-stu-id="515cb-113">Other field types display the data using alternate HTML elements.</span></span> <span data-ttu-id="515cb-114">CheckBoxField，比方說，將呈現為指定的資料欄位; 的值取決於其核取的狀態的核取方塊ImageField 呈現的影像的影像來源為基礎的指定的資料欄位。</span><span class="sxs-lookup"><span data-stu-id="515cb-114">The CheckBoxField, for example, renders as a checkbox whose checked state depends on the value of a specified data field; the ImageField renders an image whose image source is based upon a specified data field.</span></span> <span data-ttu-id="515cb-115">呈現超連結和按鈕的狀態取決於基礎的資料欄位值，可以使用 HyperLinkField 和 ButtonField 欄位類型。</span><span class="sxs-lookup"><span data-stu-id="515cb-115">Hyperlinks and buttons whose state depends on an underlying data field value can be rendered using the HyperLinkField and ButtonField field types.</span></span>

<span data-ttu-id="515cb-116">雖然 CheckBoxField、 ImageField、 HyperLinkField 和 ButtonField 欄位型別允許替代的檢視的資料，它們仍是相當有限，相對於格式。</span><span class="sxs-lookup"><span data-stu-id="515cb-116">While the CheckBoxField, ImageField, HyperLinkField, and ButtonField field types allow for an alternate view of the data, they still are fairly limited with respect to formatting.</span></span> <span data-ttu-id="515cb-117">CheckBoxField 只能顯示單一的核取方塊，而 ImageField 只能顯示單一映像。</span><span class="sxs-lookup"><span data-stu-id="515cb-117">A CheckBoxField can only display a single checkbox, whereas an ImageField can only display a single image.</span></span> <span data-ttu-id="515cb-118">特定欄位要顯示的文字，核取方塊，如果*和*映像，全都以不同的資料欄位值為基礎？</span><span class="sxs-lookup"><span data-stu-id="515cb-118">What if a particular field needs to display some text, a checkbox, *and* an image, all based upon different data field values?</span></span> <span data-ttu-id="515cb-119">或者，如果我們想要顯示 使用核取方塊、 影像、 超連結或按鈕以外的 Web 控制項的資料？</span><span class="sxs-lookup"><span data-stu-id="515cb-119">Or what if we wanted to display the data using a Web control other than the CheckBox, Image, HyperLink, or Button?</span></span> <span data-ttu-id="515cb-120">此外，BoundField 限制它的顯示畫面至單一資料欄位。</span><span class="sxs-lookup"><span data-stu-id="515cb-120">Furthermore, the BoundField limits its display to a single data field.</span></span> <span data-ttu-id="515cb-121">假如我們想要顯示單一的 GridView 資料行中的兩個或多個資料欄位值？</span><span class="sxs-lookup"><span data-stu-id="515cb-121">What if we wanted to show two or more data field values in a single GridView column?</span></span>

<span data-ttu-id="515cb-122">GridView 提供 TemplateField，會呈現使用以容納此程度的彈性*範本*。</span><span class="sxs-lookup"><span data-stu-id="515cb-122">To accommodate this level of flexibility the GridView offers the TemplateField, which renders using a *template*.</span></span> <span data-ttu-id="515cb-123">範本可以包含混合的靜態 HTML Web 控制項及資料繫結語法。</span><span class="sxs-lookup"><span data-stu-id="515cb-123">A template can include a mix of static HTML, Web controls, and databinding syntax.</span></span> <span data-ttu-id="515cb-124">此外，TemplateField 有各式各樣的範本可用來自訂轉譯為不同的情況。</span><span class="sxs-lookup"><span data-stu-id="515cb-124">Furthermore, the TemplateField has a variety of templates that can be used to customize the rendering for different situations.</span></span> <span data-ttu-id="515cb-125">例如，`ItemTemplate`用來呈現每個資料列，資料格預設但`EditItemTemplate`範本可以用來編輯資料時，自訂介面。</span><span class="sxs-lookup"><span data-stu-id="515cb-125">For example, the `ItemTemplate` is used by default to render the cell for each row, but the `EditItemTemplate` template can be used to customize the interface when editing data.</span></span>

<span data-ttu-id="515cb-126">在本教學課程中，我們將檢驗如何使用 TemplateField 達到更高的自訂與 GridView 控制項。</span><span class="sxs-lookup"><span data-stu-id="515cb-126">In this tutorial we'll examine how to use the TemplateField to achieve a greater degree of customization with the GridView control.</span></span> <span data-ttu-id="515cb-127">在 [前述教學課程](custom-formatting-based-upon-data-vb.md)我們了解如何自訂格式的基礎的資料使用基礎`DataBound`和`RowDataBound`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="515cb-127">In the [preceding tutorial](custom-formatting-based-upon-data-vb.md) we saw how to customize the formatting based on the underlying data using the `DataBound` and `RowDataBound` event handlers.</span></span> <span data-ttu-id="515cb-128">自訂格式的基礎資料為基礎的另一種方式藉由呼叫的格式化設定方法在範本內。</span><span class="sxs-lookup"><span data-stu-id="515cb-128">Another way to customize the formatting based on the underlying data is by calling formatting methods from within a template.</span></span> <span data-ttu-id="515cb-129">在本教學課程中，我們將探討這項技術。</span><span class="sxs-lookup"><span data-stu-id="515cb-129">We'll look at this technique in this tutorial as well.</span></span>

<span data-ttu-id="515cb-130">在本教學課程中，我們將使用 TemplateFields 自訂的員工清單的外觀。</span><span class="sxs-lookup"><span data-stu-id="515cb-130">For this tutorial we will use TemplateFields to customize the appearance of a list of employees.</span></span> <span data-ttu-id="515cb-131">具體來說，我們會列出所有員工，但會顯示員工的名字和姓氏的名稱，在一個資料行、 在日曆控制項，以及 [狀態] 欄，指出多少天後他們已被採用公司雇用日期。</span><span class="sxs-lookup"><span data-stu-id="515cb-131">Specifically, we'll list all of the employees, but will display the employee's first and last names in one column, their hire date in a Calendar control, and a status column that indicates how many days they've been employed at the company.</span></span>


<span data-ttu-id="515cb-132">[![可用來自訂顯示三個 TemplateFields](using-templatefields-in-the-gridview-control-vb/_static/image2.png)](using-templatefields-in-the-gridview-control-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-132">[![Three TemplateFields are Used to Customize the Display](using-templatefields-in-the-gridview-control-vb/_static/image2.png)](using-templatefields-in-the-gridview-control-vb/_static/image1.png)</span></span>

<span data-ttu-id="515cb-133">**圖 1**： 用來自訂顯示三個 TemplateFields ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-133">**Figure 1**: Three TemplateFields are Used to Customize the Display ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image3.png))</span></span>


## <a name="step-1-binding-the-data-to-the-gridview"></a><span data-ttu-id="515cb-134">步驟 1: 將資料繫結至 GridView</span><span class="sxs-lookup"><span data-stu-id="515cb-134">Step 1: Binding the Data to the GridView</span></span>

<span data-ttu-id="515cb-135">在報告情況下，您需要使用 TemplateFields 來自訂外觀，我覺得最簡單的方式著手建立第一次包含只 BoundFields 的 GridView 控制項，然後新增新的 TemplateFields 或轉換至現有的 BoundFields視 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="515cb-135">In reporting scenarios where you need to use TemplateFields to customize the appearance, I find it easiest to start by creating a GridView control that contains just BoundFields first and then to add new TemplateFields or convert the existing BoundFields to TemplateFields as needed.</span></span> <span data-ttu-id="515cb-136">因此，現在就開始本教學課程中加入透過設計工具頁面上的 GridView 和繫結至傳回的員工清單 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="515cb-136">Therefore, let's start this tutorial by adding a GridView to the page through the Designer and binding it to an ObjectDataSource that returns the list of employees.</span></span> <span data-ttu-id="515cb-137">這些步驟將為每個員工欄位，以建立與 BoundFields GridView。</span><span class="sxs-lookup"><span data-stu-id="515cb-137">These steps will create a GridView with BoundFields for each of the employee fields.</span></span>

<span data-ttu-id="515cb-138">開啟`GridViewTemplateField.aspx`頁面上，然後從 [工具箱] 拖曳至設計工具拖曳的 GridView。</span><span class="sxs-lookup"><span data-stu-id="515cb-138">Open the `GridViewTemplateField.aspx` page and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="515cb-139">從 GridView 的智慧標籤選擇 加入新的 ObjectDataSource 控制項叫用`EmployeesBLL`類別的`GetEmployees()`方法。</span><span class="sxs-lookup"><span data-stu-id="515cb-139">From the GridView's smart tag choose to add a new ObjectDataSource control that invokes the `EmployeesBLL` class's `GetEmployees()` method.</span></span>


<span data-ttu-id="515cb-140">[![加入新的 ObjectDataSource 控制項叫用 GetEmployees() 方法](using-templatefields-in-the-gridview-control-vb/_static/image5.png)](using-templatefields-in-the-gridview-control-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-140">[![Add a New ObjectDataSource Control that Invokes the GetEmployees() Method](using-templatefields-in-the-gridview-control-vb/_static/image5.png)](using-templatefields-in-the-gridview-control-vb/_static/image4.png)</span></span>

<span data-ttu-id="515cb-141">**圖 2**： 將新的 ObjectDataSource 控制項加入該 Invokes`GetEmployees()`方法 ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-141">**Figure 2**: Add a New ObjectDataSource Control that Invokes the `GetEmployees()` Method ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image6.png))</span></span>


<span data-ttu-id="515cb-142">這種方式中的繫結 GridView 會自動將新增 BoundField 的每個員工的屬性： `EmployeeID`， `LastName`， `FirstName`， `Title`， `HireDate`， `ReportsTo`，和`Country`。</span><span class="sxs-lookup"><span data-stu-id="515cb-142">Binding the GridView in this manner will automatically add a BoundField for each of the employee properties: `EmployeeID`, `LastName`, `FirstName`, `Title`, `HireDate`, `ReportsTo`, and `Country`.</span></span> <span data-ttu-id="515cb-143">這份報告讓我們不需要考慮顯示`EmployeeID`， `ReportsTo`，或`Country`屬性。</span><span class="sxs-lookup"><span data-stu-id="515cb-143">For this report let's not bother with displaying the `EmployeeID`, `ReportsTo`, or `Country` properties.</span></span> <span data-ttu-id="515cb-144">若要移除這些 BoundFields 中，您可以：</span><span class="sxs-lookup"><span data-stu-id="515cb-144">To remove these BoundFields you can:</span></span>

- <span data-ttu-id="515cb-145">從 GridView 的智慧標籤的 [編輯資料行] 連結使用欄位對話方塊中，按一下，即可啟動此對話方塊。</span><span class="sxs-lookup"><span data-stu-id="515cb-145">Use the Fields dialog box click on the Edit Columns link from the GridView's smart tag to bring up this dialog box.</span></span> <span data-ttu-id="515cb-146">接下來，選取左下方從 BoundFields 清單，然後按一下紅色的 X 按鈕移除 BoundField。</span><span class="sxs-lookup"><span data-stu-id="515cb-146">Next, select the BoundFields from the lower left list and click the red X button to remove the BoundField.</span></span>
- <span data-ttu-id="515cb-147">以手動方式編輯 GridView 的宣告式語法，從來源檢視、 刪除`<asp:BoundField>`BoundField 您想要移除的項目。</span><span class="sxs-lookup"><span data-stu-id="515cb-147">Edit the GridView's declarative syntax by hand from the Source view, delete the `<asp:BoundField>` element for the BoundField you wish to remove.</span></span>

<span data-ttu-id="515cb-148">已移除之後`EmployeeID`， `ReportsTo`，和`Country`BoundFields，GridView 的標記看起來應該像：</span><span class="sxs-lookup"><span data-stu-id="515cb-148">After you have removed the `EmployeeID`, `ReportsTo`, and `Country` BoundFields, your GridView's markup should look like:</span></span>


[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample1.aspx)]

<span data-ttu-id="515cb-149">請花一點時間瀏覽器中檢視進度。</span><span class="sxs-lookup"><span data-stu-id="515cb-149">Take a moment to view our progress in a browser.</span></span> <span data-ttu-id="515cb-150">此時應該會看到含有記錄資料表每一位員工和四個資料行： 一個用於員工的姓氏，一個用於他們的名字、 標題，其中，一個用於其雇用日期。</span><span class="sxs-lookup"><span data-stu-id="515cb-150">At this point you should see a table with a record for each employee and four columns: one for the employee's last name, one for their first name, one for their title, and one for their hire date.</span></span>


<span data-ttu-id="515cb-151">[![LastName、 FirstName、 標題和 HireDate 欄位會顯示每個員工](using-templatefields-in-the-gridview-control-vb/_static/image8.png)](using-templatefields-in-the-gridview-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-151">[![The LastName, FirstName, Title, and HireDate Fields are Displayed for Each Employee](using-templatefields-in-the-gridview-control-vb/_static/image8.png)](using-templatefields-in-the-gridview-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="515cb-152">**圖 3**: `LastName`， `FirstName`， `Title`，並`HireDate`欄位會顯示每個員工 ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-152">**Figure 3**: The `LastName`, `FirstName`, `Title`, and `HireDate` Fields are Displayed for Each Employee ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image9.png))</span></span>


## <a name="step-2-displaying-the-first-and-last-names-in-a-single-column"></a><span data-ttu-id="515cb-153">步驟 2： 顯示單一資料行中的第一個和最後一個名稱</span><span class="sxs-lookup"><span data-stu-id="515cb-153">Step 2: Displaying the First and Last Names in a Single Column</span></span>

<span data-ttu-id="515cb-154">目前，每一位員工的名字和姓氏會顯示在個別的資料行。</span><span class="sxs-lookup"><span data-stu-id="515cb-154">Currently, each employee's first and last names are displayed in a separate column.</span></span> <span data-ttu-id="515cb-155">可能是很好將它們結合成單一資料行。</span><span class="sxs-lookup"><span data-stu-id="515cb-155">It might be nice to combine them into a single column instead.</span></span> <span data-ttu-id="515cb-156">若要這麼做，我們需要使用 TemplateField。</span><span class="sxs-lookup"><span data-stu-id="515cb-156">To accomplish this we need to use a TemplateField.</span></span> <span data-ttu-id="515cb-157">我們可以加入新的 TemplateField、 加入資料繫結語法，與所需的標記，然後刪除`FirstName`並`LastName`BoundFields，或者我們可以將轉換`FirstName`BoundField 到 TemplateField，編輯包含 TemplateField`LastName`值，然後再移除`LastName`BoundField。</span><span class="sxs-lookup"><span data-stu-id="515cb-157">We can either add a new TemplateField, add to it the needed markup and databinding syntax, and then delete the `FirstName` and `LastName` BoundFields, or we can convert the `FirstName` BoundField into a TemplateField, edit the TemplateField to include the `LastName` value, and then remove the `LastName` BoundField.</span></span>

<span data-ttu-id="515cb-158">這兩種方法 net 相同的結果，不過我想將 BoundFields 轉換成 TemplateFields 可能的話，因為轉換會自動新增的個人`ItemTemplate`和`EditItemTemplate`Web 控制項與資料繫結語法，來模擬外觀和 BoundField 的功能。</span><span class="sxs-lookup"><span data-stu-id="515cb-158">Both approaches net the same result, but personally I like converting BoundFields to TemplateFields when possible because the conversion automatically adds an `ItemTemplate` and `EditItemTemplate` with Web controls and databinding syntax to mimic the appearance and functionality of the BoundField.</span></span> <span data-ttu-id="515cb-159">優點是，我們需要進行較少工作使用 TemplateField 轉換程序會有執行某些工作的我們。</span><span class="sxs-lookup"><span data-stu-id="515cb-159">The benefit is that we'll need to do less work with the TemplateField as the conversion process will have performed some of the work for us.</span></span>

<span data-ttu-id="515cb-160">若要轉換為 TemplateField 現有 BoundField，請按一下 GridView 的智慧標籤，啟動 [欄位] 對話方塊中的 [編輯資料行] 連結。</span><span class="sxs-lookup"><span data-stu-id="515cb-160">To convert an existing BoundField into a TemplateField, click on the Edit Columns link from the GridView's smart tag, bringing up the Fields dialog box.</span></span> <span data-ttu-id="515cb-161">選取來源檔的清單中較低的左上角，然後按一下 在右下角的"轉換為 TemplateField 到這個欄位 」 連結 BoundField。</span><span class="sxs-lookup"><span data-stu-id="515cb-161">Select the BoundField to convert from the list in the lower left corner and then click the "Convert this field into a TemplateField" link in the bottom right corner.</span></span>


<span data-ttu-id="515cb-162">[![BoundField 轉換從 [欄位] 對話方塊中的 TemplateField](using-templatefields-in-the-gridview-control-vb/_static/image11.png)](using-templatefields-in-the-gridview-control-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-162">[![Convert a BoundField Into a TemplateField from the Fields Dialog Box](using-templatefields-in-the-gridview-control-vb/_static/image11.png)](using-templatefields-in-the-gridview-control-vb/_static/image10.png)</span></span>

<span data-ttu-id="515cb-163">**圖 4**： 從 [欄位] 對話方塊中轉換為 BoundField 到 TemplateField ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-163">**Figure 4**: Convert a BoundField Into a TemplateField from the Fields Dialog Box ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image12.png))</span></span>


<span data-ttu-id="515cb-164">請繼續進行，並將轉換`FirstName`BoundField TemplateField 到。</span><span class="sxs-lookup"><span data-stu-id="515cb-164">Go ahead and convert the `FirstName` BoundField into a TemplateField.</span></span> <span data-ttu-id="515cb-165">這項變更之後並無差別 perceptive 設計工具中。</span><span class="sxs-lookup"><span data-stu-id="515cb-165">After this change there's no perceptive difference in the Designer.</span></span> <span data-ttu-id="515cb-166">這是因為轉換為 TemplateField BoundField 建立維護的外觀與風格 BoundField TemplateField。</span><span class="sxs-lookup"><span data-stu-id="515cb-166">This is because converting the BoundField into a TemplateField creates a TemplateField that maintains the look and feel of the BoundField.</span></span> <span data-ttu-id="515cb-167">儘管那里沒有視覺化差異在此時設計工具中的，此轉換程序已取代 BoundField 的宣告式語法- `<asp:BoundField DataField="FirstName" HeaderText="FirstName" SortExpression="FirstName" />` -使用下列的 TemplateField 語法：</span><span class="sxs-lookup"><span data-stu-id="515cb-167">Despite there being no visual difference at this point in the Designer, this conversion process has replaced the BoundField's declarative syntax - `<asp:BoundField DataField="FirstName" HeaderText="FirstName" SortExpression="FirstName" />` - with the following TemplateField syntax:</span></span>


[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample2.aspx)]

<span data-ttu-id="515cb-168">TemplateField 如您所見，包含兩個範本`ItemTemplate`具有標籤的`Text`屬性設定的值為`FirstName`資料欄位，和`EditItemTemplate`搭配 TextBox 控制項`Text`屬性也設定若要`FirstName`資料欄位。</span><span class="sxs-lookup"><span data-stu-id="515cb-168">As you can see, the TemplateField consists of two templates an `ItemTemplate` that has a Label whose `Text` property is set to the value of the `FirstName` data field, and an `EditItemTemplate` with a TextBox control whose `Text` property is also set to the `FirstName` data field.</span></span> <span data-ttu-id="515cb-169">資料繫結語法- `<%# Bind("fieldName") %>` -指出資料欄位*`fieldName`* 繫結至指定的 Web 控制項屬性。</span><span class="sxs-lookup"><span data-stu-id="515cb-169">The databinding syntax - `<%# Bind("fieldName") %>` - indicates that the data field *`fieldName`* is bound to the specified Web control property.</span></span>

<span data-ttu-id="515cb-170">若要新增`LastName`資料欄位值為此我們需要加入另一個 Label Web 控制項中的 TemplateField`ItemTemplate`並繫結其`Text`屬性設`LastName`。</span><span class="sxs-lookup"><span data-stu-id="515cb-170">To add the `LastName` data field value to this TemplateField we need to add another Label Web control in the `ItemTemplate` and bind its `Text` property to `LastName`.</span></span> <span data-ttu-id="515cb-171">這可以是以手動方式或透過設計工具完成。</span><span class="sxs-lookup"><span data-stu-id="515cb-171">This can be accomplished either by hand or through the Designer.</span></span> <span data-ttu-id="515cb-172">若要以手動方式執行，只要新增適當的宣告式語法， `ItemTemplate`:</span><span class="sxs-lookup"><span data-stu-id="515cb-172">To do it by hand, simply add the appropriate declarative syntax to the `ItemTemplate`:</span></span>


[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample3.aspx)]

<span data-ttu-id="515cb-173">若要將它加入透過設計工具中，按一下從 GridView 的智慧標籤的 [編輯範本] 連結。</span><span class="sxs-lookup"><span data-stu-id="515cb-173">To add it through the Designer, click on the Edit Templates link from the GridView's smart tag.</span></span> <span data-ttu-id="515cb-174">這會顯示 GridView 的範本編輯介面。</span><span class="sxs-lookup"><span data-stu-id="515cb-174">This will display the GridView's template editing interface.</span></span> <span data-ttu-id="515cb-175">在此介面的智慧標籤是一份 GridView 中的範本。</span><span class="sxs-lookup"><span data-stu-id="515cb-175">In this interface's smart tag is a list of the templates in the GridView.</span></span> <span data-ttu-id="515cb-176">因為我們只需要一個 TemplateField 此時，只有列在下拉式清單中的範本會針對這些範本`FirstName`連同 TemplateField`EmptyDataTemplate`和`PagerTemplate`。</span><span class="sxs-lookup"><span data-stu-id="515cb-176">Since we only have one TemplateField at this point, the only templates listed in the drop-down list are those templates for the `FirstName` TemplateField along with the `EmptyDataTemplate` and `PagerTemplate`.</span></span> <span data-ttu-id="515cb-177">`EmptyDataTemplate`範本，如果指定，會用來呈現 GridView 的輸出，如果資料繫結至 GridView; 中沒有任何結果`PagerTemplate`，如果指定，用來呈現的 GridView 會支援分頁的分頁介面。</span><span class="sxs-lookup"><span data-stu-id="515cb-177">The `EmptyDataTemplate` template, if specified, is used to render the GridView's output if there are no results in the data bound to the GridView; the `PagerTemplate`, if specified, is used to render the paging interface for a GridView that supports paging.</span></span>


<span data-ttu-id="515cb-178">[![GridView 的範本可以透過設計工具進行編輯](using-templatefields-in-the-gridview-control-vb/_static/image14.png)](using-templatefields-in-the-gridview-control-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-178">[![The GridView's Templates Can Be Edited Through the Designer](using-templatefields-in-the-gridview-control-vb/_static/image14.png)](using-templatefields-in-the-gridview-control-vb/_static/image13.png)</span></span>

<span data-ttu-id="515cb-179">**圖 5**: GridView 的範本可以是編輯透過設計工具 ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-179">**Figure 5**: The GridView's Templates Can Be Edited Through the Designer ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image15.png))</span></span>


<span data-ttu-id="515cb-180">若也要顯示`LastName`中`FirstName`TemplateField 拖曳 Label 控制項從工具箱拖曳到`FirstName`TemplateField 的`ItemTemplate`GridView 裡的範本編輯介面。</span><span class="sxs-lookup"><span data-stu-id="515cb-180">To also display the `LastName` in the `FirstName` TemplateField drag the Label control from the Toolbox into the `FirstName` TemplateField's `ItemTemplate` in the GridView's template editing interface.</span></span>


<span data-ttu-id="515cb-181">[![將標籤 Web 控制項加入 FirstName TemplateField 的 ItemTemplate](using-templatefields-in-the-gridview-control-vb/_static/image17.png)](using-templatefields-in-the-gridview-control-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-181">[![Add a Label Web Control to the FirstName TemplateField's ItemTemplate](using-templatefields-in-the-gridview-control-vb/_static/image17.png)](using-templatefields-in-the-gridview-control-vb/_static/image16.png)</span></span>

<span data-ttu-id="515cb-182">**圖 6**： 加入標籤 Web 控制項來`FirstName`TemplateField 的 ItemTemplate ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-182">**Figure 6**: Add a Label Web Control to the `FirstName` TemplateField's ItemTemplate ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image18.png))</span></span>


<span data-ttu-id="515cb-183">此時加入 TemplateField 標籤 Web 控制項有其`Text`屬性設定為 「 標籤 」。</span><span class="sxs-lookup"><span data-stu-id="515cb-183">At this point the Label Web control added to the TemplateField has its `Text` property set to "Label".</span></span> <span data-ttu-id="515cb-184">我們要使這個屬性繫結至的值，請變更此`LastName`資料改為欄位。</span><span class="sxs-lookup"><span data-stu-id="515cb-184">We need to change this so that this property is bound to the value of the `LastName` data field instead.</span></span> <span data-ttu-id="515cb-185">若要完成此標籤控制項的智慧標籤上按一下，然後選擇 [編輯資料繫結] 選項。</span><span class="sxs-lookup"><span data-stu-id="515cb-185">To accomplish this click on the Label control's smart tag and choose the Edit DataBindings option.</span></span>


<span data-ttu-id="515cb-186">[![從標籤的智慧標籤中選擇 編輯資料繫結選項](using-templatefields-in-the-gridview-control-vb/_static/image20.png)](using-templatefields-in-the-gridview-control-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-186">[![Choose the Edit DataBindings Option from the Label's Smart Tag](using-templatefields-in-the-gridview-control-vb/_static/image20.png)](using-templatefields-in-the-gridview-control-vb/_static/image19.png)</span></span>

<span data-ttu-id="515cb-187">**圖 7**： 從標籤的智慧標籤中選擇 編輯資料繫結選項 ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-187">**Figure 7**: Choose the Edit DataBindings Option from the Label's Smart Tag ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image21.png))</span></span>


<span data-ttu-id="515cb-188">這會顯示資料繫結 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="515cb-188">This will bring up the DataBindings dialog box.</span></span> <span data-ttu-id="515cb-189">從這裡您可以選取要參與資料繫結，從左側清單，然後選擇 繫結至資料，從下拉式清單，右側欄位的屬性。</span><span class="sxs-lookup"><span data-stu-id="515cb-189">From here you can select the property to participate in databinding from the list on the left and choose the field to bind the data to from the drop-down list on the right.</span></span> <span data-ttu-id="515cb-190">選擇`Text`左邊的屬性和`LastName`欄位的右邊，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="515cb-190">Choose the `Text` property from the left and the `LastName` field from the right and click OK.</span></span>


<span data-ttu-id="515cb-191">[![文字屬性繫結到 LastName 資料欄位](using-templatefields-in-the-gridview-control-vb/_static/image23.png)](using-templatefields-in-the-gridview-control-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-191">[![Bind the Text Property to the LastName Data Field](using-templatefields-in-the-gridview-control-vb/_static/image23.png)](using-templatefields-in-the-gridview-control-vb/_static/image22.png)</span></span>

<span data-ttu-id="515cb-192">**圖 8**： 繫結`Text`屬性設`LastName`資料欄位 ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-192">**Figure 8**: Bind the `Text` Property to the `LastName` Data Field ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image24.png))</span></span>


> [!NOTE]
> <span data-ttu-id="515cb-193">DataBindings 對話方塊可讓您指出是否要執行雙向資料繫結。</span><span class="sxs-lookup"><span data-stu-id="515cb-193">The DataBindings dialog box allows you to indicate whether to perform two-way databinding.</span></span> <span data-ttu-id="515cb-194">如果將此選項保留未核取的資料繫結語法`<%# Eval("LastName")%>`而不是用於將`<%# Bind("LastName")%>`。</span><span class="sxs-lookup"><span data-stu-id="515cb-194">If you leave this unchecked, the databinding syntax `<%# Eval("LastName")%>` will be used instead of `<%# Bind("LastName")%>`.</span></span> <span data-ttu-id="515cb-195">本教學課程中，兩種方法是正常的。</span><span class="sxs-lookup"><span data-stu-id="515cb-195">Either approach is fine for this tutorial.</span></span> <span data-ttu-id="515cb-196">雙向資料繫結就變得重要插入及編輯資料時。</span><span class="sxs-lookup"><span data-stu-id="515cb-196">Two-way databinding becomes important when inserting and editing data.</span></span> <span data-ttu-id="515cb-197">只顯示資料，不過，兩種方法將同樣適用。</span><span class="sxs-lookup"><span data-stu-id="515cb-197">For simply displaying data, however, either approach will work equally well.</span></span> <span data-ttu-id="515cb-198">在未來的教學課程中，我們將討論在詳細資料中的雙向資料繫結。</span><span class="sxs-lookup"><span data-stu-id="515cb-198">We'll discuss two-way databinding in detail in future tutorials.</span></span>


<span data-ttu-id="515cb-199">請花一點時間才能檢視此頁面，透過瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="515cb-199">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="515cb-200">如您所見，GridView 仍然會包含四個資料行;不過，`FirstName`資料行現在會列出*兩者*`FirstName`和`LastName`資料欄位值。</span><span class="sxs-lookup"><span data-stu-id="515cb-200">As you can see, the GridView still includes four columns; however, the `FirstName` column now lists *both* the `FirstName` and `LastName` data field values.</span></span>


<span data-ttu-id="515cb-201">[![FirstName 和 LastName 值會顯示單一資料行中](using-templatefields-in-the-gridview-control-vb/_static/image26.png)](using-templatefields-in-the-gridview-control-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-201">[![Both the FirstName and LastName Values are Shown in a Single Column](using-templatefields-in-the-gridview-control-vb/_static/image26.png)](using-templatefields-in-the-gridview-control-vb/_static/image25.png)</span></span>

<span data-ttu-id="515cb-202">**圖 9**： 同時`FirstName`並`LastName`值會顯示單一資料行中 ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-202">**Figure 9**: Both the `FirstName` and `LastName` Values are Shown in a Single Column ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image27.png))</span></span>


<span data-ttu-id="515cb-203">若要完成此第一個步驟，移除`LastName`BoundField 和重新命名`FirstName`TemplateField 的`HeaderText`"Name"屬性。</span><span class="sxs-lookup"><span data-stu-id="515cb-203">To complete this first step, remove the `LastName` BoundField and rename the `FirstName` TemplateField's `HeaderText` property to "Name".</span></span> <span data-ttu-id="515cb-204">在這些變更之後 GridView 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="515cb-204">After these changes the GridView's declarative markup should look like the following:</span></span>


[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample4.aspx)]


<span data-ttu-id="515cb-205">[![每位員工的第一個和最後一個的名稱會顯示在一個資料行](using-templatefields-in-the-gridview-control-vb/_static/image29.png)](using-templatefields-in-the-gridview-control-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-205">[![Each Employee's First and Last Names are Displayed in One Column](using-templatefields-in-the-gridview-control-vb/_static/image29.png)](using-templatefields-in-the-gridview-control-vb/_static/image28.png)</span></span>

<span data-ttu-id="515cb-206">**圖 10**： 每個員工的第一個和最後一個的名稱會顯示一個資料行中 ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-206">**Figure 10**: Each Employee's First and Last Names are Displayed in One Column ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image30.png))</span></span>


## <a name="step-3-using-the-calendar-control-to-display-thehireddatefield"></a><span data-ttu-id="515cb-207">步驟 3： 使用 Calendar 控制項來顯示`HiredDate`欄位</span><span class="sxs-lookup"><span data-stu-id="515cb-207">Step 3: Using the Calendar Control to Display the`HiredDate`Field</span></span>

<span data-ttu-id="515cb-208">在 GridView 中以文字顯示資料欄位值是簡單，只要使用 BoundField 就行了。</span><span class="sxs-lookup"><span data-stu-id="515cb-208">Displaying a data field value as text in a GridView is as simple as using a BoundField.</span></span> <span data-ttu-id="515cb-209">適用於特定案例中，不過，資料是最適合使用來表示特定的 Web 控制項而非只是文字。</span><span class="sxs-lookup"><span data-stu-id="515cb-209">For certain scenarios, however, the data is best expressed using a particular Web control instead of just text.</span></span> <span data-ttu-id="515cb-210">可以使用 TemplateFields 這類自訂資料的顯示。</span><span class="sxs-lookup"><span data-stu-id="515cb-210">Such customization of the display of data is possible with TemplateFields.</span></span> <span data-ttu-id="515cb-211">比方說，而非以文字顯示員工的雇用日期，我們無法顯示行事曆 (使用[行事曆控制項](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar(VS.80).aspx)) 使用其雇用日期反白顯示。</span><span class="sxs-lookup"><span data-stu-id="515cb-211">For example, rather than display the employee's hire date as text, we could show a calendar (using [the Calendar control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar(VS.80).aspx)) with their hire date highlighted.</span></span>

<span data-ttu-id="515cb-212">若要達成此目的，先轉換`HiredDate`BoundField TemplateField 到。</span><span class="sxs-lookup"><span data-stu-id="515cb-212">To accomplish this, start by converting the `HiredDate` BoundField into a TemplateField.</span></span> <span data-ttu-id="515cb-213">只要移至 GridView 的智慧標籤，然後按一下 [編輯資料行] 連結，啟動 [欄位] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="515cb-213">Simply go to the GridView's smart tag and click the Edit Columns link, bringing up the Fields dialog box.</span></span> <span data-ttu-id="515cb-214">選取`HiredDate`BoundField，然後按一下 」 這個欄位轉換為 TemplateField。 」</span><span class="sxs-lookup"><span data-stu-id="515cb-214">Select the `HiredDate` BoundField and click "Convert this field into a TemplateField."</span></span>


<span data-ttu-id="515cb-215">[![HiredDate BoundField 轉換為 TemplateField](using-templatefields-in-the-gridview-control-vb/_static/image32.png)](using-templatefields-in-the-gridview-control-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-215">[![Convert the HiredDate BoundField Into a TemplateField](using-templatefields-in-the-gridview-control-vb/_static/image32.png)](using-templatefields-in-the-gridview-control-vb/_static/image31.png)</span></span>

<span data-ttu-id="515cb-216">**圖 11**： 轉換`HiredDate`TemplateField 到 BoundField ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-216">**Figure 11**: Convert the `HiredDate` BoundField Into a TemplateField ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image33.png))</span></span>


<span data-ttu-id="515cb-217">如我們在步驟 2 中所見的這樣會取代 BoundField 包含 TemplateField`ItemTemplate`並`EditItemTemplate`其標籤與文字方塊使用其`Text`屬性繫結至`HiredDate`值使用的資料繫結語法`<%# Bind("HiredDate")%>`.</span><span class="sxs-lookup"><span data-stu-id="515cb-217">As we saw in Step 2, this will replace the BoundField with a TemplateField that contains an `ItemTemplate` and `EditItemTemplate` with a Label and TextBox whose `Text` properties are bound to the `HiredDate` value using the databinding syntax `<%# Bind("HiredDate")%>`.</span></span>

<span data-ttu-id="515cb-218">若要使用日曆控制項中取代的文字，請移除標籤，並新增日曆控制項中編輯範本。</span><span class="sxs-lookup"><span data-stu-id="515cb-218">To replace the text with a Calendar control, edit the template by removing the Label and adding a Calendar control.</span></span> <span data-ttu-id="515cb-219">從設計工具中，選取 從 GridView 的智慧標籤的 編輯範本，然後選擇`HireDate`TemplateField 的`ItemTemplate`從下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="515cb-219">From the Designer, select Edit Templates from the GridView's smart tag and choose the `HireDate` TemplateField's `ItemTemplate` from the drop-down list.</span></span> <span data-ttu-id="515cb-220">接下來，刪除標籤控制項，並將日曆控制項從 工具箱 拖曳至 範本的編輯介面。</span><span class="sxs-lookup"><span data-stu-id="515cb-220">Next, delete the Label control and drag a Calendar control from the Toolbox into the template editing interface.</span></span>


<span data-ttu-id="515cb-221">[![加入行事曆控制項來 HireDate TemplateField 的 ItemTemplate](using-templatefields-in-the-gridview-control-vb/_static/image35.png)](using-templatefields-in-the-gridview-control-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-221">[![Add a Calendar Control to the HireDate TemplateField's ItemTemplate](using-templatefields-in-the-gridview-control-vb/_static/image35.png)](using-templatefields-in-the-gridview-control-vb/_static/image34.png)</span></span>

<span data-ttu-id="515cb-222">**圖 12**： 新增至行事曆控制項`HireDate`TemplateField 的`ItemTemplate`([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-222">**Figure 12**: Add a Calendar Control to the `HireDate` TemplateField's `ItemTemplate` ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image36.png))</span></span>


<span data-ttu-id="515cb-223">此時在 gridview 裡的每個資料列會包含中的 Calendar 控制項其`HiredDate`TemplateField。</span><span class="sxs-lookup"><span data-stu-id="515cb-223">At this point each row in the GridView will contain a Calendar control in its `HiredDate` TemplateField.</span></span> <span data-ttu-id="515cb-224">不過，員工的實際`HiredDate`日曆控制項，造成每個預設為顯示目前的月份和日期的日曆控制項中未設定值任何位置。</span><span class="sxs-lookup"><span data-stu-id="515cb-224">However, the employee's actual `HiredDate` value is not set anywhere in the Calendar control, causing each Calendar control to default to showing the current month and date.</span></span> <span data-ttu-id="515cb-225">若要解決此問題，我們需要指派每一位員工`HiredDate`行事曆控制項[SelectedDate](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar.selecteddate(VS.80).aspx)並[VisibleDate](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar.visibledate(VS.80).aspx)屬性。</span><span class="sxs-lookup"><span data-stu-id="515cb-225">To remedy this, we need to assign each employee's `HiredDate` to the Calendar control's [SelectedDate](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar.selecteddate(VS.80).aspx) and [VisibleDate](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar.visibledate(VS.80).aspx) properties.</span></span>

<span data-ttu-id="515cb-226">從行事曆控制項的智慧標籤上，選擇 [編輯資料繫結]。</span><span class="sxs-lookup"><span data-stu-id="515cb-226">From the Calendar control's smart tag, choose Edit DataBindings.</span></span> <span data-ttu-id="515cb-227">接下來，繫結兩者`SelectedDate`並`VisibleDate`屬性，以`HiredDate`資料欄位。</span><span class="sxs-lookup"><span data-stu-id="515cb-227">Next, bind both `SelectedDate` and `VisibleDate` properties to the `HiredDate` data field.</span></span>


<span data-ttu-id="515cb-228">[![SelectedDate 和 VisibleDate 屬性繫結至 HiredDate 資料欄位](using-templatefields-in-the-gridview-control-vb/_static/image38.png)](using-templatefields-in-the-gridview-control-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-228">[![Bind the SelectedDate and VisibleDate Properties to the HiredDate Data Field](using-templatefields-in-the-gridview-control-vb/_static/image38.png)](using-templatefields-in-the-gridview-control-vb/_static/image37.png)</span></span>

<span data-ttu-id="515cb-229">**圖 13**： 繫結`SelectedDate`並`VisibleDate`屬性，以`HiredDate`資料欄位 ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-229">**Figure 13**: Bind the `SelectedDate` and `VisibleDate` Properties to the `HiredDate` Data Field ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image39.png))</span></span>


> [!NOTE]
> <span data-ttu-id="515cb-230">日曆控制項選取的日期不一定需要顯示。</span><span class="sxs-lookup"><span data-stu-id="515cb-230">The Calendar control's selected date need not necessarily be visible.</span></span> <span data-ttu-id="515cb-231">例如，行事曆可能有 1 年 8 月<sup>st</sup>，1999 做為選取的日期，但會顯示在目前的月份和年份。</span><span class="sxs-lookup"><span data-stu-id="515cb-231">For example, a Calendar may have August 1<sup>st</sup>, 1999 as the selected date, but be showing the current month and year.</span></span> <span data-ttu-id="515cb-232">月曆控制項的指定選取的日期和可見日期`SelectedDate`和`VisibleDate`屬性。</span><span class="sxs-lookup"><span data-stu-id="515cb-232">The selected date and visible date are specified by the Calendar control's `SelectedDate` and `VisibleDate` properties.</span></span> <span data-ttu-id="515cb-233">因為我們想要同時選取員工`HiredDate`，並確定它會顯示我們需要將這兩個屬性要繫結`HireDate`資料欄位。</span><span class="sxs-lookup"><span data-stu-id="515cb-233">Since we want to both select the employee's `HiredDate` and make sure that it's shown we need to bind both of these properties to the `HireDate` data field.</span></span>


<span data-ttu-id="515cb-234">檢視時的網頁瀏覽器中，行事曆現在會顯示員工的雇用日期的月份，並選取該特定的日期。</span><span class="sxs-lookup"><span data-stu-id="515cb-234">When viewing the page in a browser, the calendar now shows the month of the employee's hired date and selects that particular date.</span></span>


<span data-ttu-id="515cb-235">[![日曆控制項中顯示員工的 HiredDate](using-templatefields-in-the-gridview-control-vb/_static/image41.png)](using-templatefields-in-the-gridview-control-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-235">[![The Employee's HiredDate is Shown in the Calendar Control](using-templatefields-in-the-gridview-control-vb/_static/image41.png)](using-templatefields-in-the-gridview-control-vb/_static/image40.png)</span></span>

<span data-ttu-id="515cb-236">**圖 14**: 員工`HiredDate`顯示日曆控制項中 ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-236">**Figure 14**: The Employee's `HiredDate` is Shown in the Calendar Control ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image42.png))</span></span>


> [!NOTE]
> <span data-ttu-id="515cb-237">相對於所有範例中我們見到目前為止，本教學課程中我們*未*設定`EnableViewState`屬性設`False`針對此 GridView。</span><span class="sxs-lookup"><span data-stu-id="515cb-237">Contrary to all the examples we've seen thus far, for this tutorial we did *not* set `EnableViewState` property to `False` for this GridView.</span></span> <span data-ttu-id="515cb-238">此決策的原因是因為按一下日期的日曆控制項造成回傳，行事曆選取的日期設定為僅需要按一下日期。</span><span class="sxs-lookup"><span data-stu-id="515cb-238">The reason for this decision is because clicking the dates of the Calendar control causes a postback, setting the Calendar's selected date to the date just clicked.</span></span> <span data-ttu-id="515cb-239">GridView 的檢視狀態已停用，不過，在每次回傳 GridView 的資料會重新繫結至其基礎的資料來源，這會導致的行事曆選取的日期設定*回復*員工`HireDate`、 覆寫由使用者選擇日期。</span><span class="sxs-lookup"><span data-stu-id="515cb-239">If the GridView's view state is disabled, however, on each postback the GridView's data is rebound to its underlying data source, which causes the Calendar's selected date to be set *back* to the employee's `HireDate`, overwriting the date chosen by the user.</span></span>


<span data-ttu-id="515cb-240">本教學課程中這是無意義的討論區因為使用者不能更新員工的`HireDate`。</span><span class="sxs-lookup"><span data-stu-id="515cb-240">For this tutorial this is a moot discussion since the user is not able to update the employee's `HireDate`.</span></span> <span data-ttu-id="515cb-241">它可能會設定月曆控制項，使其日期不能選取最理想的做法。</span><span class="sxs-lookup"><span data-stu-id="515cb-241">It would probably be best to configure the Calendar control so that its dates are not selectable.</span></span> <span data-ttu-id="515cb-242">不論如何，本教學課程會示範在某些情況下檢視狀態必須啟用才能提供特定功能。</span><span class="sxs-lookup"><span data-stu-id="515cb-242">Regardless, this tutorial shows that in some circumstances view state must be enabled in order to provide certain functionality.</span></span>

## <a name="step-4-showing-the-number-of-days-the-employee-has-worked-for-the-company"></a><span data-ttu-id="515cb-243">步驟 4： 顯示指定天數員工曾任職的公司</span><span class="sxs-lookup"><span data-stu-id="515cb-243">Step 4: Showing the Number of Days the Employee Has Worked for the Company</span></span>

<span data-ttu-id="515cb-244">到目前為止，我們討論過 TemplateFields 的兩個應用的程式：</span><span class="sxs-lookup"><span data-stu-id="515cb-244">So far we have seen two applications of TemplateFields:</span></span>

- <span data-ttu-id="515cb-245">將兩個或多個資料欄位值結合成一個資料行，以及</span><span class="sxs-lookup"><span data-stu-id="515cb-245">Combining two or more data field values into one column, and</span></span>
- <span data-ttu-id="515cb-246">表示資料欄位值，而不文字中使用的 Web 控制項</span><span class="sxs-lookup"><span data-stu-id="515cb-246">Expressing a data field value using a Web control instead of text</span></span>

<span data-ttu-id="515cb-247">TemplateFields 第三個使用中顯示的 GridView 有關的中繼資料基礎資料。</span><span class="sxs-lookup"><span data-stu-id="515cb-247">A third use of TemplateFields is in displaying metadata about the GridView's underlying data.</span></span> <span data-ttu-id="515cb-248">除了顯示員工的雇用日期，比方說，我們可能也要有一個會顯示總多少天後，就已經出現在工作的資料行。</span><span class="sxs-lookup"><span data-stu-id="515cb-248">In addition to showing the employees' hire dates, for example, we might also want to have a column that displays how many total days they've been on the job.</span></span>

<span data-ttu-id="515cb-249">尚未 TemplateFields 的另一個用法時，會發生在案例中需要會以不同的方式中顯示的網頁報表的格式儲存在資料庫中基礎的資料。</span><span class="sxs-lookup"><span data-stu-id="515cb-249">Yet another use of TemplateFields arises in scenarios when the underlying data needs to be displayed differently in the web page report than in the format it's stored in the database.</span></span> <span data-ttu-id="515cb-250">想像`Employees`資料表中有`Gender`儲存字元的欄位`M`或`F`指出員工的性別。</span><span class="sxs-lookup"><span data-stu-id="515cb-250">Imagine that the `Employees` table had a `Gender` field that stored the character `M` or `F` to indicate the sex of the employee.</span></span> <span data-ttu-id="515cb-251">當這項資訊顯示在網頁上，我們可能想要顯示為"Male"或"Female"，而不只是"M"或"F"的性別。</span><span class="sxs-lookup"><span data-stu-id="515cb-251">When displaying this information in a web page we might want to show the gender as either "Male" or "Female", as opposed to just "M" or "F".</span></span>

<span data-ttu-id="515cb-252">這兩種案例可以藉由建立處理*格式化方法*ASP.NET 網頁的程式碼後置類別中 (或在個別的類別庫中，實作為`Shared`方法)，會叫用的範本。</span><span class="sxs-lookup"><span data-stu-id="515cb-252">Both of these scenarios can be handled by creating a *formatting method* in the ASP.NET page's code-behind class (or in a separate class library, implemented as a `Shared` method) that is invoked from the template.</span></span> <span data-ttu-id="515cb-253">從範本使用相同的資料繫結語法前文所見，這種格式的方法會叫用。</span><span class="sxs-lookup"><span data-stu-id="515cb-253">Such a formatting method is invoked from the template using the same databinding syntax seen earlier.</span></span> <span data-ttu-id="515cb-254">可以接受任意數目的參數，以格式化方法，但必須傳回字串。</span><span class="sxs-lookup"><span data-stu-id="515cb-254">The formatting method can take in any number of parameters, but must return a string.</span></span> <span data-ttu-id="515cb-255">這個傳回的字串會插入至範本的 HTML。</span><span class="sxs-lookup"><span data-stu-id="515cb-255">This returned string is the HTML that is injected into the template.</span></span>

<span data-ttu-id="515cb-256">為了說明這個概念，讓我們來加強我們的教學課程，以顯示列出員工已在工作總天數的資料行。</span><span class="sxs-lookup"><span data-stu-id="515cb-256">To illustrate this concept, let's augment our tutorial to show a column that lists the total number of days an employee has been on the job.</span></span> <span data-ttu-id="515cb-257">此格式的方法將會在採取`Northwind.EmployeesRow`物件，並傳回的員工已採用字串形式的天數。</span><span class="sxs-lookup"><span data-stu-id="515cb-257">This formatting method will take in a `Northwind.EmployeesRow` object and return the number of days the employee has been employed as a string.</span></span> <span data-ttu-id="515cb-258">這個方法可以加入至 ASP.NET 網頁的程式碼後置類別，但*必須*標示為`Protected`或`Public`才能存取從該範本。</span><span class="sxs-lookup"><span data-stu-id="515cb-258">This method can be added to the ASP.NET page's code-behind class, but *must* be marked as `Protected` or `Public` in order to be accessible from the template.</span></span>


[!code-vb[Main](using-templatefields-in-the-gridview-control-vb/samples/sample5.vb)]

<span data-ttu-id="515cb-259">由於`HiredDate`欄位可以包含`NULL`資料庫的值，我們必須先確定值不是`NULL`再繼續進行計算。</span><span class="sxs-lookup"><span data-stu-id="515cb-259">Since the `HiredDate` field can contain `NULL` database values we must first ensure that the value is not `NULL` before proceeding with the calculation.</span></span> <span data-ttu-id="515cb-260">如果`HiredDate`值是`NULL`，我們只會傳回字串 「 未知 」; 如果不是`NULL`，我們會計算目前時間之間的差異和`HiredDate`值，並傳回的天數。</span><span class="sxs-lookup"><span data-stu-id="515cb-260">If the `HiredDate` value is `NULL`, we simply return the string "Unknown"; if it is not `NULL`, we compute the difference between the current time and the `HiredDate` value and return the number of days.</span></span>

<span data-ttu-id="515cb-261">若要利用這個方法，我們需要從使用資料繫結語法 GridView 中的 TemplateField 叫用它。</span><span class="sxs-lookup"><span data-stu-id="515cb-261">To utilize this method we need to invoke it from a TemplateField in the GridView using the databinding syntax.</span></span> <span data-ttu-id="515cb-262">啟動新的 TemplateField 加入按一下 GridView 的智慧標籤中的 [編輯資料行] 連結，並加入新的 TemplateField GridView。</span><span class="sxs-lookup"><span data-stu-id="515cb-262">Start by adding a new TemplateField to the GridView by clicking on the Edit Columns link in the GridView's smart tag and adding a new TemplateField.</span></span>


<span data-ttu-id="515cb-263">[![加入新的 TemplateField 至 GridView](using-templatefields-in-the-gridview-control-vb/_static/image44.png)](using-templatefields-in-the-gridview-control-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-263">[![Add a New TemplateField to the GridView](using-templatefields-in-the-gridview-control-vb/_static/image44.png)](using-templatefields-in-the-gridview-control-vb/_static/image43.png)</span></span>

<span data-ttu-id="515cb-264">**圖 15**： 將新的 TemplateField 新增至 GridView ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-264">**Figure 15**: Add a New TemplateField to the GridView ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image45.png))</span></span>


<span data-ttu-id="515cb-265">設定這個新的 TemplateField `HeaderText` 「 天上作業 」 的屬性並將其`ItemStyle`的`HorizontalAlign`屬性設`Center`。</span><span class="sxs-lookup"><span data-stu-id="515cb-265">Set this new TemplateField's `HeaderText` property to "Days on the Job" and its `ItemStyle`'s `HorizontalAlign` property to `Center`.</span></span> <span data-ttu-id="515cb-266">若要呼叫`DisplayDaysOnJob`方法，從範本中，新增`ItemTemplate`，並使用下列資料繫結語法：</span><span class="sxs-lookup"><span data-stu-id="515cb-266">To call the `DisplayDaysOnJob` method from the template, add an `ItemTemplate` and use the following databinding syntax:</span></span>


[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample6.aspx)]

<span data-ttu-id="515cb-267">`Container.DataItem` 會傳回`DataRowView`物件對應至`DataSource`記錄繫結至`GridViewRow`。</span><span class="sxs-lookup"><span data-stu-id="515cb-267">`Container.DataItem` returns a `DataRowView` object corresponding to the `DataSource` record bound to the `GridViewRow`.</span></span> <span data-ttu-id="515cb-268">其`Row`屬性會傳回強型別`Northwind.EmployeesRow`，這會傳遞至`DisplayDaysOnJob`方法。</span><span class="sxs-lookup"><span data-stu-id="515cb-268">Its `Row` property returns the strongly-typed `Northwind.EmployeesRow`, which is passed to the `DisplayDaysOnJob` method.</span></span> <span data-ttu-id="515cb-269">此資料繫結語法會顯示可以直接在`ItemTemplate`（如下列宣告式語法所示） 或可指派給`Text`Label Web 控制項的屬性。</span><span class="sxs-lookup"><span data-stu-id="515cb-269">This databinding syntax can appear directly in the `ItemTemplate` (as shown in the declarative syntax below) or can be assigned to the `Text` property of a Label Web control.</span></span>

> [!NOTE]
> <span data-ttu-id="515cb-270">或者，而不是傳入`EmployeesRow`執行個體，我們可以只使用傳入`HireDate`值使用`<%# DisplayDaysOnJob(Eval("HireDate")) %>`。</span><span class="sxs-lookup"><span data-stu-id="515cb-270">Alternatively, instead of passing in an `EmployeesRow` instance, we could just pass in the `HireDate` value using `<%# DisplayDaysOnJob(Eval("HireDate")) %>`.</span></span> <span data-ttu-id="515cb-271">不過，`Eval`方法會傳回`Object`，因此我們必須變更我們`DisplayDaysOnJob`接受類型的輸入的參數的方法簽章`Object`，改為。</span><span class="sxs-lookup"><span data-stu-id="515cb-271">However, the `Eval` method returns an `Object`, so we'd have to change our `DisplayDaysOnJob` method signature to accept an input parameter of type `Object`, instead.</span></span> <span data-ttu-id="515cb-272">我們不能盲目地轉型`Eval("HireDate")`呼叫`DateTime`因為`HireDate`中的資料行`Employees`資料表可以包含`NULL`值。</span><span class="sxs-lookup"><span data-stu-id="515cb-272">We can't blindly cast the `Eval("HireDate")` call to a `DateTime` because the `HireDate` column in the `Employees` table can contain `NULL` values.</span></span> <span data-ttu-id="515cb-273">因此，我們需要接受`Object`做為輸入的參數`DisplayDaysOnJob`方法，檢查是否有資料庫`NULL`值 (這可以使用來完成`Convert.IsDBNull(objectToCheck)`)，視情況繼續執行。</span><span class="sxs-lookup"><span data-stu-id="515cb-273">Therefore, we'd need to accept an `Object` as the input parameter for the `DisplayDaysOnJob` method, check to see if it had a database `NULL` value (which can be accomplished using `Convert.IsDBNull(objectToCheck)`), and then proceed accordingly.</span></span>


<span data-ttu-id="515cb-274">由於這些微妙之處我選擇將整個`EmployeesRow`執行個體。</span><span class="sxs-lookup"><span data-stu-id="515cb-274">Due to these subtleties I've opted to pass in the entire `EmployeesRow` instance.</span></span> <span data-ttu-id="515cb-275">在下一個教學課程中，我們將看到使用的多個調整範例`Eval("columnName")`傳入的格式化方法的輸入的參數的語法。</span><span class="sxs-lookup"><span data-stu-id="515cb-275">In the next tutorial we'll see a more fitting example for using the `Eval("columnName")` syntax for passing an input parameter into a formatting method.</span></span>

<span data-ttu-id="515cb-276">下圖顯示的宣告式語法的我們 GridView TemplateField 新增之後，`DisplayDaysOnJob`方法呼叫從`ItemTemplate`:</span><span class="sxs-lookup"><span data-stu-id="515cb-276">The following shows the declarative syntax for our GridView after the TemplateField has been added and the `DisplayDaysOnJob` method called from the `ItemTemplate`:</span></span>


[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample7.aspx)]

<span data-ttu-id="515cb-277">[圖 16] 顯示已完成的教學課程中，透過瀏覽器檢視時。</span><span class="sxs-lookup"><span data-stu-id="515cb-277">Figure 16 shows the completed tutorial, when viewed through a browser.</span></span>


<span data-ttu-id="515cb-278">[![員工已在工作的日期數字顯示](using-templatefields-in-the-gridview-control-vb/_static/image47.png)](using-templatefields-in-the-gridview-control-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="515cb-278">[![The Number of Days the Employee Has Been on the Job is Displayed](using-templatefields-in-the-gridview-control-vb/_static/image47.png)](using-templatefields-in-the-gridview-control-vb/_static/image46.png)</span></span>

<span data-ttu-id="515cb-279">**圖 16**: 數字的天員工已在工作上顯示 ([按一下以檢視完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="515cb-279">**Figure 16**: The Number of Days the Employee Has Been on the Job is Displayed ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image48.png))</span></span>


## <a name="summary"></a><span data-ttu-id="515cb-280">總結</span><span class="sxs-lookup"><span data-stu-id="515cb-280">Summary</span></span>

<span data-ttu-id="515cb-281">在 GridView 控制項中的 TemplateField 允許較大程度的彈性，比起其他欄位控制項顯示資料。</span><span class="sxs-lookup"><span data-stu-id="515cb-281">The TemplateField in the GridView control allows for a higher degree of flexibility in displaying data than is available with the other field controls.</span></span> <span data-ttu-id="515cb-282">是非常理想的情況下的 TemplateFields 其中：</span><span class="sxs-lookup"><span data-stu-id="515cb-282">TemplateFields are ideal for situations where:</span></span>

- <span data-ttu-id="515cb-283">多個資料欄位需要一個 GridView 資料行中顯示</span><span class="sxs-lookup"><span data-stu-id="515cb-283">Multiple data fields need to be displayed in one GridView column</span></span>
- <span data-ttu-id="515cb-284">使用 Web 控制項，而不是純文字最能表示的資料</span><span class="sxs-lookup"><span data-stu-id="515cb-284">The data is best expressed using a Web control rather than plain text</span></span>
- <span data-ttu-id="515cb-285">輸出取決於基礎資料，例如顯示中繼資料或是在重新格式化資料</span><span class="sxs-lookup"><span data-stu-id="515cb-285">The output depends on the underlying data, such as displaying metadata or in reformatting the data</span></span>

<span data-ttu-id="515cb-286">除了自訂資料的顯示，也會使用 TemplateFields 自訂使用者介面，如稍後所示在未來的教學課程，用於編輯和插入資料。</span><span class="sxs-lookup"><span data-stu-id="515cb-286">In addition to customizing the display of data, TemplateFields are also used for customizing the user interfaces used for editing and inserting data, as we'll see in future tutorials.</span></span>

<span data-ttu-id="515cb-287">下面兩個教學課程會繼續探索開始了解在 DetailsView 中使用 TemplateFields 的範本。</span><span class="sxs-lookup"><span data-stu-id="515cb-287">The next two tutorials continue exploring templates, starting with a look at using TemplateFields in a DetailsView.</span></span> <span data-ttu-id="515cb-288">接下來，我們將轉向 FormView，取代欄位會使用範本，以提供更大彈性的配置和資料結構。</span><span class="sxs-lookup"><span data-stu-id="515cb-288">Following that, we'll turn to the FormView, which uses templates in lieu of fields to provide greater flexibility in the layout and structure of the data.</span></span>

<span data-ttu-id="515cb-289">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="515cb-289">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="515cb-290">關於作者</span><span class="sxs-lookup"><span data-stu-id="515cb-290">About the Author</span></span>

<span data-ttu-id="515cb-291">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="515cb-291">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="515cb-292">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="515cb-292">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="515cb-293">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="515cb-293">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="515cb-294">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="515cb-294">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="515cb-295">或透過他的部落格，這位於[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="515cb-295">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="515cb-296">特別感謝</span><span class="sxs-lookup"><span data-stu-id="515cb-296">Special Thanks To</span></span>

<span data-ttu-id="515cb-297">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="515cb-297">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="515cb-298">本教學課程中的潛在客戶檢閱者已 Dan Jagers。</span><span class="sxs-lookup"><span data-stu-id="515cb-298">Lead reviewer for this tutorial was Dan Jagers.</span></span> <span data-ttu-id="515cb-299">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="515cb-299">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="515cb-300">如果是這樣，psychic 在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="515cb-300">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="515cb-301">[上一頁](custom-formatting-based-upon-data-vb.md)
> [下一頁](using-templatefields-in-the-detailsview-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="515cb-301">[Previous](custom-formatting-based-upon-data-vb.md)
[Next](using-templatefields-in-the-detailsview-control-vb.md)</span></span>
