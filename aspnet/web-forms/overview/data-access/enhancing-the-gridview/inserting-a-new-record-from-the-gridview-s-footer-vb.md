---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: 從 GridView 的頁尾 (VB) 插入新的記錄 |Microsoft Docs
author: rick-anderson
description: 雖然 GridView 控制項不會插入新記錄的資料提供內建支援，本教學課程會示範如何擴充以包含 GridView...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/06/2007
ms.topic: article
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: c228128e551f58aa003af10cf787875d26b1fab7
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/03/2018
ms.locfileid: "37375171"
---
<a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="e0426-103">從 GridView 的頁尾 (VB) 插入新的記錄</span><span class="sxs-lookup"><span data-stu-id="e0426-103">Inserting a New Record from the GridView's Footer (VB)</span></span>
====================
<span data-ttu-id="e0426-104">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e0426-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e0426-105">[下載範例應用程式](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe)或[下載 PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e0426-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="e0426-106">雖然 GridView 控制項不會插入新記錄的資料提供內建支援，本教學課程會示範如何增強 GridView，以包含插入的介面。</span><span class="sxs-lookup"><span data-stu-id="e0426-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="e0426-107">簡介</span><span class="sxs-lookup"><span data-stu-id="e0426-107">Introduction</span></span>

<span data-ttu-id="e0426-108">中所述[概觀的插入、 更新和刪除資料](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)教學課程，GridView、 DetailsView 和 FormView Web 控制項每個包含內建的資料修改功能。</span><span class="sxs-lookup"><span data-stu-id="e0426-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="e0426-109">宣告式資料來源控制項搭配使用時，這三個 Web 控制項可以快速且輕鬆地設定來修改資料集和案例，而不需要撰寫任何一行程式碼中。</span><span class="sxs-lookup"><span data-stu-id="e0426-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="e0426-110">不幸的是，只有 DetailsView 和 FormView 控制項所提供的內建插入、 編輯和刪除功能。</span><span class="sxs-lookup"><span data-stu-id="e0426-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="e0426-111">GridView 只會提供編輯和刪除的支援。</span><span class="sxs-lookup"><span data-stu-id="e0426-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="e0426-112">不過，與一些折線油漬，我們可以增強 GridView，以包含插入的介面。</span><span class="sxs-lookup"><span data-stu-id="e0426-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="e0426-113">將插入的功能新增至 GridView，我們會負責決定將加入新的記錄、 建立插入的介面，以及撰寫程式碼來插入新的記錄項目。</span><span class="sxs-lookup"><span data-stu-id="e0426-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="e0426-114">在本教學課程，我們將探討將插入的介面新增至 GridView 的頁尾資料列 （請參閱 圖 1）。</span><span class="sxs-lookup"><span data-stu-id="e0426-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="e0426-115">每個資料行的頁尾資料格包含適當的資料集合使用者介面項目 （產品 s 名稱的文字方塊中，供應商，依此類推 dropdownlist 進行）。</span><span class="sxs-lookup"><span data-stu-id="e0426-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="e0426-116">我們也需要資料行的新增按鈕，按下時，會造成回傳，並插入新記錄到`Products`資料表使用的頁尾資料列中提供的值。</span><span class="sxs-lookup"><span data-stu-id="e0426-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>


<span data-ttu-id="e0426-117">[![頁尾資料列中加入新的產品提供的介面](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="e0426-118">**圖 1**： 頁尾資料列加入新的產品提供的介面 ([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>


## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="e0426-119">步驟 1: GridView 中顯示產品資訊</span><span class="sxs-lookup"><span data-stu-id="e0426-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="e0426-120">我們考慮自行建立 GridView 的頁尾中的插入介面之前，讓 s 著重 GridView 加入列出資料庫中的產品頁面第一次。</span><span class="sxs-lookup"><span data-stu-id="e0426-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="e0426-121">首先開啟`InsertThroughFooter.aspx`頁面中`EnhancedGridView`資料夾，然後從 [工具箱] 拖曳至設計工具，設定 GridView 的拖曳的 GridView`ID`屬性設`Products`。</span><span class="sxs-lookup"><span data-stu-id="e0426-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="e0426-122">接下來，使用 GridView s 智慧標籤繫結至名為新 ObjectDataSource `ProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="e0426-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>


<span data-ttu-id="e0426-123">[![建立名為 ProductsDataSource 新 ObjectDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="e0426-124">**圖 2**： 建立新的 ObjectDataSource 具名`ProductsDataSource`([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>


<span data-ttu-id="e0426-125">設定要使用 ObjectDataSource`ProductsBLL`類別的`GetProducts()`方法來擷取產品資訊。</span><span class="sxs-lookup"><span data-stu-id="e0426-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="e0426-126">本教學課程中，讓 s 焦點，嚴格上加入插入的功能，不需擔心編輯和刪除。</span><span class="sxs-lookup"><span data-stu-id="e0426-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="e0426-127">因此，請確定在 [插入] 索引標籤中的下拉式清單設為`AddProduct()`而更新和刪除索引標籤中的下拉式清單會設定為 （無）。</span><span class="sxs-lookup"><span data-stu-id="e0426-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>


<span data-ttu-id="e0426-128">[![將 AddProduct 方法對應至 ObjectDataSource s insert （） 方法](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="e0426-129">**圖 3**： 地圖`AddProduct`方法的 ObjectDataSource s`Insert()`方法 ([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>


<span data-ttu-id="e0426-130">[![設定為 （無） 更新和刪除索引標籤的下拉式清單](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="e0426-131">**圖 4**： 將更新和刪除索引標籤下拉式清單會列出為 （無） ([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>


<span data-ttu-id="e0426-132">完成 ObjectDataSource s 設定資料來源精靈之後，Visual Studio 會自動加入欄位至 GridView 的每個對應的資料欄位。</span><span class="sxs-lookup"><span data-stu-id="e0426-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="e0426-133">現在，將所有的 Visual Studio 所加入的欄位。</span><span class="sxs-lookup"><span data-stu-id="e0426-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="e0426-134">稍後在本教學課程，我們會再回來移除某些欄位的值不需要新增新的記錄時指定。</span><span class="sxs-lookup"><span data-stu-id="e0426-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="e0426-135">由於有接近 80 產品在資料庫中，使用者必須捲動到頁面底部的 web，才能加入新的記錄。</span><span class="sxs-lookup"><span data-stu-id="e0426-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="e0426-136">因此，可讓啟用分頁功能，是為了讓插入介面，更透明化且可存取的 s。</span><span class="sxs-lookup"><span data-stu-id="e0426-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="e0426-137">若要開啟分頁，只要檢查 GridView s 智慧標籤啟用分頁核取方塊。</span><span class="sxs-lookup"><span data-stu-id="e0426-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="e0426-138">此時，GridView 和 ObjectDataSource s 宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="e0426-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]


<span data-ttu-id="e0426-139">[![產品的所有資料欄位會都顯示在分頁的 GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="e0426-140">**圖 5**： 在分頁的 GridView 會顯示所有的產品資料欄位 ([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>


## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="e0426-141">步驟 2： 新增頁尾資料列</span><span class="sxs-lookup"><span data-stu-id="e0426-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="e0426-142">加上其標頭和資料列，GridView 會包含頁尾資料列。</span><span class="sxs-lookup"><span data-stu-id="e0426-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="e0426-143">頁首和頁尾資料列會顯示依據的 GridView 的值[ `ShowHeader` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx)並[ `ShowFooter` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx)屬性。</span><span class="sxs-lookup"><span data-stu-id="e0426-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="e0426-144">若要顯示頁尾資料列，請設定`ShowFooter`屬性設`True`。</span><span class="sxs-lookup"><span data-stu-id="e0426-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="e0426-145">圖 6 所示，設定`ShowFooter`屬性設`True`頁尾資料列加入方格中。</span><span class="sxs-lookup"><span data-stu-id="e0426-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>


<span data-ttu-id="e0426-146">[![若要顯示頁尾資料列，請將 ShowFooter 設定為 True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="e0426-147">**圖 6**： 若要顯示頁尾資料列中，設定`ShowFooter`要`True`([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>


<span data-ttu-id="e0426-148">請注意，頁尾資料列深紅色的背景色彩。</span><span class="sxs-lookup"><span data-stu-id="e0426-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="e0426-149">這是因為我們建立並套用至所有頁面 DataWebControls 佈景主題年代[顯示的資料與 ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="e0426-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="e0426-150">具體而言，`GridView.skin`檔案會設定`FooterStyle`屬性這類，這會使用`FooterStyle`CSS 類別。</span><span class="sxs-lookup"><span data-stu-id="e0426-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="e0426-151">`FooterStyle`類別定義於`Styles.css`，如下所示：</span><span class="sxs-lookup"><span data-stu-id="e0426-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>


[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="e0426-152">我們已在先前的教學課程中使用 GridView 的頁尾資料列中加以探索。</span><span class="sxs-lookup"><span data-stu-id="e0426-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="e0426-153">如有需要請參閱上一步[GridView 的頁尾顯示摘要資訊](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md)重新整理程式的教學課程。</span><span class="sxs-lookup"><span data-stu-id="e0426-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>


<span data-ttu-id="e0426-154">在設定後`ShowFooter`屬性設`True`，花一點時間瀏覽器中檢視輸出。</span><span class="sxs-lookup"><span data-stu-id="e0426-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="e0426-155">目前的頁尾資料列不 t 所包含的任何文字或 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="e0426-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="e0426-156">在步驟 3 中我們將修改的每個欄位 GridView 的頁尾，使其包含適當的插入介面。</span><span class="sxs-lookup"><span data-stu-id="e0426-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>


<span data-ttu-id="e0426-157">[![空白的頁尾資料列會顯示上面分頁介面控制項](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="e0426-158">**圖 7**: 空白的頁尾資料列會顯示上面分頁介面控制項 ([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>


## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="e0426-159">步驟 3： 自訂頁尾資料列</span><span class="sxs-lookup"><span data-stu-id="e0426-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="e0426-160">回到[使用 GridView 控制項中的 TemplateFields](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md)教學課程中我們了解如何大幅自訂顯示的特定的 GridView 資料行，使用 TemplateFields （相對於 BoundFields 或 CheckBoxFields）; 在[自訂資料修改介面](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)我們探討了以自訂編輯介面 GridView 中的使用 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="e0426-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="e0426-161">為 TemplateField 由數個範本，定義混合使用標記、 Web 控制項和資料繫結語法所組成的重新叫用用於某些類型的資料列。</span><span class="sxs-lookup"><span data-stu-id="e0426-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="e0426-162">`ItemTemplate`，例如，指定範本用於唯讀的資料列，雖然`EditItemTemplate`定義範本，可編輯的資料列。</span><span class="sxs-lookup"><span data-stu-id="e0426-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="e0426-163">連同`ItemTemplate`並`EditItemTemplate`，也包含 TemplateField`FooterTemplate`指定頁尾資料列的內容。</span><span class="sxs-lookup"><span data-stu-id="e0426-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="e0426-164">因此，我們可以在其中新增 Web 控制項所需的每個插入到介面的欄位 s `FooterTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e0426-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="e0426-165">若要開始，請將所有的 GridView 中的欄位轉換成 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="e0426-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="e0426-166">做法是藉由按一下 GridView s 智慧標籤，在左下角，選取每個欄位，並按一下此欄位轉換成 TemplateField 連結中的 [編輯資料行] 連結。</span><span class="sxs-lookup"><span data-stu-id="e0426-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>


![每個欄位轉換為 TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="e0426-168">**圖 8**： 每個欄位轉換為 TemplateField</span><span class="sxs-lookup"><span data-stu-id="e0426-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>


<span data-ttu-id="e0426-169">按一下 轉換為 TemplateField 此欄位會開啟對等的 TemplateField 到目前的欄位類型。</span><span class="sxs-lookup"><span data-stu-id="e0426-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="e0426-170">例如，每個 BoundField 會取代使用 TemplateField `ItemTemplate` ，其中包含顯示相對應的資料欄位的標籤和`EditItemTemplate`文字方塊中顯示資料欄位。</span><span class="sxs-lookup"><span data-stu-id="e0426-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="e0426-171">`ProductName` BoundField 已轉換成下列 TemplateField 標記：</span><span class="sxs-lookup"><span data-stu-id="e0426-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="e0426-172">同樣地， `Discontinued` CheckBoxField 已轉換成 TemplateField 其`ItemTemplate`並`EditItemTemplate`包含核取方塊 Web 控制項 (與`ItemTemplate`s 停用的核取方塊)。</span><span class="sxs-lookup"><span data-stu-id="e0426-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="e0426-173">唯讀`ProductID`BoundField 已轉換成與標籤控制項中的 TemplateField`ItemTemplate`和`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e0426-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="e0426-174">簡單地說，轉換現有的 GridView TemplateField 欄位是功能的快速輕易地切換至 更多可自訂的 TemplateField，而不會遺失任何現有的欄位。</span><span class="sxs-lookup"><span data-stu-id="e0426-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="e0426-175">因為 GridView 我們處理不 t 支援編輯、 放心地移除`EditItemTemplate`只從每個 TemplateField，離開`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e0426-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="e0426-176">完成之後，GridView s 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="e0426-176">After doing this, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="e0426-177">現在，每個 GridView 欄位轉換成 TemplateField，我們可以輸入適當的插入介面到每個欄位的`FooterTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e0426-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="e0426-178">某些欄位不會插入介面 (`ProductID`，比方說); 其他人會以 Web 控制項可用來收集新的產品的資訊而有所不同。</span><span class="sxs-lookup"><span data-stu-id="e0426-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="e0426-179">若要建立的編輯介面，請從 GridView s 智慧標籤中選擇 [編輯範本] 連結。</span><span class="sxs-lookup"><span data-stu-id="e0426-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="e0426-180">然後，從下拉式清單中，選取適當的欄位的`FooterTemplate`拖曳適當的控制項從 [工具箱] 拖曳至設計工具。</span><span class="sxs-lookup"><span data-stu-id="e0426-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>


<span data-ttu-id="e0426-181">[![將適當的插入介面新增至每個欄位的 FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="e0426-182">**圖 9**： 將適當的插入介面新增至每個欄位 s `FooterTemplate` ([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>


<span data-ttu-id="e0426-183">下列項目符號清單列舉 GridView 欄位，指定要加入的插入介面：</span><span class="sxs-lookup"><span data-stu-id="e0426-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="e0426-184">`ProductID` None。</span><span class="sxs-lookup"><span data-stu-id="e0426-184">`ProductID` none.</span></span>
- <span data-ttu-id="e0426-185">`ProductName` 加入文字方塊，並設定其`ID`至`NewProductName`。</span><span class="sxs-lookup"><span data-stu-id="e0426-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="e0426-186">新增 RequiredFieldValidator 控制項，以確保使用者輸入的值，讓新的產品的名稱。</span><span class="sxs-lookup"><span data-stu-id="e0426-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="e0426-187">`SupplierID` None。</span><span class="sxs-lookup"><span data-stu-id="e0426-187">`SupplierID` none.</span></span>
- <span data-ttu-id="e0426-188">`CategoryID` None。</span><span class="sxs-lookup"><span data-stu-id="e0426-188">`CategoryID` none.</span></span>
- <span data-ttu-id="e0426-189">`QuantityPerUnit` 新增文字方塊中，設定其`ID`至`NewQuantityPerUnit`。</span><span class="sxs-lookup"><span data-stu-id="e0426-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="e0426-190">`UnitPrice` 加入名為 TextBox `NewUnitPrice` CompareValidator，以確保輸入的值是貨幣值大於或等於零。</span><span class="sxs-lookup"><span data-stu-id="e0426-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="e0426-191">`UnitsInStock` 使用文字方塊其`ID`設為`NewUnitsInStock`。</span><span class="sxs-lookup"><span data-stu-id="e0426-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="e0426-192">包含 CompareValidator，以確保輸入的值是整數值大於或等於零。</span><span class="sxs-lookup"><span data-stu-id="e0426-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="e0426-193">`UnitsOnOrder` 使用文字方塊其`ID`設為`NewUnitsOnOrder`。</span><span class="sxs-lookup"><span data-stu-id="e0426-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="e0426-194">包含 CompareValidator，以確保輸入的值是整數值大於或等於零。</span><span class="sxs-lookup"><span data-stu-id="e0426-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="e0426-195">`ReorderLevel` 使用文字方塊其`ID`設為`NewReorderLevel`。</span><span class="sxs-lookup"><span data-stu-id="e0426-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="e0426-196">包含 CompareValidator，以確保輸入的值是整數值大於或等於零。</span><span class="sxs-lookup"><span data-stu-id="e0426-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="e0426-197">`Discontinued` 將新增核取方塊，設定其`ID`至`NewDiscontinued`。</span><span class="sxs-lookup"><span data-stu-id="e0426-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="e0426-198">`CategoryName` 新增 dropdownlist 進行並設定其`ID`至`NewCategoryID`。</span><span class="sxs-lookup"><span data-stu-id="e0426-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="e0426-199">繫結至名為新 ObjectDataSource`CategoriesDataSource`並將它設定為使用`CategoriesBLL`類別的`GetCategories()`方法。</span><span class="sxs-lookup"><span data-stu-id="e0426-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="e0426-200">有 DropDownList s `ListItem` s 顯示器`CategoryName`資料欄位中，使用`CategoryID`做為其值的資料欄位。</span><span class="sxs-lookup"><span data-stu-id="e0426-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="e0426-201">`SupplierName` 新增 dropdownlist 進行並設定其`ID`至`NewSupplierID`。</span><span class="sxs-lookup"><span data-stu-id="e0426-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="e0426-202">繫結至名為新 ObjectDataSource`SuppliersDataSource`並將它設定為使用`SuppliersBLL`類別的`GetSuppliers()`方法。</span><span class="sxs-lookup"><span data-stu-id="e0426-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="e0426-203">有 DropDownList s `ListItem` s 顯示器`CompanyName`資料欄位中，使用`SupplierID`做為其值的資料欄位。</span><span class="sxs-lookup"><span data-stu-id="e0426-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="e0426-204">針對每個驗證控制項中，清除`ForeColor`屬性，讓`FooterStyle`CSS 類別 s 白色的前景色彩會代替紅色的預設值。</span><span class="sxs-lookup"><span data-stu-id="e0426-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="e0426-205">也使用`ErrorMessage`屬性的詳細說明，但設定`Text`設為星號的屬性。</span><span class="sxs-lookup"><span data-stu-id="e0426-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="e0426-206">若要避免驗證控制項的文字導致插入的介面，以包裝為兩行，將`FooterStyle`s`Wrap`屬性設定為 false，針對每個`FooterTemplate`的驗證控制項。</span><span class="sxs-lookup"><span data-stu-id="e0426-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="e0426-207">最後，新增 ValidationSummary 控制項下方的 GridView 和設定其`ShowMessageBox`屬性，以`True`及其`ShowSummary`屬性設`False`。</span><span class="sxs-lookup"><span data-stu-id="e0426-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="e0426-208">當新增新的產品，我們需要提供`CategoryID`和`SupplierID`。</span><span class="sxs-lookup"><span data-stu-id="e0426-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="e0426-209">這項資訊透過頁尾資料格中的 dropdownlist 進行擷取`CategoryName`和`SupplierName`欄位。</span><span class="sxs-lookup"><span data-stu-id="e0426-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="e0426-210">我選擇使用這些欄位相對於`CategoryID`和`SupplierID`TemplateFields 方格 s 中的資料列的使用者因為是可能比較有興趣查看的類別和供應商名稱，而不是其識別碼值。</span><span class="sxs-lookup"><span data-stu-id="e0426-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="e0426-211">因為`CategoryID`並`SupplierID`值現在正在擷取中`CategoryName`並`SupplierName`欄位 s 插入介面，我們可以移除`CategoryID`和`SupplierID`從 GridView 的 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="e0426-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="e0426-212">同樣地，`ProductID`未使用時加入新的產品，因此`ProductID`TemplateField 可以一併移除。</span><span class="sxs-lookup"><span data-stu-id="e0426-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="e0426-213">不過，讓 s 保留`ProductID`方格中的欄位。</span><span class="sxs-lookup"><span data-stu-id="e0426-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="e0426-214">除了文字方塊、 dropdownlist 進行中，核取方塊和組成插入介面的驗證控制項，我們還需要新增按鈕，按一下時，會執行邏輯，以便將新的產品加入至資料庫。</span><span class="sxs-lookup"><span data-stu-id="e0426-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="e0426-215">在步驟 4 中，我們會包含插入的介面中的 [新增] 按鈕`ProductID`TemplateField 的`FooterTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e0426-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="e0426-216">歡迎改善各種 GridView 欄位的外觀。</span><span class="sxs-lookup"><span data-stu-id="e0426-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="e0426-217">比方說，您可能想要格式化`UnitPrice`貨幣值靠右對齊`UnitsInStock`， `UnitsOnOrder`，和`ReorderLevel`欄位，以及更新`HeaderText`TemplateFields 的值。</span><span class="sxs-lookup"><span data-stu-id="e0426-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="e0426-218">建立插入介面中的許多之後`FooterTemplate`s，移除`SupplierID`，和`CategoryID`TemplateFields，並改善透過格式和對齊 TemplateFields，您的宣告式 GridView s 方格的美術設計標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="e0426-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="e0426-219">當透過瀏覽器檢視，GridView 的頁尾資料列現在包含已完成插入介面 （請參閱 圖 10）。</span><span class="sxs-lookup"><span data-stu-id="e0426-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="e0426-220">此時，插入介面不包含使用者指示該她 s 新產品的輸入資料，並想要將新記錄插入資料庫的方法。</span><span class="sxs-lookup"><span data-stu-id="e0426-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="e0426-221">此外，我們還可解決頁尾中的輸入資料將如何轉譯中的新記錄的 ve`Products`資料庫。</span><span class="sxs-lookup"><span data-stu-id="e0426-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="e0426-222">我們將探討如何包含 [新增] 按鈕插入的介面，以及如何在執行程式碼的步驟 4 中的回傳時它 s 按下。</span><span class="sxs-lookup"><span data-stu-id="e0426-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="e0426-223">步驟 5 會示範如何插入新記錄使用頁尾中的資料。</span><span class="sxs-lookup"><span data-stu-id="e0426-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>


<span data-ttu-id="e0426-224">[![GridView 的頁尾提供的介面加入新記錄](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="e0426-225">**圖 10**: GridView 的頁尾提供的介面加入新記錄 ([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>


## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="e0426-226">步驟 4： 包括插入介面中的 [新增] 按鈕</span><span class="sxs-lookup"><span data-stu-id="e0426-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="e0426-227">我們必須包含 [新增] 按鈕某處插入的介面中因為目前插入介面的頁尾資料列 s 缺少使用者指出他們已完成輸入新的產品的資訊的方法。</span><span class="sxs-lookup"><span data-stu-id="e0426-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="e0426-228">這可放在其中一個現有`FooterTemplate`或我們無法將新的資料行加入方格中針對此目的。</span><span class="sxs-lookup"><span data-stu-id="e0426-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="e0426-229">本教學課程中，讓 s 放置在 [新增] 按鈕`ProductID`TemplateField 的`FooterTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e0426-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="e0426-230">從設計工具中，請按一下 GridView s 智慧標籤中的 [編輯範本] 連結，然後選擇`ProductID`欄位的`FooterTemplate`從下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="e0426-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="e0426-231">將按鈕 Web 控制項 （或 LinkButton 或 ImageButton，如果您想） 新增到範本中，將其識別碼設定為`AddProduct`、 其`CommandName`至插入、 並將其`Text`新增，如 圖 11 所示的屬性。</span><span class="sxs-lookup"><span data-stu-id="e0426-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>


<span data-ttu-id="e0426-232">[![置於 ProductID TemplateField 的 FooterTemplate 中的 [新增] 按鈕](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="e0426-233">**圖 11**： 將放在 [新增] 按鈕`ProductID`TemplateField s `FooterTemplate` ([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>


<span data-ttu-id="e0426-234">一旦您已包含 [新增] 按鈕，測試的瀏覽器頁面。</span><span class="sxs-lookup"><span data-stu-id="e0426-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="e0426-235">請注意，當按一下含無效的資料插入介面中的 新增 按鈕，回傳簡單地說 circuited ValidationSummary 控制項表示無效的資料 （請參閱 圖 12）。</span><span class="sxs-lookup"><span data-stu-id="e0426-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="e0426-236">輸入適當的資料，按一下 [新增] 按鈕，將會導致回傳。</span><span class="sxs-lookup"><span data-stu-id="e0426-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="e0426-237">沒有記錄會加入至資料庫，不過。</span><span class="sxs-lookup"><span data-stu-id="e0426-237">No record is added to the database, however.</span></span> <span data-ttu-id="e0426-238">我們必須撰寫的實際執行插入的程式碼。</span><span class="sxs-lookup"><span data-stu-id="e0426-238">We will need to write a bit of code to actually perform the insert.</span></span>


<span data-ttu-id="e0426-239">[![加入按鈕的回傳是簡短 Circuited 中是否有無效的資料插入介面](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="e0426-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="e0426-240">**圖 12**: 加入按鈕的回傳是簡短 Circuited 中是否有無效的資料插入介面 ([按一下以檢視完整大小的影像](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="e0426-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="e0426-241">插入介面中的驗證控制項不被指派給驗證群組中。</span><span class="sxs-lookup"><span data-stu-id="e0426-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="e0426-242">這可正常運作，只要插入介面是唯一的驗證頁面上的控制項集合。</span><span class="sxs-lookup"><span data-stu-id="e0426-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="e0426-243">不過，還有其他驗證控制項 （例如格線 s 編輯介面中的驗證控制項） 頁面上，如果驗證控制項中插入介面，並新增按鈕的`ValidationGroup`屬性應該指派相同的值 so 為至將這些控制項與特定的驗證群組產生關聯。</span><span class="sxs-lookup"><span data-stu-id="e0426-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="e0426-244">請參閱[剖析 ASP.NET 2.0 中的驗證控制項](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)如需有關驗證群組中分割的驗證控制項和網頁上的按鈕。</span><span class="sxs-lookup"><span data-stu-id="e0426-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>


## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="e0426-245">步驟 5： 插入新記錄到`Products`資料表</span><span class="sxs-lookup"><span data-stu-id="e0426-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="e0426-246">當使用內建的編輯功能的 GridView，GridView 會自動處理的所有工作所需執行更新。</span><span class="sxs-lookup"><span data-stu-id="e0426-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="e0426-247">特別是，按一下 [更新] 按鈕時它會複製輸入從編輯介面中之 ObjectDataSource 的參數值`UpdateParameters`集合和一時興起，藉由叫用的 ObjectDataSource s update 關閉`Update()`方法。</span><span class="sxs-lookup"><span data-stu-id="e0426-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="e0426-248">由於 GridView 不提供插入這類內建功能，我們必須實作程式碼呼叫 s 的 ObjectDataSource`Insert()`方法，並複製的值插入介面為 ObjectDataSource 的`InsertParameters`集合.</span><span class="sxs-lookup"><span data-stu-id="e0426-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="e0426-249">已按下 [新增] 按鈕之後，應該執行此插入邏輯。</span><span class="sxs-lookup"><span data-stu-id="e0426-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="e0426-250">中所述[新增與回應 GridView 的按鈕](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md)教學課程中，每當按鈕、 LinkButton 或在 GridView 的 ImageButton 按一下時，在 GridView 的`RowCommand`在回傳時引發的事件。</span><span class="sxs-lookup"><span data-stu-id="e0426-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="e0426-251">是否] 按鈕，LinkButton、 ImageButton 已新增或明確例如頁尾資料列中的 [新增] 按鈕，或它是否已自動加入的 GridView，就會引發這個事件 (例如選取啟用排序時，每個資料行頂端的 Linkbutton 或Linkbutton 中選取 [啟用分頁時的分頁介面)。</span><span class="sxs-lookup"><span data-stu-id="e0426-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="e0426-252">因此，若要回應使用者按一下 [新增] 按鈕，我們需要建立事件處理常式 GridView s`RowCommand`事件。</span><span class="sxs-lookup"><span data-stu-id="e0426-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="e0426-253">因為每當引發這個事件*任何*按一下 LinkButton 或在 gridview 裡的 ImageButton 按鈕時，它很重要，我們只進行插入邏輯如果 s`CommandName`屬性傳遞至事件處理常式對應`CommandName`的 [新增] 按鈕 （插入） 的值。</span><span class="sxs-lookup"><span data-stu-id="e0426-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="e0426-254">此外，我們也只應該繼續如果驗證控制項報告有效的資料。</span><span class="sxs-lookup"><span data-stu-id="e0426-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="e0426-255">若要做到這一點，建立 事件處理常式`RowCommand`為下列程式碼的事件：</span><span class="sxs-lookup"><span data-stu-id="e0426-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="e0426-256">您可能想知道為什麼事件處理常式困擾檢查`Page.IsValid`屬性。</span><span class="sxs-lookup"><span data-stu-id="e0426-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="e0426-257">畢竟，如果無效的資料插入介面中提供，會隱藏獲利的 t 回傳嗎？</span><span class="sxs-lookup"><span data-stu-id="e0426-257">After all, won t the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="e0426-258">這項假設是正確的只要使用者並未停用 JavaScript，或已採取步驟，避免用戶端驗證邏輯。</span><span class="sxs-lookup"><span data-stu-id="e0426-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="e0426-259">簡單地說，應該永遠不會依賴完全在用戶端驗證;有效的伺服器端檢查應該一律執行之前使用的資料。</span><span class="sxs-lookup"><span data-stu-id="e0426-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>


<span data-ttu-id="e0426-260">我們在步驟 1 中建立`ProductsDataSource`ObjectDataSource，其`Insert()`方法會對應至`ProductsBLL`類別的`AddProduct`方法。</span><span class="sxs-lookup"><span data-stu-id="e0426-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="e0426-261">要插入至新的資料錄`Products`資料表中，我們只叫用的 ObjectDataSource s`Insert()`方法：</span><span class="sxs-lookup"><span data-stu-id="e0426-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="e0426-262">既然`Insert()`叫用方法，只剩下就是將插入的介面中的值複製到參數傳遞給`ProductsBLL`類別的`AddProduct`方法。</span><span class="sxs-lookup"><span data-stu-id="e0426-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="e0426-263">如我們所見年代[檢查與插入、 更新和刪除事件相關聯](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)教學課程，即可透過 ObjectDataSource 的`Inserting`事件。</span><span class="sxs-lookup"><span data-stu-id="e0426-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="e0426-264">在 `Inserting`我們需要以程式設計方式參考從控制項的事件`Products`GridView 的頁尾資料列，並指派其值`e.InputParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="e0426-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="e0426-265">當使用者遺漏值，例如離開`ReorderLevel`我們要指定應插入至資料庫值的文字方塊中空白`NULL`。</span><span class="sxs-lookup"><span data-stu-id="e0426-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="e0426-266">由於`AddProducts`方法會接受 null 的型別可為 null 的資料庫欄位，只是使用可為 null 的型別和將其值設定為`Nothing`萬一使用者輸入省略的位置。</span><span class="sxs-lookup"><span data-stu-id="e0426-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="e0426-267">具有`Inserting`事件處理常式中完成，新的記錄可以新增至`Products`透過 GridView 的頁尾資料列的資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="e0426-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="e0426-268">請繼續並再次嘗試新增數個新的產品。</span><span class="sxs-lookup"><span data-stu-id="e0426-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="e0426-269">增強，以及自訂新增作業</span><span class="sxs-lookup"><span data-stu-id="e0426-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="e0426-270">目前，按一下 [新增] 按鈕就會將新記錄加入資料庫資料表，但不提供任何類型的視覺化回饋已成功新增記錄。</span><span class="sxs-lookup"><span data-stu-id="e0426-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="e0426-271">在理想情況下，一個 Label Web 控制項或用戶端警示方塊會通知之使用者的成功完成其插入。</span><span class="sxs-lookup"><span data-stu-id="e0426-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="e0426-272">我不要更動此練習的讀取器。</span><span class="sxs-lookup"><span data-stu-id="e0426-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="e0426-273">本教學課程使用 GridView 列出的產品，不適用於任何排序，也無法讓使用者排序資料。</span><span class="sxs-lookup"><span data-stu-id="e0426-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="e0426-274">因此，因為它們是在其主索引鍵欄位的資料庫中，會依據排序記錄。</span><span class="sxs-lookup"><span data-stu-id="e0426-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="e0426-275">因為每個新的記錄的`ProductID`大於每當它附加至方格的結尾新增新產品的最後一個值。</span><span class="sxs-lookup"><span data-stu-id="e0426-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="e0426-276">因此，您可能要自動將使用者傳送至 GridView 的最後一頁中，加入新的記錄之後變更。</span><span class="sxs-lookup"><span data-stu-id="e0426-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="e0426-277">這可藉由在呼叫之後新增下列程式碼行`ProductsDataSource.Insert()`在`RowCommand`以指出使用者必須要傳送的最後一個頁面之後的資料繫結至 GridView 的事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="e0426-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="e0426-278">`SendUserToLastPage` 頁面層級的布林值變數，一開始會指派值為`False`。</span><span class="sxs-lookup"><span data-stu-id="e0426-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="e0426-279">在 GridView`DataBound`事件處理常式，如果`SendUserToLastPage`為 false，`PageIndex`屬性更新為將使用者傳送至最後一頁。</span><span class="sxs-lookup"><span data-stu-id="e0426-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="e0426-280">原因`PageIndex`屬性會設定`DataBound`事件處理常式 (相對於`RowCommand`事件處理常式) 是因為當`RowCommand`事件處理常式，就會引發我們尚未加入至新的記錄 ve`Products`資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="e0426-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="e0426-281">因此，在`RowCommand`事件處理常式的最後一個頁面索引 (`PageCount - 1`) 代表最後一個頁面索引*之前*已新增新的產品。</span><span class="sxs-lookup"><span data-stu-id="e0426-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="e0426-282">對於大部分的要新增的產品，最後一個頁面索引是相同之後加入新的產品。</span><span class="sxs-lookup"><span data-stu-id="e0426-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="e0426-283">當新增的產品會導致新的最後一個頁面索引，如果我們不正確地更新，但`PageIndex`在`RowCommand`事件處理常式，然後我們將會進入第二個至最後一頁 （最後一個頁面索引才能再新增新的產品） 而不是新的最後一頁 index。</span><span class="sxs-lookup"><span data-stu-id="e0426-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="e0426-284">由於`DataBound`已新增新的產品，並將資料重新繫結到方格中，藉由設定之後，就會引發事件處理常式`PageIndex`那里的屬性我們知道我們重新取得正確的最後一個頁面索引。</span><span class="sxs-lookup"><span data-stu-id="e0426-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="e0426-285">最後，本教學課程使用 GridView 會變寬，由於必須針對加入新的產品中收集的欄位數目。</span><span class="sxs-lookup"><span data-stu-id="e0426-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="e0426-286">由於這個寬度，DetailsView s 垂直版面配置可能會偏好的。</span><span class="sxs-lookup"><span data-stu-id="e0426-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="e0426-287">GridView s 可收集較少的輸入，藉以降低整體的寬度。</span><span class="sxs-lookup"><span data-stu-id="e0426-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="e0426-288">我們或許不 t 需要收集`UnitsOnOrder`， `UnitsInStock`，和`ReorderLevel`欄位時加入新的產品，在此情況下無法移除這些欄位從 GridView。</span><span class="sxs-lookup"><span data-stu-id="e0426-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="e0426-289">若要調整所收集的資料，我們可以使用下列方法之一：</span><span class="sxs-lookup"><span data-stu-id="e0426-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="e0426-290">繼續使用`AddProduct`預期值的方法`UnitsOnOrder`， `UnitsInStock`，和`ReorderLevel`欄位。</span><span class="sxs-lookup"><span data-stu-id="e0426-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="e0426-291">在 `Inserting`事件處理常式中，提供硬式編碼，預設要使用這些已移除了插入介面的輸入值。</span><span class="sxs-lookup"><span data-stu-id="e0426-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="e0426-292">建立新的多載`AddProduct`方法中的`ProductsBLL`不接受輸入的類別`UnitsOnOrder`， `UnitsInStock`，和`ReorderLevel`欄位。</span><span class="sxs-lookup"><span data-stu-id="e0426-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="e0426-293">然後，在 ASP.NET 頁面中，設定要使用這個新的多載的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="e0426-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="e0426-294">其中一個選項同樣也會運作。</span><span class="sxs-lookup"><span data-stu-id="e0426-294">Either option will work equally as well.</span></span> <span data-ttu-id="e0426-295">在過去的教學課程我們使用後面這個選項，建立多個多載`ProductsBLL`類別的`UpdateProduct`方法。</span><span class="sxs-lookup"><span data-stu-id="e0426-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="e0426-296">總結</span><span class="sxs-lookup"><span data-stu-id="e0426-296">Summary</span></span>

<span data-ttu-id="e0426-297">GridView 缺少 DetailsView 和 FormView 中找到的內建插入功能，但不少功夫插入介面可加入到頁尾資料列。</span><span class="sxs-lookup"><span data-stu-id="e0426-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="e0426-298">若要只顯示在 GridView 的頁尾資料列設定其`ShowFooter`屬性設`True`。</span><span class="sxs-lookup"><span data-stu-id="e0426-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="e0426-299">頁尾資料列內容可以自訂每個欄位轉換為 TemplateField 欄位和加入插入介面`FooterTemplate`。</span><span class="sxs-lookup"><span data-stu-id="e0426-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="e0426-300">當您在本教學課程中，我們看到`FooterTemplate`可以包含按鈕、 文字方塊、 dropdownlist 進行中，核取方塊，用來填入資料導向 Web 控制項 （例如 dropdownlist 進行），資料來源控制項和驗證控制項。</span><span class="sxs-lookup"><span data-stu-id="e0426-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="e0426-301">以及用來收集使用者 s 的輸入控制項，加入按鈕、 LinkButton、 ImageButton 需要或。</span><span class="sxs-lookup"><span data-stu-id="e0426-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="e0426-302">[新增] 按鈕按一下的時，ObjectDataSource 的`Insert()`啟動插入工作流程會叫用方法。</span><span class="sxs-lookup"><span data-stu-id="e0426-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="e0426-303">ObjectDataSource 會接著呼叫設定的 insert 方法 (`ProductsBLL`類別的`AddProduct`方法，在本教學課程)。</span><span class="sxs-lookup"><span data-stu-id="e0426-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="e0426-304">我們必須將值複製從 GridView s 插入到 ObjectDataSource 介面`InsertParameters`之前叫用插入方法的集合。</span><span class="sxs-lookup"><span data-stu-id="e0426-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="e0426-305">這可藉由程式設計的方式參考插入介面 Web 控制項中之 ObjectDataSource`Inserting`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="e0426-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="e0426-306">本教學課程中完成我們看看增強 GridView 外觀的技術。</span><span class="sxs-lookup"><span data-stu-id="e0426-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="e0426-307">如何使用二進位資料，例如影像、 Pdf、 Word 文件，並依此類推，以及資料 Web 控制項，會檢查下的一個教學課程集。</span><span class="sxs-lookup"><span data-stu-id="e0426-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="e0426-308">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="e0426-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="e0426-309">關於作者</span><span class="sxs-lookup"><span data-stu-id="e0426-309">About the Author</span></span>

<span data-ttu-id="e0426-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="e0426-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e0426-311">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="e0426-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e0426-312">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="e0426-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e0426-313">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e0426-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e0426-314">或透過他的部落格，這位於[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="e0426-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="e0426-315">特別感謝</span><span class="sxs-lookup"><span data-stu-id="e0426-315">Special Thanks To</span></span>

<span data-ttu-id="e0426-316">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="e0426-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e0426-317">本教學課程中的潛在客戶檢閱者已 Bernadette Leigh。</span><span class="sxs-lookup"><span data-stu-id="e0426-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="e0426-318">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="e0426-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e0426-319">如果是這樣，psychic 在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e0426-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="e0426-320">上一步</span><span class="sxs-lookup"><span data-stu-id="e0426-320">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)
