---
uid: web-forms/overview/moving-to-aspnet-20/configuration-and-instrumentation
title: "組態和測試設備 |Microsoft 文件"
author: microsoft
description: "有一些組態中的重大變更和 ASP.NET 2.0 中的檢測。 新的 ASP.NET 組態 API 可讓設定變更，可供 pr..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2005
ms.topic: article
ms.assetid: 21ebbaee-7ed8-45ae-b6c1-c27c88342e48
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/configuration-and-instrumentation
msc.type: authoredcontent
ms.openlocfilehash: 5780bfde928011f46c3f504aec927f2127f10d0d
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/24/2018
---
<a name="configuration-and-instrumentation"></a><span data-ttu-id="6e3bc-104">組態和測試設備</span><span class="sxs-lookup"><span data-stu-id="6e3bc-104">Configuration and Instrumentation</span></span>
====================
<span data-ttu-id="6e3bc-105">by [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="6e3bc-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="6e3bc-106">有一些組態中的重大變更和 ASP.NET 2.0 中的檢測。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-106">There are major changes in configuration and instrumentation in ASP.NET 2.0.</span></span> <span data-ttu-id="6e3bc-107">新的 ASP.NET 組態 API 可讓您以程式設計方式進行組態變更。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-107">The new ASP.NET configuration API allows for configuration changes to be made programmatically.</span></span> <span data-ttu-id="6e3bc-108">此外，許多新的組態設定存在允許新的設定和測試設備。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-108">In addition, many new configuration settings exist allow for new configurations and instrumentation.</span></span>


<span data-ttu-id="6e3bc-109">有一些組態中的重大變更和 ASP.NET 2.0 中的檢測。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-109">There are major changes in configuration and instrumentation in ASP.NET 2.0.</span></span> <span data-ttu-id="6e3bc-110">新的 ASP.NET 組態 API 可讓您以程式設計方式進行組態變更。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-110">The new ASP.NET configuration API allows for configuration changes to be made programmatically.</span></span> <span data-ttu-id="6e3bc-111">此外，許多新的組態設定存在允許新的設定和測試設備。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-111">In addition, many new configuration settings exist allow for new configurations and instrumentation.</span></span>

<span data-ttu-id="6e3bc-112">在此模組中，我們將討論 ASP.NET 組態 API 相關，所以讀取和寫入至 ASP.NET 組態檔，以及我們也將討論 ASP.NET 檢測。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-112">In this module, we will discuss ASP.NET the configuration API as it relates to reading from and writing to ASP.NET configuration files, and we will also cover ASP.NET instrumentation.</span></span> <span data-ttu-id="6e3bc-113">我們也將討論 ASP.NET 追蹤中可用的新功能。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-113">We will also cover the new features available in ASP.NET tracing.</span></span>

## <a name="aspnet-configuration-api"></a><span data-ttu-id="6e3bc-114">ASP.NET 組態應用程式開發介面</span><span class="sxs-lookup"><span data-stu-id="6e3bc-114">ASP.NET Configuration API</span></span>

<span data-ttu-id="6e3bc-115">ASP.NET 組態應用程式開發介面可讓您開發、 部署和管理應用程式組態資料使用單一的程式設計介面。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-115">The ASP.NET configuration API allows you to develop, deploy, and manage application configuration data by using a single programming interface.</span></span> <span data-ttu-id="6e3bc-116">您可以使用組態 API 以開發和以程式設計方式修改完成的 ASP.NET 設定，而不用直接編輯組態檔中的 XML。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-116">You can use the configuration API to develop and modify complete ASP.NET configurations programmatically without directly editing the XML in the configuration files.</span></span> <span data-ttu-id="6e3bc-117">此外，您可以使用組態 API 在主控台應用程式與您所開發的指令碼、 Web 為基礎的管理工具和 Microsoft Management Console (MMC) 嵌入式管理單元。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-117">In addition, you can use the configuration API in console applications and scripts that you develop, in Web-based management tools, and in Microsoft Management Console (MMC) snap-ins.</span></span>

<span data-ttu-id="6e3bc-118">下列兩種設定管理工具使用的組態應用程式開發介面，並隨附於.NET Framework 2.0 版：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-118">The following two configuration-management tools use the configuration API and are included with the .NET Framework version 2.0:</span></span>

- <span data-ttu-id="6e3bc-119">ASP.NET MMC 嵌入式管理單元，以簡化系統管理工作使用的組態應用程式開發介面，可提供本機組態資料從組態階層架構的所有層級的整合式的檢視。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-119">The ASP.NET MMC snap-in, which uses the configuration API to simplify administrative tasks, providing an integrated view of local configuration data from all levels of the configuration hierarchy.</span></span>
- <span data-ttu-id="6e3bc-120">網站管理工具，可讓您管理本機和遠端應用程式的組態設定，包括裝載站台。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-120">The Web Site Administration Tool, which allows you to manage configuration settings for local and remote applications, including hosted sites.</span></span>

<span data-ttu-id="6e3bc-121">ASP.NET 組態應用程式開發介面包含一組可讓您以程式設計方式設定網站和應用程式的 ASP.NET 管理物件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-121">The ASP.NET configuration API comprises a set of ASP.NET management objects that you can use to configure Web sites and applications programmatically.</span></span> <span data-ttu-id="6e3bc-122">管理物件會實作為.NET Framework 類別庫。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-122">Management objects are implemented as a .NET Framework class library.</span></span> <span data-ttu-id="6e3bc-123">設定應用程式開發介面的程式設計模型可協助確保程式碼的一致性和可靠性，方法是在編譯時期強制資料類型。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-123">The configuration API programming model helps ensure code consistency and reliability by enforcing data types at compile time.</span></span> <span data-ttu-id="6e3bc-124">若要讓您更輕鬆地管理應用程式組態，組態 API 可讓您檢視會從組態階層架構中的所有點合併，當做單一集合，而不是檢視的資料做為個別的集合，從不同的資料組態檔。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-124">To make it easier to manage application configurations, the configuration API allows you to view data that is merged from all points in the configuration hierarchy as a single collection, instead of viewing the data as separate collections from different configuration files.</span></span> <span data-ttu-id="6e3bc-125">此外，設定應用程式開發介面可讓您管理整個應用程式組態，而不用直接編輯組態檔中的 XML。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-125">Additionally, the configuration API enables you to manipulate entire application configurations without directly editing the XML in the configuration files.</span></span> <span data-ttu-id="6e3bc-126">最後，此 API 簡化設定工作所支援的系統管理工具，例如網站管理工具。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-126">Finally, the API simplifies configuration tasks by supporting administrative tools, such as the Web Site Administration Tool.</span></span> <span data-ttu-id="6e3bc-127">組態 API 支援的組態檔的電腦上建立和多部電腦上執行組態指令碼，藉以簡化部署。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-127">The configuration API simplifies deployment by supporting the creation of configuration files on a computer and running configuration scripts across multiple computers.</span></span>

> [!NOTE]
> <span data-ttu-id="6e3bc-128">設定應用程式開發介面不支援建立 IIS 應用程式。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-128">The configuration API does not support the creation of IIS applications.</span></span>


## <a name="working-with-local-and-remote-configuration-settings"></a><span data-ttu-id="6e3bc-129">使用本機和遠端組態設定</span><span class="sxs-lookup"><span data-stu-id="6e3bc-129">Working with Local and Remote Configuration Settings</span></span>

<span data-ttu-id="6e3bc-130">組態物件代表套用至特定的實際實體，例如電腦，或邏輯實體，例如應用程式或網站的組態設定的合併的檢視。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-130">A Configuration object represents the merged view of the configuration settings that apply to a specific physical entity, such as a computer, or to a logical entity, such as an application or a Web site.</span></span> <span data-ttu-id="6e3bc-131">在本機電腦上或遠端伺服器上，可以存在於指定的邏輯實體。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-131">The specified logical entity can exist on the local computer or on a remote server.</span></span> <span data-ttu-id="6e3bc-132">當沒有組態檔存在指定的實體時，組態物件表示的預設組態設定所定義的 Machine.config 檔案。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-132">When no configuration file exists for a specified entity, the Configuration object represents the default configuration settings as defined by the Machine.config file.</span></span>

<span data-ttu-id="6e3bc-133">您可以使用其中一種開啟設定方法，從下列類別，以取得組態物件：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-133">You can get a Configuration object by using one of the open configuration methods from the following classes:</span></span>

1. <span data-ttu-id="6e3bc-134">ConfigurationManager 類別，如果您的實體為用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-134">The ConfigurationManager class, if your entity is a client application.</span></span>
2. <span data-ttu-id="6e3bc-135">WebConfigurationManager 類別，如果實體是 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-135">The WebConfigurationManager class, if your entity is a Web application.</span></span>

<span data-ttu-id="6e3bc-136">這些方法會傳回設定物件，其中會提供必要的方法和屬性來處理基礎的組態檔。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-136">These methods will return a Configuration object, which in turn provides the required methods and properties to handle the underlying configuration files.</span></span> <span data-ttu-id="6e3bc-137">您可以存取這些檔案進行讀取或寫入。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-137">You can access these files for reading or writing.</span></span>

### <a name="reading"></a><span data-ttu-id="6e3bc-138">讀取</span><span class="sxs-lookup"><span data-stu-id="6e3bc-138">Reading</span></span>

<span data-ttu-id="6e3bc-139">您可以使用 GetSection 或 GetSectionGroup 方法來讀取設定資訊。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-139">You use the GetSection or GetSectionGroup method to read configuration information.</span></span> <span data-ttu-id="6e3bc-140">使用者讀取或處理序必須擁有讀取權限的所有階層中的組態檔案。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-140">The user or process that reads must have Read permissions on all of the configuration files in the hierarchy.</span></span>

> [!NOTE]
> <span data-ttu-id="6e3bc-141">如果您使用靜態 GetSection 方法採用的路徑參數，path 參數必須參考應用程式程式碼正在執行。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-141">If you use a static GetSection method that takes a path parameter, the path parameter must refer to the application in which the code is running.</span></span> <span data-ttu-id="6e3bc-142">否則，會忽略此參數並傳回目前執行的應用程式的組態資訊。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-142">Otherwise, the parameter is ignored and the configuration information for the currently running application is returned.</span></span>


### <a name="writing"></a><span data-ttu-id="6e3bc-143">撰寫</span><span class="sxs-lookup"><span data-stu-id="6e3bc-143">Writing</span></span>

<span data-ttu-id="6e3bc-144">您可以使用其中一種儲存方法寫入組態資訊。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-144">You use one of the Save methods to write configuration information.</span></span> <span data-ttu-id="6e3bc-145">使用者或處理程序，其必須寫入的寫入權限組態檔案和目錄，在目前的組態階層層級，以及讀取權限階層中的組態檔的所有。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-145">The user or process that writes must have Write permissions on the configuration file and directory at the current configuration hierarchy level, as well as Read permissions on all of the configuration files in the hierarchy.</span></span>

<span data-ttu-id="6e3bc-146">若要產生的組態檔，代表指定之實體的繼承的組態設定，請使用下列儲存組態方法的其中一個：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-146">To generate a configuration file that represents the inherited configuration settings for a specified entity, use one of the following save-configuration methods:</span></span>

1. <span data-ttu-id="6e3bc-147">要建立新的組態檔的儲存方法。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-147">The Save method to create a new configuration file.</span></span>
2. <span data-ttu-id="6e3bc-148">SaveAs 方法，以產生新的組態檔，另一個位置。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-148">The SaveAs method to generate a new configuration file at another location.</span></span>

## <a name="configuration-classes-and-namespaces"></a><span data-ttu-id="6e3bc-149">組態類別和命名空間</span><span class="sxs-lookup"><span data-stu-id="6e3bc-149">Configuration Classes and Namespaces</span></span>

<span data-ttu-id="6e3bc-150">是類似於每個其他許多組態類別和方法。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-150">Many configuration classes and methods are similar to each other.</span></span> <span data-ttu-id="6e3bc-151">下表描述最常使用的組態類別和命名空間。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-151">The following table describes the most commonly used configuration classes and namespaces.</span></span>

| <span data-ttu-id="6e3bc-152">**設定類別或命名空間**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-152">**Configuration class or namespace**</span></span> | <span data-ttu-id="6e3bc-153">**描述**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-153">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="6e3bc-154">[System.Configuration](https://msdn.microsoft.com/library/system.configuration.aspx) namespace</span><span class="sxs-lookup"><span data-stu-id="6e3bc-154">[System.Configuration](https://msdn.microsoft.com/library/system.configuration.aspx) namespace</span></span> | <span data-ttu-id="6e3bc-155">包含所有的.NET Framework 應用程式的主要組態類別。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-155">Contains the main configuration classes for all .NET Framework applications.</span></span> <span data-ttu-id="6e3bc-156">區段處理常式類別可用來從方法，例如 GetSection 和 GetSectionGroup 取得區段的組態資料。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-156">Section handler classes are used to obtain configuration data for a section from methods, such as GetSection and GetSectionGroup.</span></span> <span data-ttu-id="6e3bc-157">這兩種方法為非靜態。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-157">These two methods are non-static.</span></span> |
| <span data-ttu-id="6e3bc-158">System.Configuration.Configuration 類別</span><span class="sxs-lookup"><span data-stu-id="6e3bc-158">System.Configuration.Configuration class</span></span> | <span data-ttu-id="6e3bc-159">代表一組的電腦、 應用程式、 Web 目錄或其他資源的設定資料。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-159">Represents a set of configuration data for a computer, application, Web directory, or other resource.</span></span> <span data-ttu-id="6e3bc-160">這個類別包含有用的方法，例如 GetSection 和 GetSectionGroup，更新組態設定和取得參考區段或區段群組。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-160">This class contains useful methods, such as GetSection and GetSectionGroup, for updating configuration settings and obtaining references to sections and section groups.</span></span> <span data-ttu-id="6e3bc-161">這個類別用於取得設計階段組態資料，例如 WebConfigurationManager 和 ConfigurationManager 類別方法的方法當做傳回型別。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-161">This class is used as a return type for methods that obtain design-time configuration data, such as the methods of the WebConfigurationManager and ConfigurationManager classes.</span></span> |
| <span data-ttu-id="6e3bc-162">System.Web.Configuration namespace</span><span class="sxs-lookup"><span data-stu-id="6e3bc-162">System.Web.Configuration namespace</span></span> | <span data-ttu-id="6e3bc-163">ASP.NET 組態區段會定義在包含區段處理常式類別[ASP.NET 組態設定](https://msdn.microsoft.com/library/b5ysx397.aspx)。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-163">Contains the section handler classes for the ASP.NET configuration sections defined at [ASP.NET Configuration Settings](https://msdn.microsoft.com/library/b5ysx397.aspx).</span></span> <span data-ttu-id="6e3bc-164">區段處理常式類別可用來從方法，例如 GetSection 和 GetSectionGroup 取得區段的組態資料。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-164">Section handler classes are used to obtain configuration data for a section from methods, such as GetSection and GetSectionGroup.</span></span> |
| <span data-ttu-id="6e3bc-165">System.Web.Configuration.WebConfigurationManager class</span><span class="sxs-lookup"><span data-stu-id="6e3bc-165">System.Web.Configuration.WebConfigurationManager class</span></span> | <span data-ttu-id="6e3bc-166">提供有用的方法，以取得執行階段和設計階段的組態設定的參考。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-166">Provides useful methods for obtaining references to run-time and design-time configuration settings.</span></span> <span data-ttu-id="6e3bc-167">這些方法會使用 System.Configuration.Configuration 類別做為傳回類型。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-167">These methods use the System.Configuration.Configuration class as a return type.</span></span> <span data-ttu-id="6e3bc-168">您可以使用這個類別的靜態 GetSection 方法或 System.Configuration.ConfigurationManager 類別非靜態 GetSection 方法交換使用。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-168">You can use the static GetSection method of this class or the non-static GetSection method of the System.Configuration.ConfigurationManager class interchangeably.</span></span> <span data-ttu-id="6e3bc-169">對於 Web 應用程式設定，而不是 System.Configuration.ConfigurationManager 類別建議 System.Web.Configuration.WebConfigurationManager 類別。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-169">For Web application configurations, the System.Web.Configuration.WebConfigurationManager class is recommended instead of the System.Configuration.ConfigurationManager class.</span></span> |
| <span data-ttu-id="6e3bc-170">[System.Configuration.Provider](https://msdn.microsoft.com/library/system.configuration.provider.aspx) namespace</span><span class="sxs-lookup"><span data-stu-id="6e3bc-170">[System.Configuration.Provider](https://msdn.microsoft.com/library/system.configuration.provider.aspx) namespace</span></span> | <span data-ttu-id="6e3bc-171">提供方法，以自訂和擴充的組態提供者。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-171">Provides a way to customize and extend the configuration provider.</span></span> <span data-ttu-id="6e3bc-172">這是所有的提供者類別的基底類別中的組態系統。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-172">This is the base class for all provider classes in the configuration system.</span></span> |
| <span data-ttu-id="6e3bc-173">[System.Web.Management](https://msdn.microsoft.com/library/system.web.management.aspx) namespace</span><span class="sxs-lookup"><span data-stu-id="6e3bc-173">[System.Web.Management](https://msdn.microsoft.com/library/system.web.management.aspx) namespace</span></span> | <span data-ttu-id="6e3bc-174">包含類別和介面來管理和監視的 Web 應用程式的健全狀況。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-174">Contains classes and interfaces for managing and monitoring the health of Web applications.</span></span> <span data-ttu-id="6e3bc-175">嚴格來說，此命名空間不會視為組態 API 的一部分。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-175">Strictly speaking, this namespace is not considered part of the configuration API.</span></span> <span data-ttu-id="6e3bc-176">比方說，追蹤和事件引發便可達成此命名空間中的類別。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-176">For example, tracing and event firing is accomplished by the classes in this namespace.</span></span> |
| <span data-ttu-id="6e3bc-177">[System.Management.Instrumentation](https://msdn.microsoft.com/library/system.management.instrumentation.aspx)命名空間</span><span class="sxs-lookup"><span data-stu-id="6e3bc-177">[System.Management.Instrumentation](https://msdn.microsoft.com/library/system.management.instrumentation.aspx) namespace</span></span> | <span data-ttu-id="6e3bc-178">提供的應用程式公開其管理資訊和潛在取用者透過 Windows Management Instrumentation (WMI) 事件檢測所需的類別。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-178">Provides the classes necessary for the instrumentation of applications to expose their management information and events through Windows Management Instrumentation (WMI) to potential consumers.</span></span> <span data-ttu-id="6e3bc-179">ASP.NET 健康監視使用 WMI 傳遞事件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-179">ASP.NET health monitoring uses WMI to deliver events.</span></span> <span data-ttu-id="6e3bc-180">嚴格來說，此命名空間不會視為組態 API 的一部分。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-180">Strictly speaking, this namespace is not considered part of the configuration API.</span></span> |

## <a name="reading-from-aspnet-configuration-files"></a><span data-ttu-id="6e3bc-181">ASP.NET 組態檔讀取</span><span class="sxs-lookup"><span data-stu-id="6e3bc-181">Reading from ASP.NET Configuration Files</span></span>

<span data-ttu-id="6e3bc-182">WebConfigurationManager 類別是 ASP.NET 組態檔讀取的核心類別。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-182">The WebConfigurationManager class is the core class for reading from ASP.NET configuration files.</span></span> <span data-ttu-id="6e3bc-183">有三個步驟基本上閱讀 ASP.NET 組態檔：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-183">There are essentially three steps to reading ASP.NET configuration files:</span></span>

1. <span data-ttu-id="6e3bc-184">取得組態物件使用 OpenWebConfiguration 方法。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-184">Get a Configuration object using the OpenWebConfiguration method.</span></span>
2. <span data-ttu-id="6e3bc-185">取得所需的區段的組態檔中的參考。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-185">Get a reference to the desired section in the configuration file.</span></span>
3. <span data-ttu-id="6e3bc-186">從組態檔中讀取所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-186">Read the desired information from the configuration file.</span></span>

<span data-ttu-id="6e3bc-187">物件代表的組態不代表特定設定檔。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-187">The Configuration object represents does not represent a particular configuration file.</span></span> <span data-ttu-id="6e3bc-188">相反地，它代表電腦、 應用程式或網站設定的合併的檢視。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-188">Instead, it represents a merged view of the configuration of a computer, application, or Web site.</span></span> <span data-ttu-id="6e3bc-189">下列程式碼範例會具現化組態物件，代表呼叫的 Web 應用程式組態*ProductInfo*。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-189">The following code sample instantiates a Configuration object representing the configuration of a Web application called *ProductInfo*.</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample1.cs)]

> [!NOTE]
> <span data-ttu-id="6e3bc-190">請注意，是否 /ProductInfo 路徑不存在，上述程式碼會傳回所指定的預設組態，machine.config 檔案中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-190">Note that if the /ProductInfo path doesn't exist, the above code will return the default configuration as specified in the machine.config file.</span></span>


<span data-ttu-id="6e3bc-191">組態物件之後，您可以再使用 GetSection 或 GetSectionGroup 方法鑽研的組態設定。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-191">Once you have the Configuration object, you can then use the GetSection or GetSectionGroup method to drill into the configuration settings.</span></span> <span data-ttu-id="6e3bc-192">下列範例會取得上述 ProductInfo 應用程式的模擬設定的參考：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-192">The following example gets a reference to the impersonation settings for the above ProductInfo application:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample2.cs)]

## <a name="writing-to-aspnet-configuration-files"></a><span data-ttu-id="6e3bc-193">寫入至 ASP.NET 組態檔</span><span class="sxs-lookup"><span data-stu-id="6e3bc-193">Writing to ASP.NET Configuration Files</span></span>

<span data-ttu-id="6e3bc-194">讀取組態檔，如同 WebConfigurationManager 類別是寫入至 Asp.NET 組態檔。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-194">As in reading from configuration files, the WebConfigurationManager class is the core for writing to Asp.NET configuration files.</span></span> <span data-ttu-id="6e3bc-195">也有三個步驟來寫入 ASP.NET 組態檔。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-195">There are also three steps to writing to ASP.NET configuration files.</span></span>

1. <span data-ttu-id="6e3bc-196">取得組態物件使用 OpenWebConfiguration 方法。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-196">Get a Configuration object using the OpenWebConfiguration method.</span></span>
2. <span data-ttu-id="6e3bc-197">取得所需的區段的組態檔中的參考。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-197">Get a reference to the desired section in the configuration file.</span></span>
3. <span data-ttu-id="6e3bc-198">寫入所需的資訊從組態檔使用 儲存 或 另存新檔方法。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-198">Write the desired information from the configuration file using the Save or SaveAs method.</span></span>

<span data-ttu-id="6e3bc-199">下列程式碼變更**偵錯**屬性&lt;編譯&gt;為 false 的項目：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-199">The following code changes the **debug** attribute of the &lt;compilation&gt; element to false:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample3.cs)]

<span data-ttu-id="6e3bc-200">執行此程式碼時，**偵錯**屬性&lt;編譯&gt;項目會設為 false *webApp*應用程式的 web.config 檔案。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-200">When this code is executed, the **debug** attribute of the &lt;compilation&gt; element will be set to false for the *webApp* application's web.config file.</span></span>

## <a name="systemwebmanagement-namespace"></a><span data-ttu-id="6e3bc-201">System.Web.Management 命名空間</span><span class="sxs-lookup"><span data-stu-id="6e3bc-201">System.Web.Management Namespace</span></span>

<span data-ttu-id="6e3bc-202">System.Web.Management 命名空間提供類別和介面來管理和監視的 ASP.NET 應用程式的健全狀況。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-202">The System.Web.Management namespace provides the classes and interfaces for managing and monitoring the health of ASP.NET applications.</span></span>

<span data-ttu-id="6e3bc-203">記錄被透過定義規則與提供者產生關聯的事件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-203">Logging is accomplished by defining a rule that associates events with a provider.</span></span> <span data-ttu-id="6e3bc-204">規則定義事件傳送至提供者的類型。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-204">The rule defines the type of events that are sent to the provider.</span></span> <span data-ttu-id="6e3bc-205">下列的基底事件可供您記錄：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-205">The following base events are available for you to log:</span></span>

| <span data-ttu-id="6e3bc-206">**WebBaseEvent**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-206">**WebBaseEvent**</span></span> | <span data-ttu-id="6e3bc-207">所有事件的基底事件類別。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-207">The base event class for all events.</span></span> <span data-ttu-id="6e3bc-208">包含所需的所有事件，例如 事件程式碼中，事件詳細資料代碼、 日期和時間引發事件，內容序號、 事件訊息及事件的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-208">Contains the required properties for all events such as event code, event detail code, the date and time the event was raised, sequence number, the event message, and event details.</span></span> |
| --- | --- |
| <span data-ttu-id="6e3bc-209">**WebManagementEvent**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-209">**WebManagementEvent**</span></span> | <span data-ttu-id="6e3bc-210">管理事件，例如應用程式存留期、 要求、 錯誤和稽核事件基底事件類別。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-210">The base event class for management events, such as application lifetime, request, error, and audit events.</span></span> |
| <span data-ttu-id="6e3bc-211">**WebHeartbeatEvent**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-211">**WebHeartbeatEvent**</span></span> | <span data-ttu-id="6e3bc-212">定期擷取有用的執行階段狀態資訊的應用程式所產生的事件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-212">The event generated by the application in regular intervals to capture useful runtime state information.</span></span> |
| <span data-ttu-id="6e3bc-213">**WebAuditEvent**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-213">**WebAuditEvent**</span></span> | <span data-ttu-id="6e3bc-214">安全性稽核事件，用來標記授權失敗，解密失敗，例如條件的基底類別*等等。*</span><span class="sxs-lookup"><span data-stu-id="6e3bc-214">The base class for security audit events, which are used to mark conditions such as authorization failure, decryption failure, *etc.*</span></span> |
| <span data-ttu-id="6e3bc-215">**WebRequestEvent**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-215">**WebRequestEvent**</span></span> | <span data-ttu-id="6e3bc-216">所有資訊要求事件基底類別。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-216">The base class for all informational request events.</span></span> |
| <span data-ttu-id="6e3bc-217">**WebBaseErrorEvent**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-217">**WebBaseErrorEvent**</span></span> | <span data-ttu-id="6e3bc-218">指出錯誤條件的所有事件基底類別。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-218">The base class for all events indicating error conditions.</span></span> |

<span data-ttu-id="6e3bc-219">可用提供者類型可讓您將事件輸出傳送到事件檢視器、 SQL Server、 Windows Management Instrumentation (WMI) 和電子郵件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-219">The types of providers available allow you to send event output to Event Viewer, SQL Server, Windows Management Instrumentation (WMI), and e-mail.</span></span> <span data-ttu-id="6e3bc-220">預先設定的提供者和事件對應減少記錄的事件輸出所需的工作量。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-220">The pre-configured providers and event mappings reduce the amount of work necessary to get event output logged.</span></span>

<span data-ttu-id="6e3bc-221">ASP.NET 2.0 使用事件記錄檔提供者--現成的應用程式定義域啟動和停止，以及記錄任何未處理的例外狀況為基礎的事件記錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-221">ASP.NET 2.0 uses the Event Log provider out-of-the-box to log events based on application domains starting and stopping, as well as logging any unhandled exceptions.</span></span> <span data-ttu-id="6e3bc-222">這有助於涵蓋一些基本的案例。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-222">This helps to cover some of the basic scenarios.</span></span> <span data-ttu-id="6e3bc-223">例如，假設您的應用程式會擲回的例外狀況，但使用者不會儲存錯誤並無法重現。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-223">For example, let's say that your application throws an exception, but the user doesn't save the error and you can't reproduce it.</span></span> <span data-ttu-id="6e3bc-224">使用預設的事件記錄檔規則，您可以收集進一步了解何種錯誤發生的例外狀況和堆疊的資訊。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-224">With the default Event Log rule, you would be able to gather the exception and stack information to get a better idea of what kind of error occurred.</span></span> <span data-ttu-id="6e3bc-225">如果您的應用程式正失去工作階段狀態，則適用於另一個範例。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-225">Another example applies if your application is losing session state.</span></span> <span data-ttu-id="6e3bc-226">在此情況下，您可以查看事件記錄檔，以判斷是否會回收應用程式定義域，並在應用程式定義域在第一次停止的原因。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-226">In that case, you can look in the Event Log to determine whether the application domain is recycling, and why the application domain stopped in the first place.</span></span>

<span data-ttu-id="6e3bc-227">此外，監視系統健全狀況是可延伸。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-227">Also, the health monitoring system is extensible.</span></span> <span data-ttu-id="6e3bc-228">比方說，您可以定義自訂的 Web 事件、 應用程式中引發，然後定義規則來傳送事件資訊至提供者，例如您的電子郵件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-228">For example, you can define custom Web events, fire them within your application, and then define a rule to send the event information to a provider such as your e-mail.</span></span> <span data-ttu-id="6e3bc-229">這可讓您輕鬆地結合您檢測健康監視提供者。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-229">This allows you to easily tie your instrumentation to the health monitoring providers.</span></span> <span data-ttu-id="6e3bc-230">另舉一例，您無法處理訂單和設定規則，將每個事件傳送至 SQL Server 資料庫，每次引發事件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-230">As another example, you could fire an event each time an order is processed and set up a rule that sends each event to the SQL Server database.</span></span> <span data-ttu-id="6e3bc-231">您也可以引發事件時在使用者無法登入多次列的資料，並將事件設定為使用的電子郵件為基礎的提供者。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-231">You could also fire an event when a user fails to log on multiple times in a row, and set up the event to use the e-mail-based providers.</span></span>

<span data-ttu-id="6e3bc-232">預設的提供者和事件的組態會儲存在通用的 Web.config 檔案。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-232">The configuration for the default providers and events is stored in the global Web.config file.</span></span> <span data-ttu-id="6e3bc-233">通用的 Web.config 檔案會儲存所有網頁設定 ASP.NET 1 中的 Machine.config 檔案中所儲存 x。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-233">The global Web.config file stores all the Web-based settings that were stored in the Machine.config file in ASP.NET 1x.</span></span> <span data-ttu-id="6e3bc-234">通用的 Web.config 檔案位於下列目錄：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-234">The global Web.config file is located in the following directory:</span></span>

`%windir%\Microsoft.Net\Framework\v2.0.*\config\Web.config`

<span data-ttu-id="6e3bc-235">&lt;HealthMonitoring&gt;全域的 Web.config 檔案區段提供的預設組態設定。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-235">The &lt;healthMonitoring&gt; section of the global Web.config file provides default configuration settings.</span></span> <span data-ttu-id="6e3bc-236">您可以覆寫這些設定，或藉由實作您自己設定&lt;healthMonitoring&gt;您的應用程式的 Web.config 檔案中的一節。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-236">You can override these setting or configure your own settings by implementing the &lt;healthMonitoring&gt; section in the Web.config file for your application.</span></span>

<span data-ttu-id="6e3bc-237">&lt;HealthMonitoring&gt;全域的 Web.config 檔案區段包含下列項目：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-237">The &lt;healthMonitoring&gt; section of the global Web.config file contains the following items:</span></span>

| <span data-ttu-id="6e3bc-238">**提供者**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-238">**providers**</span></span> | <span data-ttu-id="6e3bc-239">包含提供者的事件檢視器、 WMI 和 SQL Server 設定。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-239">Contains providers set up for the Event Viewer, WMI, and SQL Server.</span></span> |
| --- | --- |
| <span data-ttu-id="6e3bc-240">**eventMappings**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-240">**eventMappings**</span></span> | <span data-ttu-id="6e3bc-241">包含各種 WebBase 類別的對應。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-241">Contains mappings for the various WebBase classes.</span></span> <span data-ttu-id="6e3bc-242">如果您產生您自己的事件類別，您可以擴充此清單。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-242">You can extend this list if you generate your own event class.</span></span> <span data-ttu-id="6e3bc-243">產生您自己的事件類別可讓您更精細的資料粒度上您將資訊傳送至的提供者。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-243">Generating your own event class gives you finer granularity over the providers you send information to.</span></span> <span data-ttu-id="6e3bc-244">例如，您可以設定要傳送您的電子郵件的自訂事件時傳送至 SQL Server 的未處理例外狀況。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-244">For example, you could configure unhandled exceptions to be sent to SQL Server, while sending your own custom events to e-mail.</span></span> |
| <span data-ttu-id="6e3bc-245">**規則**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-245">**rules**</span></span> | <span data-ttu-id="6e3bc-246">提供者 eventMappings 的連結。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-246">Links the eventMappings to the provider.</span></span> |
| <span data-ttu-id="6e3bc-247">**buffering**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-247">**buffering**</span></span> | <span data-ttu-id="6e3bc-248">搭配 SQL Server 和電子郵件提供者，以決定排清至提供者的事件的頻率。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-248">Used with SQL Server and e-mail providers to determine how often to flush the events to the provider.</span></span> |

<span data-ttu-id="6e3bc-249">以下是全域的 Web.config 檔案中的程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-249">Below is a code example from the global Web.config file.</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample4.xml)]

## <a name="how-to-store-events-to-event-viewer"></a><span data-ttu-id="6e3bc-250">如何儲存事件到事件檢視器</span><span class="sxs-lookup"><span data-stu-id="6e3bc-250">How to store events to Event Viewer</span></span>

<span data-ttu-id="6e3bc-251">如先前所述，以記錄事件提供者在事件檢視器會為您設定通用的 Web.config 檔案中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-251">As mentioned earlier, the provider for logging events in the Event Viewer is configured for you in the global Web.config file.</span></span> <span data-ttu-id="6e3bc-252">根據預設，所有事件都根據**WebBaseErrorEvent**和**WebFailureAuditEvent**記錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-252">By default, all events based on **WebBaseErrorEvent** and **WebFailureAuditEvent** are logged.</span></span> <span data-ttu-id="6e3bc-253">您可以加入額外的規則，以記錄至事件記錄檔的其他資訊。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-253">You can add additional rules to log additional information to the Event Log.</span></span> <span data-ttu-id="6e3bc-254">例如，如果您想要記錄所有事件 (*也就是*，根據每個事件**WebBaseEvent**)，您無法加入 Web.config 檔案中的下列規則：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-254">For example, if you wanted to log all events (*i.e.*, every event based on **WebBaseEvent**), you could add the following rule to your Web.config file:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample5.xml)]

<span data-ttu-id="6e3bc-255">此規則會連結**所有事件**事件對應到事件記錄檔提供者。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-255">This rule would link the **All Events** event map to the Event Log provider.</span></span> <span data-ttu-id="6e3bc-256">EventMapping 和提供者會包含在通用的 Web.config 檔案中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-256">Both eventMapping and the provider are included in the global Web.config file.</span></span>

## <a name="how-to-store-events-to-sql-server"></a><span data-ttu-id="6e3bc-257">如何儲存至 SQL Server 事件</span><span class="sxs-lookup"><span data-stu-id="6e3bc-257">How to store events to SQL Server</span></span>

<span data-ttu-id="6e3bc-258">這個方法會使用**ASPNETDB**資料庫產生 Aspnet\_regsql.exe 工具。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-258">This method uses the **ASPNETDB** database, which is generated by the Aspnet\_regsql.exe tool.</span></span> <span data-ttu-id="6e3bc-259">預設的提供者會使用 LocalSqlServer 連接字串，其中的應用程式中使用其中一個檔案為基礎的資料庫\_資料夾或 SQL Server 的本機 SQLExpress 執行個體。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-259">The default provider uses the LocalSqlServer connection string, which uses either a file-based database in the App\_data folder or the local SQLExpress instance of SQL Server.</span></span> <span data-ttu-id="6e3bc-260">LocalSqlServer 連接字串和根據 SqlProvider 通用的 Web.config 檔案中設定。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-260">Both the LocalSqlServer connection string and the SqlProvider are configured in the global Web.config file.</span></span>

<span data-ttu-id="6e3bc-261">通用的 Web.config 檔案中的 LocalSqlServer 連接字串看起來像這樣：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-261">The LocalSqlServer connection string in the global Web.config file looks like this:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample6.xml)]

<span data-ttu-id="6e3bc-262">如果您想要使用其他 SQL Server 執行個體，您必須使用 Aspnet\_regsql.exe 工具位於 %windir%\microsoft.net\framework\v2.0。\*資料夾。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-262">If you want to use another SQL Server instance, you'll need to use the Aspnet\_regsql.exe tool, which can be found in the %windir%\Microsoft.Net\Framework\v2.0.\* folder.</span></span> <span data-ttu-id="6e3bc-263">使用 Aspnet\_regsql.exe 工具來產生自訂**ASPNETDB**資料庫上的 SQL Server 執行個體，然後將連接字串加入至您的應用程式組態檔，然後使用新的新增提供者連接字串。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-263">Use the Aspnet\_regsql.exe tool to generate a custom **ASPNETDB** database on the SQL Server instance, then add the connection string to your applications configuration file, and then add a provider by using the new connection string.</span></span> <span data-ttu-id="6e3bc-264">一旦**ASPNETDB**所建立的資料庫，您必須設定規則來根據 sqlProvider 連結 eventMapping。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-264">Once you have the **ASPNETDB** database created, you'll need to set a rule to link an eventMapping to the sqlProvider.</span></span>

<span data-ttu-id="6e3bc-265">無論您使用預設值根據 SqlProvider，或是設定自己的提供者，您必須新增連結事件對應與提供者的規則。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-265">Whether you use the default SqlProvider or configure your own provider, you'll need to add a rule linking the provider with an event map.</span></span> <span data-ttu-id="6e3bc-266">下列規則連結到先前建立的新提供者**所有事件**事件對應。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-266">The following rule links the new provider that you created above to the **All Events** event map.</span></span> <span data-ttu-id="6e3bc-267">此規則會記錄為基礎的所有事件**WebBaseEvent**並傳送給 MySqlWebEventProvider 讓 MYASPNETDB 連接字串。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-267">This rule will log all the events based on **WebBaseEvent** and send them to the MySqlWebEventProvider that will use the MYASPNETDB connection string.</span></span> <span data-ttu-id="6e3bc-268">下列程式碼加入規則，以連結事件對應的提供者：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-268">The following code adds a rule to link the provider with an event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample7.xml)]

<span data-ttu-id="6e3bc-269">如果您想要只將錯誤傳送給 SQL Server，您可以加入下列規則：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-269">If you wanted to only send errors to SQL Server, you could add the following rule:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample8.xml)]

## <a name="how-to-forward-events-to-wmi"></a><span data-ttu-id="6e3bc-270">如何將事件轉寄至 WMI</span><span class="sxs-lookup"><span data-stu-id="6e3bc-270">How to forward events to WMI</span></span>

<span data-ttu-id="6e3bc-271">您也可以轉送事件的 wmi。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-271">You can also forward the events to WMI.</span></span> <span data-ttu-id="6e3bc-272">WMI 提供者會根據預設，為您設定通用的 Web.config 檔案中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-272">The WMI provider is configured for you in the global Web.config file by default.</span></span>

<span data-ttu-id="6e3bc-273">下列程式碼範例會加入規則，以事件轉送給 WMI:</span><span class="sxs-lookup"><span data-stu-id="6e3bc-273">The following code example adds a rule to forward the events to WMI:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample9.xml)]

<span data-ttu-id="6e3bc-274">您必須新增規則，以便將 eventMapping 提供者，以及為接聽事件的 WMI 接聽程式的應用程式產生關聯。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-274">You will need to add a rule to associate an eventMapping to the provider, and also a WMI listener application to listen for the events.</span></span> <span data-ttu-id="6e3bc-275">下列程式碼範例會加入規則，以連結到 WMI 提供者**所有事件**事件對應：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-275">The following code example adds a rule to link the WMI provider to the **All Events** event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample10.xml)]

## <a name="how-to-forward-events-to-e-mail"></a><span data-ttu-id="6e3bc-276">如何將事件轉寄至電子郵件</span><span class="sxs-lookup"><span data-stu-id="6e3bc-276">How to forward events to e-mail</span></span>

<span data-ttu-id="6e3bc-277">您也可以轉送電子郵件的事件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-277">You can also forward events to e-mail.</span></span> <span data-ttu-id="6e3bc-278">請小心您對應至您的電子郵件提供者，因為您可以不小心傳送給自己的大量資訊的哪些事件規則可能是較適合 SQL Server 或事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-278">Be careful about which event rules you map to your e-mail provider, as you can unintentionally send yourself a lot of information that may be better suited for SQL Server or the Event Log.</span></span> <span data-ttu-id="6e3bc-279">有兩個電子郵件提供者。SimpleMailWebEventProvider 和 TemplatedMailWebEventProvider。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-279">There are two e-mail providers; SimpleMailWebEventProvider and TemplatedMailWebEventProvider.</span></span> <span data-ttu-id="6e3bc-280">每個有相同的組態屬性，但 「 範本 」 和 「 detailedTemplateErrors"屬性，兩者都是只用於 TemplatedMailWebEventProvider 除外。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-280">Each has the same configuration attributes, with the exception of the "template" and "detailedTemplateErrors" attributes, both of which are only available on the TemplatedMailWebEventProvider.</span></span>

> [!NOTE]
> <span data-ttu-id="6e3bc-281">這些電子郵件提供者都不會為您進行設定。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-281">Neither of these e-mail providers is configured for you.</span></span> <span data-ttu-id="6e3bc-282">您必須將它們新增到您的 Web.config 檔案。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-282">You'll need to add them to your Web.config file.</span></span>


<span data-ttu-id="6e3bc-283">這些兩個電子郵件提供者之間的主要差異是 SimpleMailWebEventProvider 無法修改的一般範本傳送電子郵件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-283">The main difference between these two e-mail providers is that SimpleMailWebEventProvider sends e-mails in a generic template that cannot be modified.</span></span> <span data-ttu-id="6e3bc-284">範例 Web.config 檔案會藉由使用下列規則，將此電子郵件提供者加入至設定的提供者清單：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-284">The sample Web.config file adds this e-mail provider to the list of configured providers by using the following rule:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample11.xml)]

<span data-ttu-id="6e3bc-285">下列規則也會加入至繫結的電子郵件提供者**所有事件**事件對應：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-285">The following rule is also added to tie the e-mail provider to the **All Events** event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample12.xml)]

## <a name="aspnet-20-tracing"></a><span data-ttu-id="6e3bc-286">ASP.NET 2.0 追蹤</span><span class="sxs-lookup"><span data-stu-id="6e3bc-286">ASP.NET 2.0 Tracing</span></span>

<span data-ttu-id="6e3bc-287">有三個主要的增強功能與 ASP.NET 2.0 中的追蹤。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-287">There are three major enhancements to tracing in ASP.NET 2.0.</span></span>

1. <span data-ttu-id="6e3bc-288">整合的追蹤功能</span><span class="sxs-lookup"><span data-stu-id="6e3bc-288">Integrated tracing functionality</span></span>
2. <span data-ttu-id="6e3bc-289">以程式設計方式存取追蹤訊息</span><span class="sxs-lookup"><span data-stu-id="6e3bc-289">Programmatic access to trace messages</span></span>
3. <span data-ttu-id="6e3bc-290">改良的應用程式層級追蹤</span><span class="sxs-lookup"><span data-stu-id="6e3bc-290">Improved application-level tracing</span></span>

## <a name="integrated-tracing-functionality"></a><span data-ttu-id="6e3bc-291">整合追蹤功能</span><span class="sxs-lookup"><span data-stu-id="6e3bc-291">Integrated Tracing Functionality</span></span>

<span data-ttu-id="6e3bc-292">現在可以 System.Diagnostics.Trace 類別會追蹤輸出，ASP.NET 所發出的訊息路由傳送，並將 System.Diagnostics.Trace ASP.NET 追蹤所發出的訊息路由。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-292">You can now route messages emitted by the System.Diagnostics.Trace class to ASP.NET tracing output, and route messages emitted by ASP.NET tracing to System.Diagnostics.Trace.</span></span> <span data-ttu-id="6e3bc-293">您也可以轉送到 System.Diagnostics.Trace 的 ASP.NET 檢測事件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-293">You can also forward ASP.NET instrumentation events to System.Diagnostics.Trace.</span></span> <span data-ttu-id="6e3bc-294">這項功能由新**writeToDiagnosticsTrace**屬性&lt;追蹤&gt;項目。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-294">This functionality is provided by the new **writeToDiagnosticsTrace** attribute of the &lt;trace&gt; element.</span></span> <span data-ttu-id="6e3bc-295">此布林值為 true 時，ASP.NET 追蹤訊息會轉送給 System.Diagnostics 追蹤基礎結構，用於透過任何已註冊要顯示追蹤訊息的接聽程式。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-295">When this Boolean value is true, ASP.NET Trace messages are forwarded to the System.Diagnostics tracing infrastructure for use by any listeners that are registered to display Trace messages.</span></span>

## <a name="programmatic-access-to-trace-messages"></a><span data-ttu-id="6e3bc-296">以程式設計方式存取追蹤訊息</span><span class="sxs-lookup"><span data-stu-id="6e3bc-296">Programmatic Access to Trace Messages</span></span>

<span data-ttu-id="6e3bc-297">ASP.NET 2.0 允許以程式設計方式存取所有的追蹤訊息，透過**TraceContextRecord**類別和**TraceRecords**集合。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-297">ASP.NET 2.0 allows for programmatic access to all trace messages via the **TraceContextRecord** class and the **TraceRecords** collection.</span></span> <span data-ttu-id="6e3bc-298">存取追蹤訊息的最有效率的方式是註冊**TraceContextEventHandler**委派 （也新增 ASP.NET 2.0 中） 來處理新**TraceFinished**事件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-298">The most efficient way of accessing trace messages is to register a **TraceContextEventHandler** delegate (also new in ASP.NET 2.0) to handle the new **TraceFinished** event.</span></span> <span data-ttu-id="6e3bc-299">您接著可以迴圈的追蹤訊息，在您希望的位置。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-299">You can then loop through the trace messages as you wish.</span></span>

<span data-ttu-id="6e3bc-300">下列程式碼範例將說明這點：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-300">The following code sample illustrates this:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample13.cs)]

<span data-ttu-id="6e3bc-301">在上述範例中，我將 TraceRecords 集合執行迴圈，然後將每個訊息寫入至回應資料流。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-301">In the above example, I loop through the TraceRecords collection and then write each message to the Response stream.</span></span>

## <a name="improved-application-level-tracing"></a><span data-ttu-id="6e3bc-302">改良的應用程式層級追蹤</span><span class="sxs-lookup"><span data-stu-id="6e3bc-302">Improved Application-Level Tracing</span></span>

<span data-ttu-id="6e3bc-303">透過導入新的應用程式層級追蹤已獲得改善**mostRecent**屬性&lt;追蹤&gt;項目。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-303">Application-level tracing is improved via the introduction of the new **mostRecent** attribute of the &lt;trace&gt; element.</span></span> <span data-ttu-id="6e3bc-304">這個屬性會指定是否顯示最新的應用程式層級追蹤輸出，並會捨棄較舊的追蹤資料超出 requestLimit 所表示之限制。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-304">This attribute specifies whether the most recent application-level tracing output is displayed and older trace data beyond the limits that are indicated by the requestLimit are discarded.</span></span> <span data-ttu-id="6e3bc-305">如果為 false，追蹤資料會顯示要求，直到達到 requestLimit 屬性。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-305">If false, trace data are displayed for requests until the requestLimit attribute is reached.</span></span>

## <a name="aspnet-command-line-tools"></a><span data-ttu-id="6e3bc-306">ASP.NET 命令列工具</span><span class="sxs-lookup"><span data-stu-id="6e3bc-306">ASP.NET Command Line Tools</span></span>

<span data-ttu-id="6e3bc-307">有數個命令列工具，可協助 ASP.NET 的組態設定。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-307">There are several command-line tools to aid in configuration of ASP.NET.</span></span> <span data-ttu-id="6e3bc-308">ASP.NET 開發人員應該要熟悉 aspnet\_regiis.exe 工具。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-308">ASP.NET developers should be familiar with the aspnet\_regiis.exe tool.</span></span> <span data-ttu-id="6e3bc-309">ASP.NET 2.0 提供三種其他命令列工具來協助組態設定。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-309">ASP.NET 2.0 provides three other command-line tools to aid in configuration.</span></span>

<span data-ttu-id="6e3bc-310">下列命令列工具可用：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-310">The following command-line tools are available:</span></span>

| <span data-ttu-id="6e3bc-311">**工具**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-311">**Tool**</span></span> | <span data-ttu-id="6e3bc-312">**使用**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-312">**Use**</span></span> |
| --- | --- |
| <span data-ttu-id="6e3bc-313">**aspnet\_regiis.exe**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-313">**aspnet\_regiis.exe**</span></span> | <span data-ttu-id="6e3bc-314">可讓登錄 iis ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-314">Allows for registration of ASP.NET with IIS.</span></span> <span data-ttu-id="6e3bc-315">有兩個版本的此工具隨附 ASP.NET 2.0 （在架構資料夾中） 的 32 位元系統，一個適用於 64 位元系統，（Framework64 資料夾中。）在 32 位元作業系統上，將不會安裝 64 位元版本。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-315">There are two versions of this tools that ship with ASP.NET 2.0, one for 32-bit systems (in the Framework folder) and one for 64-bit systems (in the Framework64 folder.) The 64-bit version will not be installed on a 32-bit OS.</span></span> |
| <span data-ttu-id="6e3bc-316">**aspnet\_regsql.exe**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-316">**aspnet\_regsql.exe**</span></span> | <span data-ttu-id="6e3bc-317">ASP.NET SQL Server 註冊工具用來建立 Microsoft SQL Server 資料庫以供 SQL Server 提供者在 ASP.NET 中，或新增或移除現有的資料庫中的選項。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-317">The ASP.NET SQL Server Registration tool is used to create a Microsoft SQL Server database for use by the SQL Server providers in ASP.NET, or to add or remove options from an existing database.</span></span> <span data-ttu-id="6e3bc-318">Aspnet\_regsql.exe 檔案位於 [Web 伺服器上 drive:]\WINDOWS\Microsoft.NET\Framework\versionNumber 資料夾。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-318">The Aspnet\_regsql.exe file is located in the [drive:]\WINDOWS\Microsoft.NET\Framework\versionNumber folder on your Web server.</span></span> |
| <span data-ttu-id="6e3bc-319">**aspnet\_regbrowsers.exe**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-319">**aspnet\_regbrowsers.exe**</span></span> | <span data-ttu-id="6e3bc-320">ASP.NET 瀏覽器註冊工具會剖析並編譯成組件的所有系統範圍的瀏覽器定義並的組件安裝到全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-320">The ASP.NET Browser Registration tool parses and compiles all system-wide browser definitions into an assembly and installs the assembly into the global assembly cache.</span></span> <span data-ttu-id="6e3bc-321">此工具會使用瀏覽器定義檔案 (。瀏覽器檔案） 從.NET Framework 瀏覽器子目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-321">The tool uses the browser definition files (.BROWSER files) from the .NET Framework Browsers subdirectory.</span></span> <span data-ttu-id="6e3bc-322">%SystemRoot%\Microsoft.NET\Framework\version\ 目錄中，就可以找到這個工具。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-322">The tool can be found in the %SystemRoot%\Microsoft.NET\Framework\version\ directory.</span></span> |
| <span data-ttu-id="6e3bc-323">**aspnet\_compiler.exe**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-323">**aspnet\_compiler.exe**</span></span> | <span data-ttu-id="6e3bc-324">ASP.NET 編譯工具可讓您編譯的 ASP.NET Web 應用程式，或部署到目標位置，例如生產環境伺服器。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-324">The ASP.NET Compilation tool enables you to compile an ASP.NET Web application, either in place or for deployment to a target location such as a production server.</span></span> <span data-ttu-id="6e3bc-325">就地編譯可協助應用程式效能，因為使用者不會發生延遲的應用程式的第一個要求時編譯的應用程式。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-325">In-place compilation helps application performance because end users do not encounter a delay on the first request to the application while the application is compiled.</span></span> |

<span data-ttu-id="6e3bc-326">因為 aspnet\_regiis.exe 工具不熟悉 ASP.NET 2.0 中，我們不會討論它這裡。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-326">Because the aspnet\_regiis.exe tool is not new to ASP.NET 2.0, we will not discuss it here.</span></span>

## <a name="aspnet-sql-server-registration-tool---aspnetregsqlexe"></a><span data-ttu-id="6e3bc-327">ASP.NET SQL Server 註冊工具 aspnet\_regsql.exe</span><span class="sxs-lookup"><span data-stu-id="6e3bc-327">ASP.NET SQL Server Registration Tool - aspnet\_regsql.exe</span></span>

<span data-ttu-id="6e3bc-328">您可以設定幾種類型的使用 ASP.NET SQL Server 註冊工具選項。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-328">You can set several types of options using the ASP.NET SQL Server Registration tool.</span></span> <span data-ttu-id="6e3bc-329">您可以指定 SQL 連接、 指定哪一個 ASP.NET 應用程式服務來管理資訊，指出 SQL 快取相依性，使用的資料庫或資料表使用 SQL Server 和新增或移除的使用 SQL Server 來儲存程序和工作階段狀態支援。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-329">You can specify a SQL connection, specify which ASP.NET application services use SQL Server to manage information, indicate which database or table is used for SQL cache dependency, and add or remove support for using SQL Server to store procedures and session state.</span></span>

<span data-ttu-id="6e3bc-330">數個 ASP.NET 應用程式服務依賴來管理儲存和擷取資料來源的資料提供者。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-330">Several ASP.NET application services rely on a provider to manage storing and retrieving data from a data source.</span></span> <span data-ttu-id="6e3bc-331">每個提供者會因資料來源。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-331">Each provider is specific to the data source.</span></span> <span data-ttu-id="6e3bc-332">ASP.NET 會包含在下列 ASP.NET 功能的 SQL Server 提供者：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-332">ASP.NET includes a SQL Server provider for the following ASP.NET features:</span></span>

- <span data-ttu-id="6e3bc-333">成員資格 ( [SqlMembershipProvider](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx)類別)。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-333">Membership (the [SqlMembershipProvider](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx) class).</span></span>
- <span data-ttu-id="6e3bc-334">角色管理 ( [SqlRoleProvider](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx)類別)。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-334">Role Management (the [SqlRoleProvider](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx) class).</span></span>
- <span data-ttu-id="6e3bc-335">設定檔 ( [SqlProfileProvider](https://msdn.microsoft.com/library/system.web.profile.sqlprofileprovider.aspx)類別)。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-335">Profile (the [SqlProfileProvider](https://msdn.microsoft.com/library/system.web.profile.sqlprofileprovider.aspx) class).</span></span>
- <span data-ttu-id="6e3bc-336">Web 組件個人化 ( [SqlPersonalizationProvider](https://msdn.microsoft.com/library/system.web.ui.webcontrols.webparts.sqlpersonalizationprovider.aspx)類別)。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-336">Web Parts Personalization (the [SqlPersonalizationProvider](https://msdn.microsoft.com/library/system.web.ui.webcontrols.webparts.sqlpersonalizationprovider.aspx) class).</span></span>
- <span data-ttu-id="6e3bc-337">Web 事件 ( [SqlWebEventProvider](https://msdn.microsoft.com/library/system.web.management.sqlwebeventprovider.aspx)類別)。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-337">Web Events (the [SqlWebEventProvider](https://msdn.microsoft.com/library/system.web.management.sqlwebeventprovider.aspx) class).</span></span>

<span data-ttu-id="6e3bc-338">當您安裝 ASP.NET 時，Machine.config 檔案，為您的伺服器會包含組態項目會指定每個提供者所依賴的 ASP.NET 功能的 SQL Server 提供者。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-338">When you install ASP.NET, the Machine.config file for your server includes configuration elements that specify SQL Server providers for each of the ASP.NET features that rely on a provider.</span></span> <span data-ttu-id="6e3bc-339">設定這些提供者，根據預設，連接到 SQL Server Express 2005 的本機使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-339">These providers are configured, by default, to connect to a local user instance of SQL Server Express 2005.</span></span> <span data-ttu-id="6e3bc-340">如果您變更的提供者所用的預設連接字串，然後您可以使用任何在電腦組態中，設定的 ASP.NET 功能之前，您必須安裝 SQL Server 資料庫和資料庫項目如您所選擇的功能使用 Aspnet\_regsql.exe。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-340">If you change the default connection string used by the providers, then before you can use any of the ASP.NET features configured in the machine configuration, you must install the SQL Server database and the database elements for your chosen feature using Aspnet\_regsql.exe.</span></span> <span data-ttu-id="6e3bc-341">如果您使用 SQL 註冊工具指定的資料庫不存在 （aspnetdb 將預設資料庫如果未在命令列上指定其中一個），則目前的使用者必須擁有 SQL Server 一併建立結構描述中建立資料庫權限lements 資料庫內。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-341">If the database that you specify with the SQL registration tool does not already exist (aspnetdb will be the default database if one is not specified on the command line), then the current user must have rights to create databases in SQL Server as well as to create schema elements within a database.</span></span>

### <a name="sql-cache-dependency"></a><span data-ttu-id="6e3bc-342">SQL 快取相依性</span><span class="sxs-lookup"><span data-stu-id="6e3bc-342">SQL Cache Dependency</span></span>

<span data-ttu-id="6e3bc-343">一項進階的功能的 ASP.NET 輸出快取是 SQL 快取相依性。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-343">An advanced feature of ASP.NET output caching is SQL cache dependency.</span></span> <span data-ttu-id="6e3bc-344">SQL 快取相依性支援兩個不同的作業模式： 使用 ASP.NET 實作資料表輪詢和使用 SQL Server 2005 的查詢通知功能的第二個模式的其中一個。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-344">SQL cache dependency supports two different modes of operation: one that uses an ASP.NET implementation of table polling and a second mode that uses the query notification features of SQL Server 2005.</span></span> <span data-ttu-id="6e3bc-345">SQL 註冊工具可用來設定資料表輪詢模式的作業。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-345">The SQL registration tool can be used to configure the table-polling mode of operation.</span></span>

### <a name="session-state"></a><span data-ttu-id="6e3bc-346">工作階段狀態</span><span class="sxs-lookup"><span data-stu-id="6e3bc-346">Session State</span></span>

<span data-ttu-id="6e3bc-347">根據預設，工作階段狀態值和資訊會儲存在 ASP.NET 處理序內的記憶體。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-347">By default, session state values and information are stored in memory within the ASP.NET process.</span></span> <span data-ttu-id="6e3bc-348">或者，您可以在 SQL Server 資料庫中，其中由多部網頁伺服器共用儲存工作階段資料。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-348">Alternatively, you can store session data in a SQL Server database, where it can be shared by multiple Web servers.</span></span> <span data-ttu-id="6e3bc-349">如果您指定 SQL 註冊工具與工作階段狀態的資料庫不存在，目前使用者必須具有在 SQL Server 中一併建立結構描述資料庫內的項目建立資料庫權限。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-349">If the database that you specify for session state with the SQL registration tool does not already exist, then the current user must have rights to create databases in SQL Server as well as to create schema elements within a database.</span></span> <span data-ttu-id="6e3bc-350">如果資料庫不存在，目前的使用者必須擁有現有資料庫中建立結構描述元素的權限。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-350">If the database does exist, then the current user must have rights to create schema elements in the existing database.</span></span>

<span data-ttu-id="6e3bc-351">若要安裝 SQL Server 上的工作階段狀態資料庫，執行 Aspnet\_regsql.exe 工具，並提供與命令的下列資訊：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-351">To install the session state database on SQL Server, run the Aspnet\_regsql.exe tool and supply the following information with the command:</span></span>

- <span data-ttu-id="6e3bc-352">名稱的 SQL Server 執行個體，使用**-S**選項。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-352">The name of the SQL Server instance, using the **-S** option.</span></span>
- <span data-ttu-id="6e3bc-353">具有執行 SQL Server 的電腦上建立資料庫的權限的帳戶登入認證。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-353">The logon credentials for an account that has permission to create a database on a computer running SQL Server.</span></span> <span data-ttu-id="6e3bc-354">使用**-E**選項來使用目前登入的使用者，或是使用**-U**選項來指定使用者 ID，並搭配**-P**選項來指定密碼。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-354">Use the **-E** option to use the currently logged-on user, or use the **-U** option to specify a user ID along with the **-P** option to specify a password.</span></span>
- <span data-ttu-id="6e3bc-355">**-Ssadd**命令列選項可新增工作階段狀態資料庫。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-355">The **-ssadd** command-line option to add the session state database.</span></span>

<span data-ttu-id="6e3bc-356">根據預設，您無法使用 Aspnet\_regsql.exe 工具來執行 SQL Server 2005 Express Edition 的電腦上安裝工作階段狀態資料庫。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-356">By default, you cannot use the Aspnet\_regsql.exe tool to install the session state database on a computer running SQL Server 2005 Express Edition.</span></span>

### <a name="the-aspnet-browser-registration-tool---aspnetregbrowsersexe"></a><span data-ttu-id="6e3bc-357">的 ASP.NET Browser Registration Tool-aspnet\_regbrowsers.exe</span><span class="sxs-lookup"><span data-stu-id="6e3bc-357">The ASP.NET Browser Registration Tool - aspnet\_regbrowsers.exe</span></span>

<span data-ttu-id="6e3bc-358">在 ASP.NET 1.1 版中，Machine.config 檔案包含一個區段呼叫&lt;browserCaps&gt;。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-358">In ASP.NET version 1.1, the Machine.config file contained a section called &lt;browserCaps&gt;.</span></span> <span data-ttu-id="6e3bc-359">本節包含一系列的 XML 項目定義根據規則運算式的多種瀏覽器的設定。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-359">This section contained a series of XML entries that defined the configurations for various browsers based on a regular expression.</span></span> <span data-ttu-id="6e3bc-360">適用於 ASP.NET 2.0 版中，新的。瀏覽器檔案會定義使用 XML 項目之特定瀏覽器的參數。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-360">For ASP.NET version 2.0, a new .BROWSER file defines the parameters of a particular browser using XML entries.</span></span> <span data-ttu-id="6e3bc-361">您新增新的瀏覽器上的資訊透過新增。瀏覽器檔案，位於 %SystemRoot%\Microsoft.NET\Framework\version\CONFIG\Browsers 您系統上的資料夾。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-361">You add information on a new browser by adding a new .BROWSER file to the folder located at %SystemRoot%\Microsoft.NET\Framework\version\CONFIG\Browsers on your system.</span></span>

<span data-ttu-id="6e3bc-362">因為每次需要瀏覽器資訊的應用程式不是正在讀取.config 檔案，您可以建立新項目。瀏覽器檔和執行的 Aspnet\_regbrowsers.exe 加入組件所需的變更。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-362">Because an application is not reading a .config file every time it requires browser information, you can create a new .BROWSER file and run Aspnet\_regbrowsers.exe to add the required changes to the assembly.</span></span> <span data-ttu-id="6e3bc-363">這可讓伺服器立即存取新的瀏覽器資訊，因此您不需要關閉任何應用程式來收取資訊。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-363">This allows the server to access the new browser information immediately so you do not have to shut down any of your applications to pick up the information.</span></span> <span data-ttu-id="6e3bc-364">應用程式可以透過目前 HttpRequest 的瀏覽器屬性存取的瀏覽器功能。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-364">An application can access browser capabilities through the Browser property of the current HttpRequest.</span></span>

<span data-ttu-id="6e3bc-365">執行 aspnet 時，可以使用下列選項\_regbrowser.exe:</span><span class="sxs-lookup"><span data-stu-id="6e3bc-365">The following options are available when running aspnet\_regbrowser.exe:</span></span>

| <span data-ttu-id="6e3bc-366">**選項**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-366">**Option**</span></span> | <span data-ttu-id="6e3bc-367">**描述**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-367">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="6e3bc-368">**-?**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-368">**-?**</span></span> | <span data-ttu-id="6e3bc-369">顯示 Aspnet\_regbbrowsers.exe 命令視窗中的說明文字。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-369">Displays the Aspnet\_regbbrowsers.exe Help text in the command window.</span></span> |
| <span data-ttu-id="6e3bc-370">**-i**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-370">**-i**</span></span> | <span data-ttu-id="6e3bc-371">建立執行階段瀏覽器能力組件，並將它安裝在全域組件快取中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-371">Creates the runtime browser capabilities assembly and installs it in the global assembly cache.</span></span> |
| <span data-ttu-id="6e3bc-372">**-u**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-372">**-u**</span></span> | <span data-ttu-id="6e3bc-373">解除安裝全域組件快取執行階段瀏覽器能力組件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-373">Uninstalls the runtime browser capabilities assembly from the global assembly cache.</span></span> |

## <a name="the-aspnet-compilation-tool---aspnetcompilerexe"></a><span data-ttu-id="6e3bc-374">ASP.NET Compilation Tool-aspnet\_compiler.exe</span><span class="sxs-lookup"><span data-stu-id="6e3bc-374">The ASP.NET Compilation Tool - aspnet\_compiler.exe</span></span>

<span data-ttu-id="6e3bc-375">ASP.NET 編譯工具可用於兩種方法： 在就地編譯和部署，而指定目標的輸出目錄的編譯。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-375">The ASP.NET Compilation tool can be used in two general ways: for in-place compilation and compilation for deployment, where a target output directory is specified.</span></span>

### <a name="compiling-an-application-in-placehttpsmsdnmicrosoftcomlibraryms229863aspx"></a>[<span data-ttu-id="6e3bc-376">編譯應用程式中的位置</span><span class="sxs-lookup"><span data-stu-id="6e3bc-376">Compiling an Application in Place</span></span>](https://msdn.microsoft.com/library/ms229863.aspx)

<span data-ttu-id="6e3bc-377">ASP.NET 編譯工具可以編譯的應用程式中的位置，也就是它會模擬應用程式，因此會造成一般的編譯進行多個要求的行為。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-377">The ASP.NET Compilation tool can compile an application in place, that is, it mimics the behavior of making multiple requests to the application, thus causing regular compilation.</span></span> <span data-ttu-id="6e3bc-378">先行編譯網站的使用者不會發生編譯第一次要求頁面所造成的延遲。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-378">Users of a pre-compiled site will not experience a delay caused by compiling the page on first request.</span></span>

<span data-ttu-id="6e3bc-379">當您先行編譯的位置中的站台時，適用於下列項目：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-379">When you precompile a site in place, the following items apply:</span></span>

- <span data-ttu-id="6e3bc-380">站台會保留其檔案和目錄結構。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-380">The site retains its files and directory structure.</span></span>
- <span data-ttu-id="6e3bc-381">您必須擁有所有的站台伺服器上所使用的程式設計語言的編譯器。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-381">You must have compilers for all programming languages used by the site on the server.</span></span>
- <span data-ttu-id="6e3bc-382">如果任何檔案會編譯失敗，整個站台會發生編譯失敗。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-382">If any file fails compilation, the entire site fails compilation.</span></span>

<span data-ttu-id="6e3bc-383">您也可以重新編譯應用程式就地之後加入新的來源檔案。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-383">You can also recompile an application in place after adding new source files to it.</span></span> <span data-ttu-id="6e3bc-384">此工具會編譯只將新的或變更檔案，除非您包含**-c**選項。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-384">The tool compiles only the new or changed files unless you include the **-c** option.</span></span>

> [!NOTE]
> <span data-ttu-id="6e3bc-385">包含巢狀的應用程式的應用程式的編譯不會編譯巢狀的應用程式。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-385">Compilation of an application that contains a nested application does not compile the nested application.</span></span> <span data-ttu-id="6e3bc-386">巢狀的應用程式必須個別進行編譯。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-386">The nested application must be compiled separately.</span></span>


### <a name="compiling-an-application-for-deploymenthttpsmsdnmicrosoftcomlibraryms229863aspx"></a>[<span data-ttu-id="6e3bc-387">編譯應用程式部署</span><span class="sxs-lookup"><span data-stu-id="6e3bc-387">Compiling an Application for Deployment</span></span>](https://msdn.microsoft.com/library/ms229863.aspx)

<span data-ttu-id="6e3bc-388">您藉由指定 targetDir 參數編譯應用程式部署 （編譯到目標位置）。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-388">You compile an application for deployment (compilation to a target location) by specifying the targetDir parameter.</span></span> <span data-ttu-id="6e3bc-389">TargetDir 可以是 Web 應用程式的最後一個位置，或編譯的應用程式可以進一步進行部署。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-389">The targetDir can be the final location for the Web application, or the compiled application can be further deployed.</span></span> <span data-ttu-id="6e3bc-390">使用**-u**選項編譯的方式，您可以進行變更編譯的應用程式中的某些檔案而不需要重新編譯應用程式。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-390">Using the **-u** option compiles the application in such a way that you can make changes to certain files in the compiled application without recompiling it.</span></span> <span data-ttu-id="6e3bc-391">Aspnet\_compiler.exe 區別靜態和動態的檔案類型，並建立產生的應用程式時以不同方式處理它們。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-391">Aspnet\_compiler.exe makes a distinction between static and dynamic file types, and handles them differently when creating the resulting application.</span></span>

- <span data-ttu-id="6e3bc-392">靜態檔案類型是指不具有相關聯的編譯器或建置提供者，例如檔案的具名等有例如.css、.gif、.htm、.html、.jpg、.js 副檔名。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-392">Static file types are those that do not have an associated compiler or build provider, such as files whose named have extensions such as .css, .gif, .htm, .html, .jpg, .js and so on.</span></span> <span data-ttu-id="6e3bc-393">這些檔案只會複製到目標位置，以保留的目錄結構中其相對位置。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-393">These files are simply copied to the target location, with their relative places in the directory structure preserved.</span></span>
- <span data-ttu-id="6e3bc-394">相關聯的編譯器或建置提供者，包括 ASP.NET 特定檔案名稱副檔名，例如.asax、.ascx、.ashx、.aspx、.browser、.master、 等等的檔案就是動態的檔案類型。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-394">Dynamic file types are those that have an associated compiler or build provider, including files with ASP.NET-specific file name extensions such as .asax, .ascx, .ashx, .aspx, .browser, .master, and so on.</span></span> <span data-ttu-id="6e3bc-395">ASP.NET 編譯工具產生組件從這些檔案。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-395">The ASP.NET Compilation tool generates assemblies from these files.</span></span> <span data-ttu-id="6e3bc-396">如果**-u**省略選項、 工具也會建立檔案與檔案名稱的副檔名。對應至其組件的原始程式檔的編譯。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-396">If the **-u** option is omitted, the tool also creates files with the file name extension .COMPILED that map the original source files to their assembly.</span></span> <span data-ttu-id="6e3bc-397">若要確定會保留應用程式來源的目錄結構，此工具會產生預留位置檔案中的目標應用程式中對應的位置。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-397">To ensure that the directory structure of the application source is preserved, the tool generates placeholder files in the corresponding locations in the target application.</span></span>

<span data-ttu-id="6e3bc-398">您必須使用**-u**選項以指出可以修改的已編譯的應用程式的內容。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-398">You must use the **-u** option to indicate that the content of the compiled application can be modified.</span></span> <span data-ttu-id="6e3bc-399">否則，後續的修改會被忽略，或導致執行階段錯誤。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-399">Otherwise, subsequent modifications are ignored or cause run-time errors.</span></span>

<span data-ttu-id="6e3bc-400">下表說明如何編譯 ASP.NET 工具處理的不同檔案類型時**-u**選項會納入。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-400">The following table describes how the ASP.NET Compilation tool handles different file types when the **-u** option is included.</span></span>

| <span data-ttu-id="6e3bc-401">**檔案類型**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-401">**File type**</span></span> | <span data-ttu-id="6e3bc-402">**編譯器動作**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-402">**Compiler action**</span></span> |
| --- | --- |
| <span data-ttu-id="6e3bc-403">.ascx、.master.aspx</span><span class="sxs-lookup"><span data-stu-id="6e3bc-403">.ascx, .aspx, .master</span></span> | <span data-ttu-id="6e3bc-404">這些檔案會分為標記和來源的程式碼，將會包含任何程式碼和程式碼後置檔案包含&lt;指令碼 runat ="server"&gt;項目。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-404">These files are split into markup and source code, which includes both code-behind files and any code that is enclosed in &lt;script runat="server"&gt; elements.</span></span> <span data-ttu-id="6e3bc-405">原始程式碼會編譯為組件，以衍生自雜湊演算法的名稱和組件會放在 Bin 目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-405">Source code is compiled into assemblies, with names that are derived from a hashing algorithm, and the assemblies are placed in the Bin directory.</span></span> <span data-ttu-id="6e3bc-406">這就是任何內嵌程式碼，程式碼用括號 **&lt; %** 和 **% &gt;** 括號，會包含在標記並不會編譯。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-406">Any inline code, that is, code enclosed between the **&lt;%** and **%&gt;** brackets, is included with markup and not compiled.</span></span> <span data-ttu-id="6e3bc-407">與原始程式檔同名的新檔案會建立了包含標記，並放在對應的輸出目錄中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-407">New files with the same name as the source files are created to contain the markup and placed in the corresponding output directories.</span></span> |
| <span data-ttu-id="6e3bc-408">.ashx、.asmx</span><span class="sxs-lookup"><span data-stu-id="6e3bc-408">.ashx, .asmx</span></span> | <span data-ttu-id="6e3bc-409">這些檔案不會編譯，並移到輸出目錄，並不會編譯。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-409">These files are not compiled and are moved to the output directories as is and not compiled.</span></span> <span data-ttu-id="6e3bc-410">如果您想要編譯的處理常式程式碼，將程式碼放到應用程式中的原始程式碼檔\_程式碼目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-410">If you wish to have the handler code compiled, place the code into source code files in the App\_Code directory.</span></span> |
| <span data-ttu-id="6e3bc-411">.cs、.vb、.jsl、.cpp （不包括程式碼後置檔案，如稍早所列的檔案類型）</span><span class="sxs-lookup"><span data-stu-id="6e3bc-411">.cs, .vb, .jsl, .cpp (not including code-behind files for the file types listed earlier)</span></span> | <span data-ttu-id="6e3bc-412">這些檔案，編譯並包含做為參考它們的組件中的資源。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-412">These files are compiled and included as a resource in assemblies that reference them.</span></span> <span data-ttu-id="6e3bc-413">來源檔案不會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-413">Source files are not copied to the output directory.</span></span> <span data-ttu-id="6e3bc-414">如果未參考的程式碼檔案，則不會編譯它。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-414">If a code file is not referenced, it is not compiled.</span></span> |
| <span data-ttu-id="6e3bc-415">自訂的檔案類型</span><span class="sxs-lookup"><span data-stu-id="6e3bc-415">Custom file types</span></span> | <span data-ttu-id="6e3bc-416">這些檔案不會編譯。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-416">These files are not compiled.</span></span> <span data-ttu-id="6e3bc-417">這些檔案會複製到對應的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-417">These files are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="6e3bc-418">原始程式碼檔的應用程式中\_程式碼子目錄</span><span class="sxs-lookup"><span data-stu-id="6e3bc-418">Source code files in the App\_Code subdirectory</span></span> | <span data-ttu-id="6e3bc-419">這些檔案會編譯成組件，並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-419">These files are compiled into assemblies and placed in the Bin directory.</span></span> |
| <span data-ttu-id="6e3bc-420">應用程式中的.resx 和.resource 檔\_GlobalResources 子目錄</span><span class="sxs-lookup"><span data-stu-id="6e3bc-420">.resx and .resource files in the App\_GlobalResources subdirectory</span></span> | <span data-ttu-id="6e3bc-421">這些檔案會編譯成組件，並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-421">These files are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="6e3bc-422">任何應用程式\_GlobalResources 子目錄主要的輸出目錄中，之下建立，而且會將.resx 或.resources 檔案位於來源目錄複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-422">No App\_GlobalResources subdirectory is created under the main output directory, and no .resx or .resources files located in the source directory are copied to the output directories.</span></span> |
| <span data-ttu-id="6e3bc-423">應用程式中的.resx 和.resource 檔\_LocalResources 子目錄</span><span class="sxs-lookup"><span data-stu-id="6e3bc-423">.resx and .resource files in the App\_LocalResources subdirectory</span></span> | <span data-ttu-id="6e3bc-424">這些檔案不會編譯並複製到對應的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-424">These files are not compiled and are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="6e3bc-425">應用程式中的.skin 檔案\_佈景主題的子目錄</span><span class="sxs-lookup"><span data-stu-id="6e3bc-425">.skin files in the App\_Themes subdirectory</span></span> | <span data-ttu-id="6e3bc-426">.Skin 檔和靜態的佈景主題檔案，不會編譯，並複製到對應的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-426">The .skin files and static theme files are not compiled and are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="6e3bc-427">.browser Web.config 靜態檔案類型的 Bin 目錄中已經存在的組件</span><span class="sxs-lookup"><span data-stu-id="6e3bc-427">.browser Web.config Static file types Assemblies already present in the Bin directory</span></span> | <span data-ttu-id="6e3bc-428">這些檔案會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-428">These files are copied as is to the output directories.</span></span> |

<span data-ttu-id="6e3bc-429">下表說明如何編譯 ASP.NET 工具處理的不同檔案類型時**-u**省略選項。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-429">The following table describes how the ASP.NET Compilation tool handles different file types when the **-u** option is omitted.</span></span>

| <span data-ttu-id="6e3bc-430">**檔案類型**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-430">**File type**</span></span> | <span data-ttu-id="6e3bc-431">**編譯器動作**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-431">**Compiler action**</span></span> |
| --- | --- |
| <span data-ttu-id="6e3bc-432">.aspx、.asmx、.ashx、.master</span><span class="sxs-lookup"><span data-stu-id="6e3bc-432">.aspx, .asmx, .ashx, .master</span></span> | <span data-ttu-id="6e3bc-433">這些檔案會分為標記和來源的程式碼，將會包含任何程式碼和程式碼後置檔案包含&lt;指令碼 runat ="server"&gt;項目。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-433">These files are split into markup and source code, which includes both code-behind files and any code that is enclosed in &lt;script runat="server"&gt; elements.</span></span> <span data-ttu-id="6e3bc-434">原始程式碼會編譯為組件，以衍生自雜湊演算法的名稱。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-434">Source code is compiled into assemblies, with names that are derived from a hashing algorithm.</span></span> <span data-ttu-id="6e3bc-435">產生的組件會放在 Bin 目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-435">The resulting assemblies are placed in the Bin directory.</span></span> <span data-ttu-id="6e3bc-436">這就是任何內嵌程式碼，程式碼用括號 **&lt; %** 和 **% &gt;** 括號，會包含在標記並不會編譯。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-436">Any inline code, that is, code enclosed between the **&lt;%** and **%&gt;** brackets, is included with markup and not compiled.</span></span> <span data-ttu-id="6e3bc-437">編譯器會建立新的檔案包含與原始程式檔的名稱相同的標記。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-437">The compiler creates new files to contain the markup with the same name as the source files.</span></span> <span data-ttu-id="6e3bc-438">這些產生的檔案會放置在 Bin 目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-438">These resulting files are placed in the Bin directory.</span></span> <span data-ttu-id="6e3bc-439">編譯器也會建立檔案與原始程式檔的名稱相同但副檔名為。包含對應資訊的編譯。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-439">The compiler also creates files with the same name as the source files but with the extension .COMPILED that contain mapping information.</span></span> <span data-ttu-id="6e3bc-440">。編譯的檔案會放置在對應至原始位置的原始程式檔的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-440">The .COMPILED files are placed in the output directories corresponding to the original location of the source files.</span></span> |
| <span data-ttu-id="6e3bc-441">.ascx</span><span class="sxs-lookup"><span data-stu-id="6e3bc-441">.ascx</span></span> | <span data-ttu-id="6e3bc-442">這些檔案會分割成標記和原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-442">These files are split into markup and source code.</span></span> <span data-ttu-id="6e3bc-443">原始程式碼會編譯成組件，並放在 Bin 目錄中，以衍生自雜湊演算法的名稱。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-443">Source code is compiled into assemblies and placed in the Bin directory, with names that are derived from a hashing algorithm.</span></span> <span data-ttu-id="6e3bc-444">不會產生標記檔案。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-444">No markup files are generated.</span></span> |
| <span data-ttu-id="6e3bc-445">.cs、.vb、.jsl、.cpp （不包括程式碼後置檔案，如稍早所列的檔案類型）</span><span class="sxs-lookup"><span data-stu-id="6e3bc-445">.cs, .vb, .jsl, .cpp (not including code-behind files for the file types listed earlier)</span></span> | <span data-ttu-id="6e3bc-446">從.ascx、.ashx 或.aspx 檔案產生的組件所參考的程式碼會編譯成組件，並放置於 Bin 目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-446">Source code that is referenced by the assemblies generated from .ascx, .ashx, or .aspx files is compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="6e3bc-447">會不複製任何原始程式檔。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-447">No source files are copied.</span></span> |
| <span data-ttu-id="6e3bc-448">自訂的檔案類型</span><span class="sxs-lookup"><span data-stu-id="6e3bc-448">Custom file types</span></span> | <span data-ttu-id="6e3bc-449">這些檔案會編譯像動態檔案。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-449">These files are compiled like dynamic files.</span></span> <span data-ttu-id="6e3bc-450">根據它們所根據的檔案類型，編譯器可以將對應檔案放在輸出目錄中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-450">Depending on the type of file they are based on, the compiler can place mapping files in the output directories.</span></span> |
| <span data-ttu-id="6e3bc-451">應用程式中的檔案\_程式碼子目錄</span><span class="sxs-lookup"><span data-stu-id="6e3bc-451">Files in the App\_Code subdirectory</span></span> | <span data-ttu-id="6e3bc-452">這個子目錄中原始程式碼檔會編譯成組件，並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-452">Source code files in this subdirectory are compiled into assemblies and placed in the Bin directory.</span></span> |
| <span data-ttu-id="6e3bc-453">應用程式中的檔案\_GlobalResources 子目錄</span><span class="sxs-lookup"><span data-stu-id="6e3bc-453">Files in the App\_GlobalResources subdirectory</span></span> | <span data-ttu-id="6e3bc-454">這些檔案會編譯成組件，並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-454">These files are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="6e3bc-455">任何應用程式\_主要輸出目錄下建立 GlobalResources 子目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-455">No App\_GlobalResources subdirectory is created under the main output directory.</span></span> <span data-ttu-id="6e3bc-456">如果組態檔會指定 appliesTo = 「 全部 」，.resx 和.resources 檔案會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-456">If the configuration file specifies appliesTo="All", .resx and .resources files are copied to the output directories.</span></span> <span data-ttu-id="6e3bc-457">不會複製如果它們正由[BuildProvider](https://msdn.microsoft.com/library/system.web.configuration.buildprovider.aspx)。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-457">They are not copied if they are referenced by a [BuildProvider](https://msdn.microsoft.com/library/system.web.configuration.buildprovider.aspx).</span></span> |
| <span data-ttu-id="6e3bc-458">應用程式中的.resx 和.resource 檔\_LocalResources 子目錄</span><span class="sxs-lookup"><span data-stu-id="6e3bc-458">.resx and .resource files in the App\_LocalResources subdirectory</span></span> | <span data-ttu-id="6e3bc-459">這些檔案會編譯成組件的唯一名稱，並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-459">These files are compiled into assemblies with unique names and placed in the Bin directory.</span></span> <span data-ttu-id="6e3bc-460">沒有.resx 或.resource 檔案會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-460">No .resx or .resource files are copied to the output directories.</span></span> |
| <span data-ttu-id="6e3bc-461">應用程式中的.skin 檔案\_佈景主題的子目錄</span><span class="sxs-lookup"><span data-stu-id="6e3bc-461">.skin files in the App\_Themes subdirectory</span></span> | <span data-ttu-id="6e3bc-462">佈景主題會編譯成組件，並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-462">Themes are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="6e3bc-463">虛設常式檔案建立.skin 檔案並放在對應的輸出目錄中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-463">Stub files are created for .skin files and placed in the corresponding output directory.</span></span> <span data-ttu-id="6e3bc-464">靜態 （例如.css) 檔案會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-464">Static files (such as .css) are copied to the output directories.</span></span> |
| <span data-ttu-id="6e3bc-465">.browser Web.config 靜態檔案類型的 Bin 目錄中已經存在的組件</span><span class="sxs-lookup"><span data-stu-id="6e3bc-465">.browser Web.config Static file types Assemblies already present in the Bin directory</span></span> | <span data-ttu-id="6e3bc-466">這些檔案會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-466">These files are copied as is to the output directory.</span></span> |

### <a name="fixed-assembly-nameshttpsmsdnmicrosoftcomlibraryms229863aspx"></a>[<span data-ttu-id="6e3bc-467">固定的組件名稱</span><span class="sxs-lookup"><span data-stu-id="6e3bc-467">Fixed Assembly Names</span></span>](https://msdn.microsoft.com/library/ms229863.aspx##)

<span data-ttu-id="6e3bc-468">某些情況下，例如使用 MSI Windows Installer，Web 應用程式部署需要使用一致的檔案名稱和內容，以及一致的目錄結構，以找出組件或更新的組態設定。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-468">Some scenarios, such as deploying a Web application using the MSI Windows Installer, require the use of consistent file names and contents, as well as consistent directory structures to identify assemblies or configuration settings for updates.</span></span> <span data-ttu-id="6e3bc-469">在這些情況下，您可以使用**-fixednames**選項來指定 ASP.NET 編譯工具應該編譯組件的每個來源檔案，而不是使用 where 多個頁面會編譯成組件。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-469">In those cases, you can use the **-fixednames** option to specify that the ASP.NET Compilation tool should compile an assembly for each source file instead of using the where multiple pages are compiled into assemblies.</span></span> <span data-ttu-id="6e3bc-470">這可能會導致大量的組件，因此如果您擔心延展性與您應小心使用此選項。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-470">This can lead to a large number of assemblies, so if you are concerned with scalability you should use this option with caution.</span></span>

### <a name="strong-name-compilationhttpsmsdnmicrosoftcomlibraryms229863aspx"></a>[<span data-ttu-id="6e3bc-471">強式名稱編譯</span><span class="sxs-lookup"><span data-stu-id="6e3bc-471">Strong-Name Compilation</span></span>](https://msdn.microsoft.com/library/ms229863.aspx##)

<span data-ttu-id="6e3bc-472">**-Aptca**， **-delaysign**， **-keycontainer**和**-keyfile**會提供選項，好讓您可以使用 Aspnet\_compiler.exe 建立強式名稱組件而不使用[強式名稱工具 (Sn.exe)](https://msdn.microsoft.com/library/k5b5tt23.aspx)分開。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-472">The **-aptca**, **-delaysign**, **-keycontainer** and **-keyfile** options are provided so that you can use Aspnet\_compiler.exe to create strongly named assemblies without using the [Strong Name Tool (Sn.exe)](https://msdn.microsoft.com/library/k5b5tt23.aspx) separately.</span></span> <span data-ttu-id="6e3bc-473">這些選項，分別對應至**AllowPartiallyTrustedCallersAttribute**， **AssemblyDelaySignAttribute**， **AssemblyKeyNameAttribute**，和**AssemblyKeyFileAttribute**。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-473">These options correspond, respectively, to **AllowPartiallyTrustedCallersAttribute**, **AssemblyDelaySignAttribute**, **AssemblyKeyNameAttribute**, and **AssemblyKeyFileAttribute**.</span></span>

<span data-ttu-id="6e3bc-474">這些屬性的討論超出本課程的範圍。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-474">Discussion of these attributes is outside of the scope of this course.</span></span>

## <a name="labs"></a><span data-ttu-id="6e3bc-475">實驗室</span><span class="sxs-lookup"><span data-stu-id="6e3bc-475">Labs</span></span>

<span data-ttu-id="6e3bc-476">每個下列的實驗室是根據前一個實驗室。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-476">Each of the following labs builds on the previous labs.</span></span> <span data-ttu-id="6e3bc-477">您必須按照步驟順序。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-477">You will need to do them in order.</span></span>

## <a name="lab-1-using-the-configuration-api"></a><span data-ttu-id="6e3bc-478">實驗室 1： 使用組態 API</span><span class="sxs-lookup"><span data-stu-id="6e3bc-478">Lab 1: Using the Configuration API</span></span>

1. <span data-ttu-id="6e3bc-479">建立新的網站呼叫*mod9lab*。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-479">Create a new Web site called *mod9lab*.</span></span>
2. <span data-ttu-id="6e3bc-480">將新的 Web 組態檔加入至網站。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-480">Add a new Web Configuration File to the site.</span></span>
3. <span data-ttu-id="6e3bc-481">Web.config 檔案中加入下列：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-481">Add the following to the web.config file:</span></span>


[!code-xml[Main](configuration-and-instrumentation/samples/sample14.xml)]

<span data-ttu-id="6e3bc-482">這可確保您有將變更儲存到 web.config 檔案的權限。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-482">This will ensure that you have permission to save changes to the web.config file.</span></span>

1. <span data-ttu-id="6e3bc-483">將新的 Label 控制項加入至 Default.aspx，並變更 ID **lblDebugStatus**。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-483">Add a new Label control to Default.aspx and change the ID to **lblDebugStatus**.</span></span>
2. <span data-ttu-id="6e3bc-484">將新的按鈕控制項加入至 Default.aspx。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-484">Add a new Button control to Default.aspx.</span></span>
3. <span data-ttu-id="6e3bc-485">變更按鈕控制項的 ID **btnToggleDebug**和以文字**切換偵錯狀態**。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-485">Change the Button control's ID to **btnToggleDebug** and the Text to **Toggle Debug Status**.</span></span>
4. <span data-ttu-id="6e3bc-486">開啟 Default.aspx 的程式碼後置檔案的程式碼 檢視，然後加入**使用**陳述式**System.Web.Configuration** ，如下所示：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-486">Open the Code View for the code-behind file of Default.aspx and add a **using** statement for **System.Web.Configuration** as follows:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample15.cs)]

1. <span data-ttu-id="6e3bc-487">將兩個私用變數加入至類別和頁面\_Init 方法，如下所示：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-487">Add two private variables to the class and a Page\_Init method as shown below:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample16.cs)]

1. <span data-ttu-id="6e3bc-488">將下列程式碼加入至頁面\_負載：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-488">Add the following code to Page\_Load:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample17.cs)]

1. <span data-ttu-id="6e3bc-489">儲存並瀏覽 default.aspx。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-489">Save and browse default.aspx.</span></span> <span data-ttu-id="6e3bc-490">請注意標籤控制項會顯示目前的偵錯狀態。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-490">Notice that the Label control displays the current debug status.</span></span>
2. <span data-ttu-id="6e3bc-491">在設計工具中的按鈕控制項上按兩下，將下列程式碼加入至按鈕控制項的 Click 事件：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-491">Double-click on the Button control in the designer and add the following code to the Click event for the Button control:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample18.cs)]

1. <span data-ttu-id="6e3bc-492">儲存並瀏覽 default.aspx，然後按一下 [] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-492">Save and browse default.aspx and click the button.</span></span>
2. <span data-ttu-id="6e3bc-493">開啟 web.config 檔案之後每個按鈕按一下，然後觀察,**偵錯**屬性&lt;編譯&gt;> 一節。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-493">Open the web.config file after each button click and observe the **debug** attribute in the &lt;compilation&gt; section.</span></span>

## <a name="lab-2-logging-application-restarts"></a><span data-ttu-id="6e3bc-494">實驗室 2： 記錄重新啟動應用程式</span><span class="sxs-lookup"><span data-stu-id="6e3bc-494">Lab 2: Logging Application Restarts</span></span>

<span data-ttu-id="6e3bc-495">在此實驗室中，您將建立可讓您切換記錄應用程式關閉、 啟動和 事件檢視器中的重新編譯的程式碼。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-495">In this lab, you will create code that will allow you to toggle the logging of application shutdowns, startups, and recompilations in the Event Viewer.</span></span>

1. <span data-ttu-id="6e3bc-496">新增 DropDownList default.aspx，然後將識別碼變更 ddlLogAppEvents。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-496">Add a DropDownList to default.aspx and change the ID to ddlLogAppEvents.</span></span>
2. <span data-ttu-id="6e3bc-497">設定**AutoPostBack**屬性 DropDownList 以**true**。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-497">Set the **AutoPostBack** property for the DropDownList to **true**.</span></span>
3. <span data-ttu-id="6e3bc-498">將三個項目加入至 DropDownList 的項目集合。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-498">Add three items to the Items collection for the DropDownList.</span></span> <span data-ttu-id="6e3bc-499">請**文字**第一個項目的*Select Value*和-1 的值。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-499">Make the **Text** for the first item *Select Value* and the value -1.</span></span> <span data-ttu-id="6e3bc-500">請**文字**和**值**第二個項目的**True**和**文字**和**值**第三個項目**False**。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-500">Make the **Text** and **Value** of the second item **True** and the **Text** and **Value** of the third item **False**.</span></span>
4. <span data-ttu-id="6e3bc-501">將新的標籤加入至 default.aspx。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-501">Add a new Label to default.aspx.</span></span> <span data-ttu-id="6e3bc-502">變更要識別碼**lblLogAppEvents**。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-502">Change the ID to **lblLogAppEvents**.</span></span>
5. <span data-ttu-id="6e3bc-503">開啟 default.aspx 的程式碼後置檢視，並加入新的宣告變數的型別 HealthMonitoringSection，如下所示：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-503">Open the code-behind view for default.aspx and add a new declaration for a variable of type HealthMonitoringSection as shown below:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample19.cs)]

1. <span data-ttu-id="6e3bc-504">將下列程式碼加入至網頁中的現有程式碼\_初始化：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-504">Add the following code to the existing code in Page\_Init:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample20.cs)]

1. <span data-ttu-id="6e3bc-505">按兩下 DropDownList 和 SelectedIndexChanged 事件中加入下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-505">Double-click on the DropDownList and add the following code to the SelectedIndexChanged event:</span></span>


[!code-csharp[Main](configuration-and-instrumentation/samples/sample21.cs)]

1. <span data-ttu-id="6e3bc-506">瀏覽 default.aspx。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-506">Browse default.aspx.</span></span>
2. <span data-ttu-id="6e3bc-507">設定下拉式清單中，為**False**。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-507">Set the dropdown to **False**.</span></span>
3. <span data-ttu-id="6e3bc-508">清除 事件檢視器中的應用程式記錄檔。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-508">Clear the Application log in the Event Viewer.</span></span>
4. <span data-ttu-id="6e3bc-509">按一下按鈕來變更應用程式的偵錯屬性。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-509">Click the button to change the Debug attribute for the application.</span></span>
5. <span data-ttu-id="6e3bc-510">重新整理應用程式記錄檔事件檢視器中。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-510">Refresh the Application log in the Event Viewer.</span></span> 

    1. <span data-ttu-id="6e3bc-511">所記錄的任何事件</span><span class="sxs-lookup"><span data-stu-id="6e3bc-511">Were any events logged?</span></span>
    2. <span data-ttu-id="6e3bc-512">為什麼或原因為何？</span><span class="sxs-lookup"><span data-stu-id="6e3bc-512">Why or why not?</span></span>
6. <span data-ttu-id="6e3bc-513">設定下拉式清單中，為**，則為 True。**</span><span class="sxs-lookup"><span data-stu-id="6e3bc-513">Set the dropdown to **True.**</span></span>
7. <span data-ttu-id="6e3bc-514">按一下按鈕來切換應用程式的偵錯屬性。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-514">Click the button to toggle the Debug attribute for the application.</span></span>
8. <span data-ttu-id="6e3bc-515">重新整理應用程式登入事件檢視器。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-515">Refresh the Application login the Event Viewer.</span></span> 

    1. <span data-ttu-id="6e3bc-516">所記錄的任何事件</span><span class="sxs-lookup"><span data-stu-id="6e3bc-516">Were any events logged?</span></span>
    2. <span data-ttu-id="6e3bc-517">應用程式關機的原因是什麼？</span><span class="sxs-lookup"><span data-stu-id="6e3bc-517">What was the reason for the app shutdown?</span></span>
9. <span data-ttu-id="6e3bc-518">嘗試開啟和關閉記錄功能，並查看 web.config 檔案所做的變更。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-518">Experiment with turning on and off logging and look at the changes made to the web.config file.</span></span>

## <a name="more-information"></a><span data-ttu-id="6e3bc-519">詳細資訊：</span><span class="sxs-lookup"><span data-stu-id="6e3bc-519">More Information:</span></span>

<span data-ttu-id="6e3bc-520">ASP.NET 2.0 的提供者模型可讓您建立自己的提供者不只是應用程式檢測，但許多其他用途以及例如成員資格、 設定檔等等。如需撰寫自訂的提供者，將應用程式事件記錄到文字檔的詳細資訊，請瀏覽[此連結](https://msdn.microsoft.com/library/default.asp?url=/library/dnaspp/html/ASPNETProvMod_Prt6.asp)。</span><span class="sxs-lookup"><span data-stu-id="6e3bc-520">ASP.NET 2.0's Provider model allows you to create your own providers for not only application instrumentation, but for many other uses as well such as Membership, Profiles, etc. For detailed information on writing a custom provider to log application events to a text file, visit [this link](https://msdn.microsoft.com/library/default.asp?url=/library/dnaspp/html/ASPNETProvMod_Prt6.asp).</span></span>
