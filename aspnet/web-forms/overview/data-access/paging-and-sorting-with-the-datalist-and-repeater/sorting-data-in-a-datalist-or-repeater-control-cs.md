---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
title: "排序資料在中繼器控制項中 (C#) 或 DataList |Microsoft 文件"
author: rick-anderson
description: "在本教學課程中，我們將檢驗如何納入排序 DataList 和中繼器中的支援，以及如何建構資料可以 DataList 或中繼器..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/13/2006
ms.topic: article
ms.assetid: f52c302a-1b7c-46fe-8a13-8412c95cbf6d
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
msc.type: authoredcontent
ms.openlocfilehash: f7ab0df2ebfa24b0928117e683325b158e3aad1c
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/10/2017
---
<a name="sorting-data-in-a-datalist-or-repeater-control-c"></a><span data-ttu-id="c0902-103">DataList 或中繼器控制項中 (C#) 中的排序資料</span><span class="sxs-lookup"><span data-stu-id="c0902-103">Sorting Data in a DataList or Repeater Control (C#)</span></span>
====================
<span data-ttu-id="c0902-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c0902-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c0902-105">[下載範例應用程式](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe)或[下載 PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c0902-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span></span>

> <span data-ttu-id="c0902-106">在本教學課程中，我們將檢驗如何納入排序 DataList 和中繼器中的支援，以及如何建構 DataList 或中繼器的可以分頁和排序資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>


## <a name="introduction"></a><span data-ttu-id="c0902-107">簡介</span><span class="sxs-lookup"><span data-stu-id="c0902-107">Introduction</span></span>

<span data-ttu-id="c0902-108">在[上一個教學課程](paging-report-data-in-a-datalist-or-repeater-control-cs.md)我們檢驗如何將資料清單中的分頁支援。</span><span class="sxs-lookup"><span data-stu-id="c0902-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="c0902-109">我們建立了新的方法中`ProductsBLL`類別 (`GetProductsAsPagedDataSource`) 傳回`PagedDataSource`物件。</span><span class="sxs-lookup"><span data-stu-id="c0902-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="c0902-110">當繫結至 DataList 或中繼器，DataList 或中繼器會顯示只是要求的資料頁。</span><span class="sxs-lookup"><span data-stu-id="c0902-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="c0902-111">這個技術非常類似於用途內部 GridView、 DetailsView 和 FormView 控制項所提供的內建的預設分頁功能。</span><span class="sxs-lookup"><span data-stu-id="c0902-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="c0902-112">除了提供分頁支援，GridView 也包含現成排序支援。</span><span class="sxs-lookup"><span data-stu-id="c0902-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="c0902-113">DataList 都中繼器提供內建的排序功能。不過，排序功能可以使用新增許多程式碼。</span><span class="sxs-lookup"><span data-stu-id="c0902-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="c0902-114">在本教學課程中，我們將檢驗如何納入排序 DataList 和中繼器中的支援，以及如何建構 DataList 或中繼器的可以分頁和排序資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="c0902-115">檢閱排序</span><span class="sxs-lookup"><span data-stu-id="c0902-115">A Review of Sorting</span></span>

<span data-ttu-id="c0902-116">如我們所見中[分頁和排序報表資料](../paging-and-sorting/paging-and-sorting-report-data-cs.md)教學課程中，排序支援現成提供的 GridView 控制項。</span><span class="sxs-lookup"><span data-stu-id="c0902-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-cs.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="c0902-117">在 GridView 中的每個欄位可以有相關聯`SortExpression`，表示用來排序資料的資料欄位。</span><span class="sxs-lookup"><span data-stu-id="c0902-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="c0902-118">當 GridView s`AllowSorting`屬性設定為`true`，具有每個 GridView 欄位`SortExpression`屬性值已轉譯為 LinkButton 標頭。</span><span class="sxs-lookup"><span data-stu-id="c0902-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="c0902-119">當使用者按一下特定的 GridView 欄位 s 標頭時，就會發生回傳和資料根據按下欄位 s 排序`SortExpression`。</span><span class="sxs-lookup"><span data-stu-id="c0902-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="c0902-120">GridView 控制項有`SortExpression`屬性，其中儲存`SortExpression`GridView 欄位的資料會依照。</span><span class="sxs-lookup"><span data-stu-id="c0902-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="c0902-121">此外，`SortDirection`屬性會指出是否要以遞增或遞減順序 （如果使用者按一下，就會切換為特定 GridView 的欄位標頭中的連結兩次連續，排序順序） 排序資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="c0902-122">在 GridView 繫結至其資料來源控制項，其傳遞其`SortExpression`和`SortDirection`屬性的資料來源控制項。</span><span class="sxs-lookup"><span data-stu-id="c0902-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="c0902-123">資料來源控制項擷取資料，然後將它排序依據提供`SortExpression`和`SortDirection`屬性。</span><span class="sxs-lookup"><span data-stu-id="c0902-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="c0902-124">完成排序之後的資料，資料來源控制項它傳回至 GridView。</span><span class="sxs-lookup"><span data-stu-id="c0902-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="c0902-125">若要複寫這項功能與 DataList 或中繼器控制項中，我們必須：</span><span class="sxs-lookup"><span data-stu-id="c0902-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="c0902-126">建立排序的介面</span><span class="sxs-lookup"><span data-stu-id="c0902-126">Create a sorting interface</span></span>
- <span data-ttu-id="c0902-127">請記住要排序的資料欄位，以及是否要以遞增或遞減順序排序</span><span class="sxs-lookup"><span data-stu-id="c0902-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="c0902-128">指示排序依據特定資料欄位資料 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="c0902-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="c0902-129">我們將會處理這些步驟 3 和 4 中的三個工作。</span><span class="sxs-lookup"><span data-stu-id="c0902-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="c0902-130">接下來，我們將檢驗如何同時包含分頁和排序 DataList 或中繼器中的支援。</span><span class="sxs-lookup"><span data-stu-id="c0902-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="c0902-131">步驟 2： 在中繼器中顯示的產品</span><span class="sxs-lookup"><span data-stu-id="c0902-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="c0902-132">我們會擔心實作的任何排序相關功能之前，可讓 s 列出中繼器控制項中的產品。</span><span class="sxs-lookup"><span data-stu-id="c0902-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="c0902-133">先開啟`Sorting.aspx`頁面`PagingSortingDataListRepeater`資料夾。</span><span class="sxs-lookup"><span data-stu-id="c0902-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="c0902-134">中繼器控制項加入網頁上，設定其`ID`屬性`SortableProducts`。</span><span class="sxs-lookup"><span data-stu-id="c0902-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="c0902-135">從中繼器 s 智慧標籤，建立名為新 ObjectDataSource`ProductsDataSource`並將它設定為從中擷取資料`ProductsBLL`類別的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="c0902-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="c0902-136">選取 （無） 選項從下拉式清單中，插入、 更新和刪除索引標籤中。</span><span class="sxs-lookup"><span data-stu-id="c0902-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="c0902-137">[![建立 ObjectDataSource，並將它設定為使用 GetProductsAsPagedDataSource() 方法](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span></span>

<span data-ttu-id="c0902-138">**圖 1**： 建立 ObjectDataSource，並將它設定為使用`GetProductsAsPagedDataSource()`方法 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span></span>


<span data-ttu-id="c0902-139">[![設定下拉式清單中更新、 插入和刪除索引標籤為 （無）](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span></span>

<span data-ttu-id="c0902-140">**圖 2**： 設定下拉式清單中更新、 插入和刪除索引標籤為 （無） ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span></span>


<span data-ttu-id="c0902-141">不同於與 DataList，Visual Studio 不會自動建立`ItemTemplate`中繼器控制項繫結至資料來源之後。</span><span class="sxs-lookup"><span data-stu-id="c0902-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="c0902-142">此外，我們必須加入`ItemTemplate`以宣告方式，因為中繼器控制項 s 智慧標籤缺少 DataList s 中找到的 [編輯樣板] 選項。</span><span class="sxs-lookup"><span data-stu-id="c0902-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="c0902-143">可讓 s 使用的相同`ItemTemplate`，從上一個教學課程中，顯示產品的名稱、 供應商和類別目錄。</span><span class="sxs-lookup"><span data-stu-id="c0902-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="c0902-144">在新增之後`ItemTemplate`，中繼器和 ObjectDataSource s 宣告式標記看起來應該類似下列：</span><span class="sxs-lookup"><span data-stu-id="c0902-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample1.aspx)]

<span data-ttu-id="c0902-145">圖 3 顯示透過瀏覽器檢視時，此頁面。</span><span class="sxs-lookup"><span data-stu-id="c0902-145">Figure 3 shows this page when viewed through a browser.</span></span>


<span data-ttu-id="c0902-146">[![會顯示每個產品 s 的名稱，供應商，以及類別目錄](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span></span>

<span data-ttu-id="c0902-147">**圖 3**： 會顯示每個產品的名稱、 供應商和類別目錄 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span></span>


## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="c0902-148">步驟 3： 指示排序資料 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="c0902-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="c0902-149">若要排序中繼器中顯示的資料，我們需要通知的排序運算式的資料應該排序 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="c0902-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="c0902-150">ObjectDataSource 擷取其資料之前，先引發其[`Selecting`事件](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx)，這樣會提供機會，讓我們來指定排序運算式。</span><span class="sxs-lookup"><span data-stu-id="c0902-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="c0902-151">`Selecting`事件處理常式會傳遞類型的物件[ `ObjectDataSourceSelectingEventArgs` ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx)，其具有內容，名為[ `Arguments` ](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx)型別的[ `DataSourceSelectArguments` ](https://msdn.microsoft.com/en-us/library/system.web.ui.datasourceselectarguments.aspx)。</span><span class="sxs-lookup"><span data-stu-id="c0902-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/en-us/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="c0902-152">`DataSourceSelectArguments`類別為了將相關的資料要求資料的取用者從傳遞至資料來源控制項，並包含[`SortExpression`屬性](https://msdn.microsoft.com/en-us/library/system.web.ui.datasourceselectarguments.sortexpression.aspx)。</span><span class="sxs-lookup"><span data-stu-id="c0902-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/en-us/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="c0902-153">若要從 ASP.NET 頁面 ObjectDataSource 傳遞排序資訊，請建立事件處理常式`Selecting`事件並使用下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="c0902-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample2.cs)]

<span data-ttu-id="c0902-154">*SortExpression*来排序的資料 （例如產品名稱） 的資料欄位的名稱應該指派值。</span><span class="sxs-lookup"><span data-stu-id="c0902-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="c0902-155">沒有排序方向相關的屬性，因此如果您想要排序的資料，以遞減順序，將字串附加 DESC 至*sortExpression*值 （例如 ProductName DESC)。</span><span class="sxs-lookup"><span data-stu-id="c0902-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="c0902-156">請繼續並再試一次的某些不同硬式編碼值*sortExpression*和瀏覽器中測試的結果。</span><span class="sxs-lookup"><span data-stu-id="c0902-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="c0902-157">如圖 4 所示，使用為 ProductName DESC 時*sortExpression*，產品會依其名稱，以反向字母順序排序。</span><span class="sxs-lookup"><span data-stu-id="c0902-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>


<span data-ttu-id="c0902-158">[![產品名稱來排序其以反向字母順序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span></span>

<span data-ttu-id="c0902-159">**圖 4**: 產品會依照其名稱以反向字母順序 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span></span>


## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="c0902-160">步驟 4： 建立排序的介面，並記住的排序運算式和方向</span><span class="sxs-lookup"><span data-stu-id="c0902-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="c0902-161">開啟排序 GridView 中的支援會將每一個 s 可排序的欄位標頭文字轉換成 LinkButton，按一下時，排序資料據此。</span><span class="sxs-lookup"><span data-stu-id="c0902-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="c0902-162">這類排序的介面有意義的 GridView，其中資料整齊地配置資料行中。</span><span class="sxs-lookup"><span data-stu-id="c0902-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="c0902-163">DataList 和中繼器控制項，不過，不同的排序介面需要。</span><span class="sxs-lookup"><span data-stu-id="c0902-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="c0902-164">排序的通用介面，取得一份資料 （而不是資料方格），是提供資料可以排序的欄位的下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="c0902-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="c0902-165">可讓 s 實作本教學課程的這類介面。</span><span class="sxs-lookup"><span data-stu-id="c0902-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="c0902-166">將上述 DropDownList Web 控制項`SortableProducts`中繼器並設定其`ID`屬性`SortBy`。</span><span class="sxs-lookup"><span data-stu-id="c0902-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="c0902-167">從 [屬性] 視窗中，按一下省略符號，`Items`屬性，以顯示清單項目集合編輯器。</span><span class="sxs-lookup"><span data-stu-id="c0902-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="c0902-168">新增`ListItem`s 排序的資料`ProductName`， `CategoryName`，和`SupplierName`欄位。</span><span class="sxs-lookup"><span data-stu-id="c0902-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="c0902-169">也新增`ListItem`由其名稱以反向字母順序排序的產品。</span><span class="sxs-lookup"><span data-stu-id="c0902-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="c0902-170">`ListItem` `Text`屬性可以設定為任何值 （例如名稱），但`Value`屬性必須設定為資料欄位的名稱 （例如產品名稱）。</span><span class="sxs-lookup"><span data-stu-id="c0902-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="c0902-171">若要排序的結果以遞減順序，將附加至像是 ProductName DESC 的資料欄位名稱的字串 DESC。</span><span class="sxs-lookup"><span data-stu-id="c0902-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>


![新增清單項目，每個可排序資料欄位](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image13.png)

<span data-ttu-id="c0902-173">**圖 5**： 新增`ListItem`每個可排序資料欄位</span><span class="sxs-lookup"><span data-stu-id="c0902-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>


<span data-ttu-id="c0902-174">最後，在右邊的 DropDownList 加入按鈕 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="c0902-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="c0902-175">設定其`ID`至`RefreshRepeater`及其`Text`屬性，以重新整理。</span><span class="sxs-lookup"><span data-stu-id="c0902-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="c0902-176">在建立之後`ListItem`s 和新增 [重新整理] 按鈕，DropDownList 和按鈕 s 宣告式語法看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="c0902-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample3.aspx)]

<span data-ttu-id="c0902-177">完成排序 DropDownList，與我們接下來必須更新 ObjectDataSource s`Selecting`事件處理常式，因此它會使用所選`SortBy``ListItem`s`Value`屬性而不是硬式編碼的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="c0902-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample4.cs)]

<span data-ttu-id="c0902-178">這個時候先瀏覽頁面時產品會一開始會依照`ProductName`資料欄位，因為它 s `SortBy` `ListItem`預設選取 （請參閱圖 6）。</span><span class="sxs-lookup"><span data-stu-id="c0902-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="c0902-179">選取不同的排序選項，例如類別和按一下 重新整理將會導致回傳，並重新排序資料的類別名稱，如圖 7 所示。</span><span class="sxs-lookup"><span data-stu-id="c0902-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>


<span data-ttu-id="c0902-180">[![產品為一開始會依其名稱](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span></span>

<span data-ttu-id="c0902-181">**圖 6**: 產品會一開始會依其名稱 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span></span>


<span data-ttu-id="c0902-182">[![產品為現在會依類別排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span></span>

<span data-ttu-id="c0902-183">**圖 7**: 產品會立即依類別排序 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="c0902-184">按一下 [重新整理] 按鈕會導致資料自動重新排序中繼器的檢視狀態已停用，因而導致中繼器重新繫結至其在每次回傳的資料來源。</span><span class="sxs-lookup"><span data-stu-id="c0902-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="c0902-185">如果您已保留中繼器的檢視狀態啟用，變更排序下拉式清單贏了 t 對任何會影響排序次序。</span><span class="sxs-lookup"><span data-stu-id="c0902-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won t have any affect on the sort order.</span></span> <span data-ttu-id="c0902-186">若要補救這種情況，建立 [重新整理] 按鈕 s 的事件處理常式`Click`事件和重新繫結至其資料來源中繼器 (藉由呼叫中繼器的`DataBind()`方法)。</span><span class="sxs-lookup"><span data-stu-id="c0902-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>


## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="c0902-187">記住的排序運算式和方向</span><span class="sxs-lookup"><span data-stu-id="c0902-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="c0902-188">建立非排序與可能會發生回傳，在頁面上的可排序的 DataList 或中繼器時它 s 命令式的排序運算式和方向會記住在回傳。</span><span class="sxs-lookup"><span data-stu-id="c0902-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="c0902-189">例如，假設我們已中繼器更新在本教學課程，包括與每個產品的 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="c0902-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="c0902-190">當使用者按一下 [刪除] 按鈕 d 我們會執行一些程式碼來刪除選取的產品，然後重新繫結至中繼器的資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="c0902-191">如果排序詳細資料不會保存跨回傳，螢幕上顯示的資料將會還原為原始的排序次序。</span><span class="sxs-lookup"><span data-stu-id="c0902-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="c0902-192">本教學課程，DropDownList 以隱含方式將儲存排序運算式和方向其檢視狀態為我們。</span><span class="sxs-lookup"><span data-stu-id="c0902-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="c0902-193">如果我們使用不同的排序介面其中一個具有所提供的各種不同的排序選項的說，LinkButtons d 我們需要謹慎地在回傳記住的排序次序。</span><span class="sxs-lookup"><span data-stu-id="c0902-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="c0902-194">這可藉由來包含排序參數在查詢字串，或透過其他狀態持續性方法，將排序參數儲存在頁面的檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="c0902-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="c0902-195">未來的範例，在本教學課程中，瀏覽如何保存網頁的檢視狀態中的排序詳細資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="c0902-196">步驟 5： 加入要使用預設分頁 DataList 排序支援</span><span class="sxs-lookup"><span data-stu-id="c0902-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="c0902-197">在[前述教學課程](paging-report-data-in-a-datalist-or-repeater-control-cs.md)我們檢查如何實作與 DataList 預設分頁。</span><span class="sxs-lookup"><span data-stu-id="c0902-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="c0902-198">可讓 s 擴充此先前的範例包括能夠排序分頁的資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="c0902-199">先開啟`SortingWithDefaultPaging.aspx`和`Paging.aspx`中的分頁`PagingSortingDataListRepeater`資料夾。</span><span class="sxs-lookup"><span data-stu-id="c0902-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="c0902-200">從`Paging.aspx`頁面上，按一下 [來源] 按鈕來檢視網頁 s 宣告式標記上。</span><span class="sxs-lookup"><span data-stu-id="c0902-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="c0902-201">複製選取的文字 （請參閱圖 8） 並將它貼到的宣告式標記`SortingWithDefaultPaging.aspx`之間`<asp:Content>`標記。</span><span class="sxs-lookup"><span data-stu-id="c0902-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>


<span data-ttu-id="c0902-202">[![複寫中的宣告式標記&lt;asp: Content&gt; Paging.aspx SortingWithDefaultPaging.aspx 的標記](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span></span>

<span data-ttu-id="c0902-203">**圖 8**： 複寫中的宣告式標記`<asp:Content>`標記從`Paging.aspx`至`SortingWithDefaultPaging.aspx`([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span></span>


<span data-ttu-id="c0902-204">複製的宣告式標記之後, 將複製的方法和屬性在`Paging.aspx`頁面 s 程式碼後置類別的程式碼後置類別`SortingWithDefaultPaging.aspx`。</span><span class="sxs-lookup"><span data-stu-id="c0902-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="c0902-205">接下來，請花一點時間檢視`SortingWithDefaultPaging.aspx`瀏覽器中的。</span><span class="sxs-lookup"><span data-stu-id="c0902-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="c0902-206">它應該在相同的功能和外觀與展示`Paging.aspx`。</span><span class="sxs-lookup"><span data-stu-id="c0902-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="c0902-207">增強 ProductsBLL 来包含預設分頁和排序方法</span><span class="sxs-lookup"><span data-stu-id="c0902-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="c0902-208">在上一個教學課程中我們建立`GetProductsAsPagedDataSource(pageIndex, pageSize)`方法中的`ProductsBLL`類別傳回`PagedDataSource`物件。</span><span class="sxs-lookup"><span data-stu-id="c0902-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="c0902-209">這`PagedDataSource`物件已填入*所有*的產品 (經由 BLL s`GetProducts()`方法)，當繫結至 DataList 對應至指定的記錄，但*pageIndex*和*pageSize*顯示輸入的參數。</span><span class="sxs-lookup"><span data-stu-id="c0902-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="c0902-210">稍早在本教學課程中加入排序支援藉由指定的排序運算式，從 ObjectDataSource 的`Selecting`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="c0902-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="c0902-211">這就非常適合 ObjectDataSource 傳回物件可以進行排序，例如`ProductsDataTable`傳回`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="c0902-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="c0902-212">不過，`PagedDataSource`所傳回物件`GetProductsAsPagedDataSource`方法不支援其內部資料來源的排序。</span><span class="sxs-lookup"><span data-stu-id="c0902-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="c0902-213">相反地，我們需要排序傳回之結果`GetProducts()`方法*之前*我們將其放在`PagedDataSource`。</span><span class="sxs-lookup"><span data-stu-id="c0902-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="c0902-214">若要達成此目的，建立新的方法中`ProductsBLL`類別`GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`。</span><span class="sxs-lookup"><span data-stu-id="c0902-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="c0902-215">若要排序`ProductsDataTable`傳回`GetProducts()`方法，指定`Sort`屬性的預設值`DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="c0902-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample5.cs)]

<span data-ttu-id="c0902-216">`GetProductsSortedAsPagedDataSource`方法只會稍微不同從`GetProductsAsPagedDataSource`在上一個教學課程中建立的方法。</span><span class="sxs-lookup"><span data-stu-id="c0902-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="c0902-217">特別是，`GetProductsSortedAsPagedDataSource`接受其他的輸入的參數`sortExpression`並指派此值設為`Sort`屬性`ProductDataTable`s `DefaultView`。</span><span class="sxs-lookup"><span data-stu-id="c0902-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="c0902-218">只要幾行程式碼之後，`PagedDataSource`物件 s 資料來源指派`ProductDataTable`s `DefaultView`。</span><span class="sxs-lookup"><span data-stu-id="c0902-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="c0902-219">呼叫 GetProductsSortedAsPagedDataSource 方法，並指定 SortExpression 輸入參數的值</span><span class="sxs-lookup"><span data-stu-id="c0902-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="c0902-220">與`GetProductsSortedAsPagedDataSource`方法完成下, 一個步驟是為此參數提供值。</span><span class="sxs-lookup"><span data-stu-id="c0902-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="c0902-221">在 ObjectDataSource`SortingWithDefaultPaging.aspx`目前設定為呼叫`GetProductsAsPagedDataSource`方法，並透過兩個的兩個輸入參數中傳遞`QueryStringParameters`，其指定在`SelectParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="c0902-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="c0902-222">這兩個`QueryStringParameters`指示的來源`GetProductsAsPagedDataSource`方法 s *pageIndex*和*pageSize*參數來自 querystring 欄位`pageIndex`和`pageSize`。</span><span class="sxs-lookup"><span data-stu-id="c0902-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="c0902-223">更新 ObjectDataSource s`SelectMethod`屬性，它會叫用的新好`GetProductsSortedAsPagedDataSource`方法。</span><span class="sxs-lookup"><span data-stu-id="c0902-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="c0902-224">然後，將 新`QueryStringParameter`以便*sortExpression*輸入的參數從查詢字串欄位存取`sortExpression`。</span><span class="sxs-lookup"><span data-stu-id="c0902-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="c0902-225">設定`QueryStringParameter`s`DefaultValue`以產品名稱。</span><span class="sxs-lookup"><span data-stu-id="c0902-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="c0902-226">這些變更之後，請 ObjectDataSource s 宣告式標記看起來應該像：</span><span class="sxs-lookup"><span data-stu-id="c0902-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample6.aspx)]

<span data-ttu-id="c0902-227">此時，`SortingWithDefaultPaging.aspx`頁面會依字母順序排序其結果，依產品名稱 （請參閱圖 9）。</span><span class="sxs-lookup"><span data-stu-id="c0902-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="c0902-228">這是因為根據預設，值的產品名稱傳遞為`GetProductsSortedAsPagedDataSource`方法 s *sortExpression*參數。</span><span class="sxs-lookup"><span data-stu-id="c0902-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>


<span data-ttu-id="c0902-229">[![根據預設，結果會依照產品名稱](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span></span>

<span data-ttu-id="c0902-230">**圖 9**： 根據預設，結果會依照`ProductName`([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span></span>


<span data-ttu-id="c0902-231">如果您手動新增`sortExpression`querystring 欄位，例如`SortingWithDefaultPaging.aspx?sortExpression=CategoryName`排序結果所指定`sortExpression`。</span><span class="sxs-lookup"><span data-stu-id="c0902-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="c0902-232">不過，這`sortExpression`移動至其他頁面的資料時，於 querystring 中不包含參數。</span><span class="sxs-lookup"><span data-stu-id="c0902-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="c0902-233">事實上，按一下下一步] 或 [最後一個頁面上的按鈕會讓我們回到`Paging.aspx`！</span><span class="sxs-lookup"><span data-stu-id="c0902-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="c0902-234">此外，有 s 目前未排序的介面。</span><span class="sxs-lookup"><span data-stu-id="c0902-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="c0902-235">使用者可以變更分頁的資料的排序順序的唯一方法是藉由直接操作的 querystring。</span><span class="sxs-lookup"><span data-stu-id="c0902-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="c0902-236">建立排序的介面</span><span class="sxs-lookup"><span data-stu-id="c0902-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="c0902-237">我們必須先更新`RedirectUser`方法，以便傳送使用者`SortingWithDefaultPaging.aspx`(而不是`Paging.aspx`)，以及包含`sortExpression`於 querystring 中的值。</span><span class="sxs-lookup"><span data-stu-id="c0902-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="c0902-238">我們也應該新增唯讀的頁面層級名為`SortExpression`屬性。</span><span class="sxs-lookup"><span data-stu-id="c0902-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="c0902-239">此屬性，類似於`PageIndex`和`PageSize`先前的教學課程中建立屬性傳回的值`sortExpression`querystring 欄位，如果存在，而且預設值 (ProductName) 否則。</span><span class="sxs-lookup"><span data-stu-id="c0902-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="c0902-240">目前`RedirectUser`方法接受只有一個輸入的參數來顯示頁面的索引。</span><span class="sxs-lookup"><span data-stu-id="c0902-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="c0902-241">不過，可能是我們想要將使用者重新導向至特定的頁面上，使用查詢字串中指定哪些 s 以外的排序運算式的資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="c0902-242">稍後我們將建立此頁面上，其中包含一系列的排序資料所指定之資料行的按鈕 Web 控制項的排序介面。</span><span class="sxs-lookup"><span data-stu-id="c0902-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="c0902-243">按一下其中一個這些按鈕時，我們想要傳入適當的排序運算式的值將使用者重新導向。</span><span class="sxs-lookup"><span data-stu-id="c0902-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="c0902-244">若要提供這項功能，建立兩個版本`RedirectUser`方法。</span><span class="sxs-lookup"><span data-stu-id="c0902-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="c0902-245">第一個應該接受頁面索引來顯示，而第二個可接受的頁面索引和排序運算式。</span><span class="sxs-lookup"><span data-stu-id="c0902-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample7.cs)]

<span data-ttu-id="c0902-246">在本教學課程中第一個範例中，我們會建立使用 DropDownList 排序介面。</span><span class="sxs-lookup"><span data-stu-id="c0902-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="c0902-247">此範例中，o d e s 使用上述其中一個在 DataList 置於所排序的三個按鈕 Web 控制項`ProductName`，下列其中一個針對`CategoryName`，，另一個用於`SupplierName`。</span><span class="sxs-lookup"><span data-stu-id="c0902-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="c0902-248">將三個按鈕 Web 控制項，設定其`ID`和`Text`屬性適當地：</span><span class="sxs-lookup"><span data-stu-id="c0902-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample8.aspx)]

<span data-ttu-id="c0902-249">接下來，建立`Click`每個事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="c0902-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="c0902-250">事件處理常式應該呼叫`RedirectUser`方法，傳回使用者第一頁使用適當的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="c0902-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample9.cs)]

<span data-ttu-id="c0902-251">當第一次造訪的頁面時，資料會依產品名稱依字母順序排序 （請參閱上一步圖 9）。</span><span class="sxs-lookup"><span data-stu-id="c0902-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="c0902-252">按一下 下一步 按鈕前進到第二個資料頁，然後按一下類別按鈕的 排序。</span><span class="sxs-lookup"><span data-stu-id="c0902-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="c0902-253">這會傳回我們第一頁的資料，依照類別目錄名稱 （請參閱圖 10）。</span><span class="sxs-lookup"><span data-stu-id="c0902-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="c0902-254">同樣地，由供應商 按鈕按一下排序排序從資料的第一頁開始的供應商資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="c0902-255">透過資料形式，會記住排序選項。</span><span class="sxs-lookup"><span data-stu-id="c0902-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="c0902-256">圖 11 顯示依分類排序後再跳至資料的第十三個頁面的頁面。</span><span class="sxs-lookup"><span data-stu-id="c0902-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>


<span data-ttu-id="c0902-257">[![會依類別排序產品](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span></span>

<span data-ttu-id="c0902-258">**圖 10**: 產品會依類別排序 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span></span>


<span data-ttu-id="c0902-259">[![排序運算式會記住分頁透過資料時](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span></span>

<span data-ttu-id="c0902-260">**圖 11**: 排序運算式會記住分頁透過資料時 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span></span>


## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="c0902-261">透過記錄在中繼器中的步驟 6： 自訂分頁</span><span class="sxs-lookup"><span data-stu-id="c0902-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="c0902-262">DataList 範例會檢查在步驟 5 的頁面，透過使用沒有效率的預設分頁技術其資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="c0902-263">若充分大量的資料進行分頁，務必使用自訂分頁。</span><span class="sxs-lookup"><span data-stu-id="c0902-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="c0902-264">回到[有效率地透過大型量的資料分頁](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md)和[排序自訂分頁資料](../paging-and-sorting/sorting-custom-paged-data-cs.md)教學課程中，我們會檢查為 BLL 中預設和自訂分頁以及建立的方法之間的差異使用自訂分頁和排序自訂分頁的資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-cs.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="c0902-265">特別是，這些兩個先前的教學課程中我們加入下列三種方法`ProductsBLL`類別：</span><span class="sxs-lookup"><span data-stu-id="c0902-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="c0902-266">`GetProductsPaged(startRowIndex, maximumRows)`傳回開始記錄的特定子集*startRowIndex*和不超過*maximumRows*。</span><span class="sxs-lookup"><span data-stu-id="c0902-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="c0902-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)`傳回記錄依照指定的特定子集*sortExpression*輸入的參數。</span><span class="sxs-lookup"><span data-stu-id="c0902-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="c0902-268">`TotalNumberOfProducts()`提供的記錄總數`Products`資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="c0902-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="c0902-269">這些方法可用來有效率地頁面上，並使用 DataList 或中繼器控制項中的資料進行排序。</span><span class="sxs-lookup"><span data-stu-id="c0902-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="c0902-270">為了說明這點，可讓啟動藉由使用自訂分頁支援; 建立中繼器控制項中的 s然後，我們要加入排序功能。</span><span class="sxs-lookup"><span data-stu-id="c0902-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="c0902-271">開啟`SortingWithCustomPaging.aspx`頁面`PagingSortingDataListRepeater`資料夾，並將重複項加入至頁面上，設定其`ID`屬性`Products`。</span><span class="sxs-lookup"><span data-stu-id="c0902-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="c0902-272">從中繼器 s 智慧標籤，建立名為新 ObjectDataSource `ProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="c0902-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="c0902-273">將它設定為選取其資料從`ProductsBLL`類別的`GetProductsPaged`方法。</span><span class="sxs-lookup"><span data-stu-id="c0902-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>


<span data-ttu-id="c0902-274">[![設定為使用 ProductsBLL 類別的 GetProductsPaged 方法 ObjectDataSource](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span></span>

<span data-ttu-id="c0902-275">**圖 12**： 設定要使用 ObjectDataSource`ProductsBLL`類別 s`GetProductsPaged`方法 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span></span>


<span data-ttu-id="c0902-276">設定下拉式清單中更新、 插入並刪除索引標籤為 （無），然後按一下 下一步 按鈕。</span><span class="sxs-lookup"><span data-stu-id="c0902-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="c0902-277">設定資料來源精靈現在會提示輸入的來源`GetProductsPaged`方法 s *startRowIndex*和*maximumRows*輸入參數。</span><span class="sxs-lookup"><span data-stu-id="c0902-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="c0902-278">事實上，會忽略這些輸入的參數。</span><span class="sxs-lookup"><span data-stu-id="c0902-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="c0902-279">相反地， *startRowIndex*和*maximumRows*值將會在傳遞給`Arguments`ObjectDataSource s 中的屬性`Selecting`事件處理常式，如同我們的指定方式*sortExpression*在此教學課程 s 第一個示範。</span><span class="sxs-lookup"><span data-stu-id="c0902-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="c0902-280">因此，將保留參數來源 none 設定精靈中的下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="c0902-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>


<span data-ttu-id="c0902-281">[![保留參數來源設定為 None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span></span>

<span data-ttu-id="c0902-282">**圖 13**： 保留參數來源設定為 None ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span></span>


> [!NOTE]
> <span data-ttu-id="c0902-283">請勿*不*組 ObjectDataSource s`EnablePaging`屬性`true`。</span><span class="sxs-lookup"><span data-stu-id="c0902-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="c0902-284">這會自動包含它自己 ObjectDataSource *startRowIndex*和*maximumRows*參數`SelectMethod`s 現有的參數清單。</span><span class="sxs-lookup"><span data-stu-id="c0902-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="c0902-285">`EnablePaging`屬性時，繫結自訂分頁至 GridView、 DetailsView 或在 FormView 控制項的資料，因為這些控制項預期從 ObjectDataSource s 特定行為時才使用`EnablePaging`屬性是`true`。</span><span class="sxs-lookup"><span data-stu-id="c0902-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="c0902-286">由於我們有手動新增 DataList 和中繼器的分頁支援，讓這個屬性設定為`false`（預設值），因為我們將直接在我們的 ASP.NET 頁面內試吃中需要的功能。</span><span class="sxs-lookup"><span data-stu-id="c0902-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>


<span data-ttu-id="c0902-287">最後，定義中繼器的`ItemTemplate`以顯示產品的名稱、 類別和供應商。</span><span class="sxs-lookup"><span data-stu-id="c0902-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="c0902-288">這些變更之後，請中繼器和 ObjectDataSource s 宣告式語法看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="c0902-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample10.aspx)]

<span data-ttu-id="c0902-289">請花一點時間瀏覽的頁面，透過瀏覽器，並記下會傳回任何記錄。</span><span class="sxs-lookup"><span data-stu-id="c0902-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="c0902-290">這是因為我們尚未以指定 ve *startRowIndex*和*maximumRows*參數的值; 因此，值 0 會傳遞兩個。</span><span class="sxs-lookup"><span data-stu-id="c0902-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="c0902-291">若要指定這些值，建立事件處理常式 ObjectDataSource s`Selecting`事件及設定這些參數值以程式設計方式硬式編碼值 0 到 5，分別：</span><span class="sxs-lookup"><span data-stu-id="c0902-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample11.cs)]

<span data-ttu-id="c0902-292">透過這項變更，頁面上，當透過瀏覽器中，檢視會顯示前五個產品。</span><span class="sxs-lookup"><span data-stu-id="c0902-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>


<span data-ttu-id="c0902-293">[![會顯示第一個五筆記錄](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span></span>

<span data-ttu-id="c0902-294">**圖 14**： 會顯示第一個五筆記錄 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span></span>


> [!NOTE]
> <span data-ttu-id="c0902-295">若要依產品名稱排序，因為發生圖 14 中列出的產品`GetProductsPaged`執行有效率的自訂分頁查詢的預存程序排序的結果`ProductName`。</span><span class="sxs-lookup"><span data-stu-id="c0902-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>


<span data-ttu-id="c0902-296">為了讓使用者逐步進行頁面中，我們需要追蹤的起始資料列索引和最大資料列，並在回傳記住這些值。</span><span class="sxs-lookup"><span data-stu-id="c0902-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="c0902-297">預設分頁範例中使用查詢字串欄位保存這些值。這個示範中，可讓 s 保存網頁的檢視狀態的資訊。</span><span class="sxs-lookup"><span data-stu-id="c0902-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="c0902-298">建立下列兩個屬性：</span><span class="sxs-lookup"><span data-stu-id="c0902-298">Create the following two properties:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample12.cs)]

<span data-ttu-id="c0902-299">接下來，更新選取的事件處理常式的程式碼，使其使用`StartRowIndex`和`MaximumRows`屬性而非 0 到 5 的硬式編碼值：</span><span class="sxs-lookup"><span data-stu-id="c0902-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample13.cs)]

<span data-ttu-id="c0902-300">此時我們的頁面仍然會顯示前五個的記錄。</span><span class="sxs-lookup"><span data-stu-id="c0902-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="c0902-301">不過，在使用這些屬性的位置，我們準備好建立我們分頁的介面。</span><span class="sxs-lookup"><span data-stu-id="c0902-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="c0902-302">新增分頁介面</span><span class="sxs-lookup"><span data-stu-id="c0902-302">Adding the Paging Interface</span></span>

<span data-ttu-id="c0902-303">可讓的會使用相同的第一個、 上一步，接下來，最後分頁介面用於預設分頁範例中，包含標籤 Web 檢視會顯示哪些資料頁的控制項和存在多少的總頁數。</span><span class="sxs-lookup"><span data-stu-id="c0902-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="c0902-304">加入四個按鈕 Web 控制項和中繼器下方的標籤。</span><span class="sxs-lookup"><span data-stu-id="c0902-304">Add the four Button Web controls and Label below the Repeater.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample14.aspx)]

<span data-ttu-id="c0902-305">接下來，建立`Click`四個按鈕的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="c0902-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="c0902-306">按一下其中一個按鈕時，我們需要更新`StartRowIndex`重新繫結至中繼器的資料。</span><span class="sxs-lookup"><span data-stu-id="c0902-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="c0902-307">名字、 上一步和 下一步 按鈕的程式碼相當簡單，但最後一個按鈕執行我們如何判斷資料的最後一頁的開始資料列索引嗎？</span><span class="sxs-lookup"><span data-stu-id="c0902-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="c0902-308">若要計算此索引，以及判斷是否應該啟用下一步] 和 [最後一個按鈕我們需要知道總計中的多少筆記錄需透過分頁處理能力。</span><span class="sxs-lookup"><span data-stu-id="c0902-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="c0902-309">我們可以呼叫來判斷這`ProductsBLL`類別的`TotalNumberOfProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="c0902-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="c0902-310">可讓 s 建立名為的唯讀、 頁面層級屬性`TotalRowCount`所傳回的結果`TotalNumberOfProducts()`方法：</span><span class="sxs-lookup"><span data-stu-id="c0902-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample15.cs)]

<span data-ttu-id="c0902-311">這個屬性與我們現在可以判斷最後一頁開始資料列的索引。</span><span class="sxs-lookup"><span data-stu-id="c0902-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="c0902-312">具體來說，它 s 整數結果的`TotalRowCount`減 1 除以`MaximumRows`乘以`MaximumRows`。</span><span class="sxs-lookup"><span data-stu-id="c0902-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="c0902-313">現在我們可以撰寫`Click`四個分頁介面按鈕的事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="c0902-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample16.cs)]

<span data-ttu-id="c0902-314">最後，我們需要檢視最後一頁時，檢視資料和下一步 和 最後一個按鈕的第一頁時，停用分頁介面中的第一個 和 上一頁 按鈕。</span><span class="sxs-lookup"><span data-stu-id="c0902-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="c0902-315">若要完成這項作業，加入下列程式碼 ObjectDataSource 的`Selecting`事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="c0902-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample17.cs)]

<span data-ttu-id="c0902-316">新增這些後`Click`瀏覽器中測試網頁，事件處理常式和程式碼以啟用或停用根據目前的起始資料列索引的分頁介面項目。</span><span class="sxs-lookup"><span data-stu-id="c0902-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="c0902-317">圖 15 所示，當第一次瀏覽頁面第一個和上一個 按鈕將會停用。</span><span class="sxs-lookup"><span data-stu-id="c0902-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="c0902-318">按一下 [下一步] 顯示的資料，第二個頁面，按一下最後一個則會顯示最後一頁 （請參閱數據 16 及 17）。</span><span class="sxs-lookup"><span data-stu-id="c0902-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="c0902-319">檢視資料的最後一頁時，會停用 下一步 和 最後一個按鈕。</span><span class="sxs-lookup"><span data-stu-id="c0902-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>


<span data-ttu-id="c0902-320">[![上一個和最後一個 按鈕就會停用檢視第一個頁面的產品](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span></span>

<span data-ttu-id="c0902-321">**圖 15**: 上一個和最後一個按鈕就會停用檢視第一個頁面的產品 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span></span>


<span data-ttu-id="c0902-322">[![第二個頁面的產品為 Dispalyed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-322">[![The Second Page of Products are Dispalyed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span></span>

<span data-ttu-id="c0902-323">**圖 16**: 第二個頁面的產品是 Dispalyed ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-323">**Figure 16**: The Second Page of Products are Dispalyed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span></span>


<span data-ttu-id="c0902-324">[![按一下最後一個顯示資料的最後一頁](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span></span>

<span data-ttu-id="c0902-325">**圖 17**： 按一下最後一個顯示的最後一個頁面的資料 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span></span>


## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="c0902-326">步驟 7： 包括排序支援，其中包含自訂分頁中繼器</span><span class="sxs-lookup"><span data-stu-id="c0902-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="c0902-327">既然已實作自訂分頁，我們要包含排序準備好支援。</span><span class="sxs-lookup"><span data-stu-id="c0902-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="c0902-328">`ProductsBLL`類別 s`GetProductsPagedAndSorted`方法具有相同的*startRowIndex*和*maximumRows*輸入做為參數`GetProductsPaged`，但允許其他*sortExpression*輸入的參數。</span><span class="sxs-lookup"><span data-stu-id="c0902-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="c0902-329">若要使用`GetProductsPagedAndSorted`方法從`SortingWithCustomPaging.aspx`，我們需要執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="c0902-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="c0902-330">變更 ObjectDataSource s`SelectMethod`屬性從`GetProductsPaged`至`GetProductsPagedAndSorted`。</span><span class="sxs-lookup"><span data-stu-id="c0902-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="c0902-331">新增*sortExpression* `Parameter` ObjectDataSource s 物件`SelectParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="c0902-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="c0902-332">建立私用，頁面層級`SortExpression`在透過 [s] 頁面檢視狀態的回傳保存其值的屬性。</span><span class="sxs-lookup"><span data-stu-id="c0902-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="c0902-333">更新 ObjectDataSource s`Selecting`事件處理常式來指派 ObjectDataSource s *sortExpression*參數的頁面層級值`SortExpression`屬性。</span><span class="sxs-lookup"><span data-stu-id="c0902-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="c0902-334">建立排序的介面。</span><span class="sxs-lookup"><span data-stu-id="c0902-334">Create the sorting interface.</span></span>

<span data-ttu-id="c0902-335">藉由更新 ObjectDataSource s 啟動`SelectMethod`屬性和加入*sortExpression* `Parameter`。</span><span class="sxs-lookup"><span data-stu-id="c0902-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="c0902-336">請確定*sortExpression* `Parameter` s`Type`屬性設定為`String`。</span><span class="sxs-lookup"><span data-stu-id="c0902-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="c0902-337">完成這些前兩個工作之後，ObjectDataSource s 宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="c0902-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample18.aspx)]

<span data-ttu-id="c0902-338">接下來，我們需要頁面層級`SortExpression`屬性其值會序列化至檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="c0902-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="c0902-339">如果沒有排序運算式的值已設定，使用 ProductName 做為預設值：</span><span class="sxs-lookup"><span data-stu-id="c0902-339">If no sort expression value has been set, use ProductName as the default:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample19.cs)]

<span data-ttu-id="c0902-340">ObjectDataSource 叫用之前`GetProductsPagedAndSorted`方法，所以我們需要將*sortExpression* `Parameter`值`SortExpression`屬性。</span><span class="sxs-lookup"><span data-stu-id="c0902-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="c0902-341">在`Selecting`事件處理常式，加入下列程式碼行：</span><span class="sxs-lookup"><span data-stu-id="c0902-341">In the `Selecting` event handler, add the following line of code:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample20.cs)]

<span data-ttu-id="c0902-342">剩下的就是實作排序的介面。</span><span class="sxs-lookup"><span data-stu-id="c0902-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="c0902-343">如我們所做的最後一個範例中，可讓 s 已排序的介面實作使用三個按鈕 Web 控制項，可讓使用者排序的結果依產品名稱、 類別或供應商。</span><span class="sxs-lookup"><span data-stu-id="c0902-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample21.aspx)]

<span data-ttu-id="c0902-344">建立`Click`這三個按鈕控制項的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="c0902-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="c0902-345">在事件處理常式中，重設`StartRowIndex`設成 0，設定`SortExpression`適當的值，並重新繫結至中繼器資料：</span><span class="sxs-lookup"><span data-stu-id="c0902-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample22.cs)]

<span data-ttu-id="c0902-346">S 都是這麼簡單 ！</span><span class="sxs-lookup"><span data-stu-id="c0902-346">That s all there is to it!</span></span> <span data-ttu-id="c0902-347">儘管有幾個步驟來取得自訂分頁和排序實作的步驟所需要的預設分頁非常類似。</span><span class="sxs-lookup"><span data-stu-id="c0902-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="c0902-348">檢視資料時依分類排序的最後一頁時，圖 18 顯示的產品。</span><span class="sxs-lookup"><span data-stu-id="c0902-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>


<span data-ttu-id="c0902-349">[![接著會顯示最後一頁的資料、 排序依據類別、](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="c0902-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span></span>

<span data-ttu-id="c0902-350">**圖 18**： 會顯示最後一頁的資料、 依類別、 排序 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="c0902-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span></span>


> [!NOTE]
> <span data-ttu-id="c0902-351">在上一個範例中，請依供應商供應商名稱當做排序運算式排序時。</span><span class="sxs-lookup"><span data-stu-id="c0902-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="c0902-352">不過，對於自訂分頁實作中，我們需要使用供應商。</span><span class="sxs-lookup"><span data-stu-id="c0902-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="c0902-353">這是因為預存程序負責以實作自訂分頁`GetProductsPagedAndSorted`會傳遞至排序運算式`ROW_NUMBER()`關鍵字，`ROW_NUMBER()`關鍵字需要實際的資料行名稱，而不是別名。</span><span class="sxs-lookup"><span data-stu-id="c0902-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="c0902-354">因此，我們必須使用`CompanyName`(中的資料行名稱`Suppliers`資料表) 而不是使用中的別名`SELECT`查詢 (`SupplierName`) 的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="c0902-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>


## <a name="summary"></a><span data-ttu-id="c0902-355">總結</span><span class="sxs-lookup"><span data-stu-id="c0902-355">Summary</span></span>

<span data-ttu-id="c0902-356">既不 DataList 也中繼器提供內建排序支援，但可以新增程式碼和自訂排序介面的位元，這類功能。</span><span class="sxs-lookup"><span data-stu-id="c0902-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="c0902-357">當實作排序，但未分頁時，可以透過指定的排序運算式`DataSourceSelectArguments`物件傳遞到 ObjectDataSource 的`Select`方法。</span><span class="sxs-lookup"><span data-stu-id="c0902-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="c0902-358">這`DataSourceSelectArguments`物件 s`SortExpression`屬性可以指派在 ObjectDataSource 的`Selecting`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="c0902-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="c0902-359">若要加入排序功能 DataList 或已經提供分頁支援的中繼器，最簡單的方法是自訂商務邏輯層，以納入方法可接受排序運算式。</span><span class="sxs-lookup"><span data-stu-id="c0902-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="c0902-360">這項資訊可以接著傳遞中透過 ObjectDataSource s 中的參數`SelectParameters`。</span><span class="sxs-lookup"><span data-stu-id="c0902-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="c0902-361">本教學課程完成我們檢驗分頁和排序與 DataList 和中繼器控制項。</span><span class="sxs-lookup"><span data-stu-id="c0902-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="c0902-362">我們的下一個和最後一個教學課程將會檢驗如何 DataList 和中繼器範本，s 新增按鈕 Web 控制項，以提供每個項目為基礎的一些自訂的使用者啟動的功能。</span><span class="sxs-lookup"><span data-stu-id="c0902-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="c0902-363">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="c0902-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c0902-364">關於作者</span><span class="sxs-lookup"><span data-stu-id="c0902-364">About the Author</span></span>

<span data-ttu-id="c0902-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP/ASP.NET 書籍和的創辦[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已從 1998 年使用 Microsoft Web 技術。</span><span class="sxs-lookup"><span data-stu-id="c0902-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c0902-366">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="c0902-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c0902-367">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 2.0 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="c0902-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c0902-368">他可以在達到[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或透過他的部落格，這可以在找到[http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="c0902-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c0902-369">特別感謝</span><span class="sxs-lookup"><span data-stu-id="c0902-369">Special Thanks To</span></span>

<span data-ttu-id="c0902-370">許多有用的檢閱者已檢閱本教學課程系列。</span><span class="sxs-lookup"><span data-stu-id="c0902-370">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c0902-371">在此教學課程的前導檢閱者已 David Suru。</span><span class="sxs-lookup"><span data-stu-id="c0902-371">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="c0902-372">檢閱我即將推出的 MSDN 文件有興趣嗎？</span><span class="sxs-lookup"><span data-stu-id="c0902-372">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c0902-373">如果是這樣，卸除我一行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c0902-373">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="c0902-374">[上一頁](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
[下一頁](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c0902-374">[Previous](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
[Next](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span></span>
